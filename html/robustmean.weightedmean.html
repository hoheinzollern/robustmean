
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module robustmean.weightedmean</title>
<meta name="description" content="Documentation of Coq module robustmean.weightedmean" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="robustmean"><summary>robustmean</summary>
          <ul>
          <li><a href="robustmean.extraction_trimmedmean.html">extraction_trimmedmean</a></li>
<li><a href="robustmean.robustmean.html">robustmean</a></li>
<li><a href="robustmean.util.html">util</a></li>
<li><a href="robustmean.weightedmean.html">weightedmean</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module robustmean.weightedmean</h1>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html">ssralg</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html">ssrnum</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.matrix.html">matrix</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.boolp">boolp</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct">Rstruct</a></span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.reals">reals</a></span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.mathcomp_extra">mathcomp_extra</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Reals.html">Reals</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.micromega.Lra.html">Lra</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR">ssrR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext">Reals_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.realType_ext">realType_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.logb">logb</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext">ssr_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssralg_ext">ssralg_ext</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext">bigop_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist">fdist</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba">proba</a></span>.<br/>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="vernacular">Implicit</span> <span class="vernacular">Defensive</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">R_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">reals_ext_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">fdist_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">proba_scope</span>.<br/>
<br/>
<span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory">Order.POrderTheory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Theory">Order.Theory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory">Num.Theory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory">GRing.Theory</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="R" class="id"><a name="R" class="">R</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#real_realType">real_realType</a></span>.<br/>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for Interval.Tactic">Interval.Tactic</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Program.Wf.html">Program.Wf</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="robustmean.robustmean.html">robustmean</a></span> <span class="id"><a href="robustmean.util.html">util</a></span>.<br/>
<br/>
<div class="ssrdoc md">
# lemmas 1.4, 1.5, etc.                                                    
                                                                           
This file contains a formalization of lemmas from the chapter 1 of         
Jacob Steinhardt, Robust learning: information theory and algorithms,      
PhD Standford 2018.                                                        
                                                                           
|   Definitions |    | Meaning                                            |
|---------------|----|----------------------------------------------------|
|       is_01 C | := | forall i, 0 &lt;= C i &lt;= 1                             
|    Weighted.d | == | given a distribution $d0$ and a non-negative        
|               |    | function $g$, returns the distribution              
|               |    | $a\mapsto \frac{g(a) * d0(a)}{\sum_b g(b) * d0(b)}$ 
|       Split.d | == | given a distribution $d0$ and a non-negative        
|               |    | function $h$, returns the distribution              
|               |    | $\begin{array}{rl} (a,b) \mapsto &amp; h(a) * d0(a) \textrm{ if } b \\ &amp; (1 - h(a))*d0(a) \textrm{ o.w.}\end{array}$ 
|      sq_dev X | == | "squared deviation": $(X - mean)^2$                 
|    emean_cond | == | mean of the at least $1 - \varepsilon$ fraction     
|               |    | (under c) of remaining good points                  
|         emean | == | empirical/estimate mean of the data,                
|               |    | weighted mean of all the points                     
|               |    | (defined using emean_cond)                          
|     evar_cond | == | `V_[X : {RV (Weighted.d PC0) -&gt; R} | A]             
|          evar | == | empirical variance                                  
|  filter1D_inv | == | the amount of mass removed from the good points is  
|               |    | smaller than that removed from the bad points       
| filter1D_invW | == | the amount of mass attached to the good points is   
|               |    | at least $1 - \varepsilon$                          
|      filter1D | == | robust mean estimation by comparing mean and        
|               |    | variance                                            
                                                                           
</div>
<br/>
<span class="vernacular">Definition</span> <span id="is_01" class="id"><a name="is_01" class="">is_01</a></span> (<span id="U:1" class="id"><a name="U:1" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="C:2" class="id"><a name="C:2" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#31493a873acc18a8368490ef56022c0c">{ffun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:1">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="i:3" class="id"><a name="i:3" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#fbdebc8c1a732d40499de973c18a9a13">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:2">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:3">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#fbdebc8c1a732d40499de973c18a9a13">&lt;=</a></span> <span class="id">1</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span id="Weighted" class="id"><a name="Weighted" class="">Weighted</a></span>.<br/>
<span class="vernacular">Section</span> <span id="Weighted.def" class="id"><a name="Weighted.def" class="">def</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="Weighted.def.A" class="id"><a name="Weighted.def.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="Weighted.def.d0" class="id"><a name="Weighted.def.d0" class="">d0</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:4">A}</a></span>) (<span id="Weighted.def.g" class="id"><a name="Weighted.def.g" class="">g</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:4">A</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Weighted.total" class="id"><a name="Weighted.total" class="">total</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="a:11" class="id"><span id="a:10" class="id"><span id="a:9" class="id"><span id="a:8" class="id"><span id="a:7" class="id"><a name="a:11" class="">a</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.A">A</a></span>) <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:7">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:7">a</a></span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="Weighted.def.total_neq0" class="id"><a name="Weighted.def.total_neq0" class="">total_neq0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total</a></span> <span class="id">!=</span> <span class="id">0</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Weighted.f" class="id"><a name="Weighted.f" class="">f</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">[ffun</a></span> <span id="a:13" class="id"><a name="a:13" class="">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">=&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:13">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:13">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total]</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Weighted.total_gt0" class="id"><a name="Weighted.total_gt0" class="">total_gt0</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total</a></span>)%<span class="id">mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.lt_neqAle">lt_neqAle</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.total_neq0">total_neq0/=</a></span> <span class="id">/total</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sumr_ge0">sumr_ge0//</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/mulr_ge0/FDist</span>.<span class="id">ge0;</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/=</span> <span class="id">/forallP</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Weighted.def.f0" class="id"><a name="Weighted.def.f0" class="">f0</a></span> <span id="a:14" class="id"><a name="a:14" class="">a</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:14">a</a></span>)%<span class="id">mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id">/f</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.divr_ge0">divr_ge0//;</a></span> <span class="id">last</span> <span class="id">exact/ltW/total_gt0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">//;</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/=</span> <span class="id">/forallP;</span> <span class="id">exact</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Weighted.def.f1" class="id"><a name="Weighted.def.f1" class="">f1</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="a:19" class="id"><span id="a:18" class="id"><span id="a:17" class="id"><span id="a:16" class="id"><span id="a:15" class="id"><a name="a:19" class="">a</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.A">A</a></span>) <span class="id"><a href="robustmean.weightedmean.html#Weighted.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:15">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">rewrite</span> <span class="id">/f;</span> <span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">divRE</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-big_distrl</span> <span class="id">/=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRV">mulRV</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="Weighted.d" class="id"><a name="Weighted.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.A">A}</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#locked">locked</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#FDist.make">FDist.make</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.f0">f0</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.f1">f1</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Weighted.dE" class="id"><a name="Weighted.dE" class="">dE</a></span> <span id="a:20" class="id"><a name="a:20" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.d">d</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:20">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:20">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:20">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/d;</span> <span class="id">unlock;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Weighted.support_nonempty" class="id"><a name="Weighted.support_nonempty" class="">support_nonempty</a></span> <span class="id">:</span>  <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f">{i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:21">i</a></span> <span class="id">!=</span> <span class="id">0}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">move:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.total_neq0">total_neq0;</a></span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.psumr_neq0">psumr_neq0;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">*;</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.util.html#nneg_finfun_ge0">nneg_finfun_ge0</a></span>.<br/>
<span class="id">case/hasP/sig2W=&gt;</span> <span class="id">/=</span> <span class="id">x</span> <span class="id">?</span>.<br/>
<span class="id">move/RltP/pmulR_lgt0'</span>.<br/>
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#fdist_ge0_le1">fdist_ge0_le1</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.d0">d0</a></span> <span class="id">x</span>.<br/>
<span class="id">case/andP=&gt;</span> <span class="id">/[swap]</span> <span class="id">_</span> <span class="id">/RleP</span> <span class="id">/[swap]</span> <span class="id">/[apply]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move/ltR_eqF;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id">=&gt;</span> <span class="id">?;</span> <span class="gallina-kwd">exists</span> <span class="id">x</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def">def</a></span>.<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted">Weighted</a></span>.<br/>
<br/>
<span class="vernacular">Module</span> <span id="Split" class="id"><a name="Split" class="">Split</a></span>.<br/>
<span class="vernacular">Section</span> <span id="Split.def" class="id"><a name="Split.def" class="">def</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="Split.def.T" class="id"><a name="Split.def.T" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="Split.def.d0" class="id"><a name="Split.def.d0" class="">d0</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#T:22">T}</a></span>) (<span id="Split.def.h" class="id"><a name="Split.def.h" class="">h</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#T:22">T</a></span>).<br/>
<span class="vernacular">Hypothesis</span> <span id="Split.def.h01" class="id"><a name="Split.def.h01" class="">h01</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Split.g" class="id"><a name="Split.g" class="">g</a></span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="x:26" class="id"><a name="x:26" class="">x</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> <span class="id"><a href="robustmean.weightedmean.html#x:26">x</a></span>.<span class="id">2</span> <span class="gallina-kwd">then</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:26">x</a></span>.<span class="id">1</span> <span class="gallina-kwd">else</span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:26">x</a></span>.<span class="id">1</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Split.f" class="id"><a name="Split.f" class="">f</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">[ffun</a></span> <span id="x:27" class="id"><a name="x:27" class="">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">=&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:27">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:27">x</a></span>.<span class="id">1]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.g_ge0" class="id"><a name="Split.g_ge0" class="">g_ge0</a></span> <span id="x:28" class="id"><a name="x:28" class="">x</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:28">x</a></span>)%<span class="id">mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">rewrite</span> <span class="id">/g;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">_;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/=</span> <span class="id">/forallP</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">have</span> <span class="id">[_</span> <span class="id">?]</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h01">h01</a></span> <span class="id">x</span>.<span class="id">1;</span> <span class="id">exact/RleP/subR_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Split.def.f0" class="id"><a name="Split.def.f0" class="">f0</a></span> <span id="a:29" class="id"><a name="a:29" class="">a</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:29">a</a></span>)%<span class="id">mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id">/f</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#Split.g_ge0">g_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Split.def.f1" class="id"><a name="Split.def.f1" class="">f1</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#8de8b1dd76d6fc6f874a15e4c5bdcaaa">\sum_a</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:30">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">transitivity</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="x:42" class="id"><span id="x:41" class="id"><span id="x:40" class="id"><span id="x:39" class="id"><span id="x:38" class="id"><span id="x:37" class="id"><span id="x:36" class="id"><span id="x:35" class="id"><span id="x:34" class="id"><span id="x:33" class="id"><a name="x:42" class="">x</a></span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.T">T]</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setT">setT</a></span>)%<span class="id">SET</span>) <span class="id"><a href="robustmean.weightedmean.html#Split.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:33">x</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigl">eq_bigl</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">-[a</span> <span class="id">b];</span> <span class="id">rewrite</span> <span class="id">!inE</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#exchange_big">exchange_big//=</a></span> <span class="id"><a href="robustmean.util.html#setT_bool">setT_bool</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_setU1">big_setU1//=</a></span> <span class="id">?inE//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1//=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-big_split//=</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_setT">Pr_setT</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">a</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">!ffunE</span> <span class="id">/g</span> <span class="id">/=;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="Split.d" class="id"><a name="Split.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool}</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#locked">locked</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#FDist.make">FDist.make</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.f0">f0</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.f1">f1</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Split.fst_RV" class="id"><a name="Split.fst_RV" class="">fst_RV</a></span> (<span id="X:43" class="id"><a name="X:43" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.d">d</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#X:43">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#687e14754dadb7c0b04f27d8f71d2638">\o</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#fst">fst</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.dE" class="id"><a name="Split.dE" class="">dE</a></span> <span id="a:44" class="id"><a name="a:44" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#Split.d">d</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">2</span> <span class="gallina-kwd">then</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">1</span> <span class="gallina-kwd">else</span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">1</span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/d;</span> <span class="id">unlock;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.Pr_setXT" class="id"><a name="Split.Pr_setXT" class="">Pr_setXT</a></span> <span id="A:45" class="id"><a name="A:45" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:45">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.d">d</a></span> (<span class="id"><a href="robustmean.weightedmean.html#A:45">A</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">rewrite</span> <span class="id">/Pr</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX/=;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.util.html#setT_bool">setT_bool</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_setU1">big_setU1//=</a></span> <span class="id">?inE//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!dE/=</span> <span class="id">-mulRDl</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRCA">addRCA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR0">addR0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.cEx" class="id"><a name="Split.cEx" class="">cEx</a></span> (<span id="X:46" class="id"><a name="X:46" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span id="A:47" class="id"><a name="A:47" class="">A</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:47">A]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[fst_RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#X:46">X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:47">A</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="id">rewrite</span> <span class="id">!cExE</span> <span class="id">-Pr_setXT;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX//=;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.util.html#setT_bool">setT_bool</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_setU1">big_setU1//=</a></span> <span class="id">?inE//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!dE/=</span> <span class="id">/fst_RV/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulRDr</span> <span class="id">-mulRDl</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRCA">addRCA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR0">addR0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.cVar" class="id"><a name="Split.cVar" class="">cVar</a></span> (<span id="X:48" class="id"><a name="X:48" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span id="A:49" class="id"><a name="A:49" class="">A</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.fst_RV">fst_RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#X:48">X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:49">A</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:49">A]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/cVar/=</span> <span class="id"><a href="robustmean.weightedmean.html#Split.cEx">cEx</a></span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]cEx</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def">def</a></span>.<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Split">Split</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="emean_cond" class="id"><a name="emean_cond" class="">emean_cond</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{U</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType}</a></span> (<span id="P:51" class="id"><a name="P:51" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:50">U}</a></span>) (<span id="X:52" class="id"><a name="X:52" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:51">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="C:53" class="id"><a name="C:53" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:50">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="A:54" class="id"><a name="A:54" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:50">U}</a></span>) (<span id="PC0:55" class="id"><a name="PC0:55" class="">PC0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:51">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:53">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="emean_cond.WP" class="id"><a name="emean_cond.WP" class="">WP</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond.PC0">PC0</a></span>.<br/>
<span class="vernacular">Definition</span> <span id="emean_cond" class="id"><a name="emean_cond" class="">emean_cond</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond.WP">WP</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond.A">A]</a></span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="emean_cond.C01" class="id"><a name="emean_cond.C01" class="">C01</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond.C">C</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="emean_condE" class="id"><a name="emean_condE" class="">emean_condE</a></span> <span class="id">:</span> <span class="gallina-kwd">let</span> <span id="SX:57" class="id"><a name="SX:57" class="">SX</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#fst_RV">Split.fst_RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond.C01">C01</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond.X">X</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#emean_cond">emean_cond</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[SX</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond.A">A</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#f5e197738ea7c8e266850f6045418c3f">[set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true]]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">rewrite</span> <span class="id">/emean_cond</span> <span class="id">!cExE</span> <span class="id">!divRE</span> <span class="id">!big_distrl/=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX//=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/Pr</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX//=;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1</a></span> <span class="id">/SP</span> <span class="id">/Split</span>.<span class="id">fst_RV</span> <span class="id">/=</span> <span class="id">-!mulRA;</span> <span class="id">congr</span> (<span class="id"><a href="robustmean.weightedmean.html#emean_cond.X">X</a></span> <span class="id">u</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">_</span>).<br/>
<span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1</a></span> <span class="id"><a href="robustmean.weightedmean.html#dE">Split.dE</a></span><span class="id">/=</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Split.dE</a></span><span class="id">/=</span>.<br/>
<span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Weighted.dE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-big_distrl/=</span> <span class="id">-divRE</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rdiv_mult_distr">Rdiv_mult_distr</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">divRE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invRK">invRK</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">!mulRA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Weighted.dE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRAC">mulRAC</a></span> <span class="id">-divRE</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRR">divRR</a></span> <span class="id">?mul1R</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond">emean_cond</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="emean" class="id"><a name="emean" class="">emean</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="emean.U" class="id"><a name="emean.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="emean.P" class="id"><a name="emean.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:58">U}</a></span>) (<span id="emean.X" class="id"><a name="emean.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:59">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="emean.C" class="id"><a name="emean.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:58">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="emean.PC0" class="id"><a name="emean.PC0" class="">PC0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:59">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:61">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="emean" class="id"><a name="emean" class="">emean</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond">emean_cond</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.X">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setT">setT</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.PC0">PC0</a></span>.<br/>
<br/>
<div class="doc">emean expressed using expectation </div>
<span class="vernacular">Lemma</span> <span id="emeanE" class="id"><a name="emeanE" class="">emeanE</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">`E</a></span> (<span class="id"><a href="robustmean.weightedmean.html#emean.X">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> (<span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.PC0">PC0</a></span>) <span class="id">-&gt;</span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/emean</span> <span class="id">/emean_cond</span> <span class="id">-Ex_cExT</span>. Qed.</div>
<br/>
<div class="doc">emean expressed using big sums </div>
<span class="vernacular">Lemma</span> <span id="emean_sum" class="id"><a name="emean_sum" class="">emean_sum</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:67" class="id"><span id="i:66" class="id"><span id="i:65" class="id"><span id="i:64" class="id"><span id="i:63" class="id"><a name="i:67" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#emean.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#emean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:63">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:63">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:63">i</a></span>) <span class="id">/</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:72" class="id"><span id="i:71" class="id"><span id="i:70" class="id"><span id="i:69" class="id"><span id="i:68" class="id"><a name="i:72" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#emean.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#emean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:68">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:68">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#emeanE">emeanE/=</a></span> <span class="id">/Ex</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]divRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrl">big_distrl/=</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Weighted.dE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRCA">mulRCA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="sq_dev" class="id"><a name="sq_dev" class="">sq_dev</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="sq_dev.U" class="id"><a name="sq_dev.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="sq_dev.P" class="id"><a name="sq_dev.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:73">U}</a></span>) (<span id="sq_dev.X" class="id"><a name="sq_dev.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:74">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="sq_dev.C" class="id"><a name="sq_dev.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:73">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="sq_dev.PC0" class="id"><a name="sq_dev.PC0" class="">PC0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:74">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:76">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="sq_dev" class="id"><a name="sq_dev" class="">sq_dev</a></span> <span class="id">:=</span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#4f0eb16db53d2455b24b93c7e9f16e54">`-cst</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.PC0">PC0</a></span>)<span class="id">`^2</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_devE" class="id"><a name="sq_devE" class="">sq_devE</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#4f0eb16db53d2455b24b93c7e9f16e54">`-cst</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">`E</a></span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> (<span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.PC0">PC0</a></span>) <span class="id">-&gt;</span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)) <span class="id">`^2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_dev</span> <span class="id"><a href="robustmean.weightedmean.html#emeanE">emeanE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_ge0" class="id"><a name="sq_dev_ge0" class="">sq_dev_ge0</a></span> <span id="u:78" class="id"><a name="u:78" class="">u</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:78">u</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_dev</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#sq_RV_pow2">sq_RV_pow2;</a></span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="sq_dev_max" class="id"><a name="sq_dev_max" class="">sq_dev_max</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#6e9df56134f2cda6e085e904a3dda126">\rmax_</a></span>(<span id="i:81" class="id"><span id="i:80" class="id"><span id="i:79" class="id"><a name="i:81" class="">i</a></span></span></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#6e9df56134f2cda6e085e904a3dda126">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:79">i</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:79">i</a></span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="j" class="id"><a name="j" class="">j</a></span> <span class="id">:=</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#sval">sval</a></span> (<span class="id"><a href="robustmean.weightedmean.html#support_nonempty">Weighted.support_nonempty</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.PC0">PC0</a></span>)).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="sq_dev_arg_max" class="id"><a name="sq_dev_arg_max" class="">sq_dev_arg_max</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">[arg</a></span> <span class="id">max_</span>(<span id="i:83" class="id"><span id="i:82" class="id"><a name="i:83" class="">i</a></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#j">j</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:82">i</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:83">i]</a></span>%<span class="id">O</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_max_eq_arg" class="id"><a name="sq_dev_max_eq_arg" class="">sq_dev_max_eq_arg</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev_arg_max">sq_dev_arg_max</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">rewrite</span> <span class="id">/sq_dev_max</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#bigmaxRE">bigmaxRE</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.TotalTheory.bigmax_eq_arg">bigmax_eq_arg;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#support_nonempty">Weighted.support_nonempty</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">*;</span> <span class="id">exact/RleP/sq_dev_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_max_ge0" class="id"><a name="sq_dev_max_ge0" class="">sq_dev_max_ge0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_dev_max</span> <span class="id">-big_filter;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#bigmaxR_ge0">bigmaxR_ge0</a></span> <span class="id">=&gt;</span> <span class="id">*;</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_ge0">sq_dev_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_max_ge" class="id"><a name="sq_dev_max_ge" class="">sq_dev_max_ge</a></span> <span id="u:84" class="id"><a name="u:84" class="">u</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:84">u</a></span> <span class="id">!=</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:84">u</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">move=&gt;</span> <span class="id">Cu0</span>.<br/>
<span class="id">rewrite</span> <span class="id">/sq_dev_max</span> <span class="id">-big_filter;</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_bigmaxR">leR_bigmaxR</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#mem_filter">mem_filter</a></span> <span class="id">Cu0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#mem_index_enum">mem_index_enum</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="evar_cond" class="id"><a name="evar_cond" class="">evar_cond</a></span>.<br/>
<span class="vernacular">Context</span> (<span id="U:85" class="id"><a name="U:85" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:86" class="id"><a name="P:86" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:85">U}</a></span>) (<span id="X:87" class="id"><a name="X:87" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:86">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;(<span id="C:88" class="id"><a name="C:88" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:85">U</a></span>) (<span id="A:89" class="id"><a name="A:89" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:85">U}</a></span>) (<span id="PC0:90" class="id"><a name="PC0:90" class="">PC0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:86">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:88">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="evar_cond.WP" class="id"><a name="evar_cond.WP" class="">WP</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond.PC0">PC0</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="evar_cond" class="id"><a name="evar_cond" class="">evar_cond</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond.WP">WP</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond.A">A]</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="evar_cond_ge0" class="id"><a name="evar_cond_ge0" class="">evar_cond_ge0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond">evar_cond</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
 <span class="id">exact:</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond">evar_cond</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="evar" class="id"><a name="evar" class="">evar</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="evar.U" class="id"><a name="evar.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="evar.P" class="id"><a name="evar.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:91">U}</a></span>) (<span id="evar.X" class="id"><a name="evar.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:92">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="evar.C" class="id"><a name="evar.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:91">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="evar.PC0" class="id"><a name="evar.PC0" class="">PC0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:92">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:94">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="evar" class="id"><a name="evar" class="">evar</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond">evar_cond</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.X">X</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setT">setT</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC0">PC0</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="evarE" class="id"><a name="evarE" class="">evarE</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#c7a4904f3d060a494e43ad1a77d88c00">`V</a></span> (<span class="id"><a href="robustmean.weightedmean.html#evar.X">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> (<span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC0">PC0</a></span>) <span class="id">-&gt;</span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/evar</span> <span class="id">/evar_cond</span> <span class="id"><a href="robustmean.robustmean.html#Var_cVarT">Var_cVarT</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="evar_emean" class="id"><a name="evar_emean" class="">evar_emean</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC0">PC0</a></span>) <span class="id"><a href="robustmean.weightedmean.html#evar.PC0">PC0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
<span class="id">rewrite</span> <span class="id">/evar</span> <span class="id">/emean</span> <span class="id">/evar_cond</span> <span class="id">/emean_cond</span> <span class="id">/sq_dev</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#emeanE">emeanE/=</a></span> <span class="id">-Var_cVarT</span> <span class="id">-Ex_cExT</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="evar0P" class="id"><a name="evar0P" class="">evar0P</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="gallina-kwd">forall</span> <span id="i:96" class="id"><a name="i:96" class="">i,</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:96">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:96">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC0">PC0</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:96">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>) (<span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id">0</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">apply:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#evar_emean">evar_emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_sum">emean_sum</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">H;</span> <span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big1">big1</a></span> <span class="id">//</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#div0R">div0R</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#evar_emean">evar_emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean_sum">emean_sum</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_eq0'">mulR_eq0'</a></span> <span class="id">=&gt;</span> <span class="id">/orP</span> <span class="id">[];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move/invR_eq0';</span> <span class="id">rewrite</span> <span class="id">-/</span>(<span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC0">PC0</a></span>).<br/>
<span class="id">move/[swap]</span> <span class="id">=&gt;</span> <span class="id">i</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.psumr_eq0">psumr_eq0</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move/allP/</span>(<span class="id">_</span> <span class="id">i</span>)<span class="id">/[!mem_index_enum]/</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span>)<span class="id">/implyP/[!inE]/</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span>)<span class="id">/eqP-&gt;</span>.<br/>
<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">apply/RleP/mulR_ge0;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_ge0">sq_dev_ge0</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/mulR_ge0=&gt;</span> <span class="id">//;</span> <span class="id">exact/RleP/nneg_finfun_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="evar_ge0" class="id"><a name="evar_ge0" class="">evar_ge0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
 <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond_ge0">evar_cond_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="pos_evar" class="id"><a name="pos_evar" class="">pos_evar</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="pos_evar.U" class="id"><a name="pos_evar.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="pos_evar.P" class="id"><a name="pos_evar.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:97">U}</a></span>) (<span id="pos_evar.X" class="id"><a name="pos_evar.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:98">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="pos_evar.C" class="id"><a name="pos_evar.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:97">U</a></span>).<br/>
<span class="vernacular">Hypotheses</span> (<span id="pos_evar.PC_neq0" class="id"><a name="pos_evar.PC_neq0" class="">PC_neq0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.C">C</a></span> <span class="id">!=</span> <span class="id">0</span>) (<span id="pos_evar.evar_gt0" class="id"><a name="pos_evar.evar_gt0" class="">evar_gt0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#PC_neq0:101">PC_neq0</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="pos_evar_index" class="id"><a name="pos_evar_index" class="">pos_evar_index</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="i:103" class="id"><a name="i:103" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:103">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:103">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.PC_neq0">PC_neq0</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:103">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">move:</span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.evar_gt0">evar_gt0;</a></span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_neqAle">ltR_neqAle</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span> <span class="id">/nesym</span> <span class="id">/eqP</span> <span class="id">/[swap]</span> <span class="id">_</span>.<br/>
<span class="id">case/evar0P/boolp</span>.<span class="id">existsNP=&gt;</span> <span class="id">x</span> <span class="id">/eqP</span> <span class="id">?;</span> <span class="gallina-kwd">exists</span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_neqAle">ltR_neqAle;</a></span> <span class="id">split;</span> <span class="id">first</span> <span class="id">exact/nesym/eqP</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">last</span> <span class="id">exact/sq_dev_ge0</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0=&gt;</a></span> <span class="id">//;</span> <span class="id">exact/RleP/nneg_finfun_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar">pos_evar</a></span>.<br/>
<br/>
<div class="doc md"> ## eqn I, page 5 </div>
<span class="vernacular">Definition</span> <span id="filter1D_inv" class="id"><a name="filter1D_inv" class="">filter1D_inv</a></span> (<span id="U:104" class="id"><a name="U:104" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:105" class="id"><a name="P:105" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:104">U}</a></span>) (<span id="C:106" class="id"><a name="C:106" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:104">U</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="good:107" class="id"><a name="good:107" class="">good</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:104">U}</a></span>) (<span id="eps:108" class="id"><a name="eps:108" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:113" class="id"><span id="i:112" class="id"><span id="i:111" class="id"><span id="i:110" class="id"><span id="i:109" class="id"><a name="i:113" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#good:107">good</a></span>) (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:106">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:109">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#P:105">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:109">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span><br/>
&nbsp;&nbsp;(<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:108">eps</a></span>) <span class="id">/</span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:118" class="id"><span id="i:117" class="id"><span id="i:116" class="id"><span id="i:115" class="id"><span id="i:114" class="id"><a name="i:118" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:107">good</a></span>) (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:106">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:114">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#P:105">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:114">i</a></span>.<br/>
<br/>
<div class="doc md"> ## page 62, line -1 </div>
<span class="vernacular">Definition</span> <span id="filter1D_invW" class="id"><a name="filter1D_invW" class="">filter1D_invW</a></span> (<span id="U:119" class="id"><a name="U:119" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:120" class="id"><a name="P:120" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:119">U}</a></span>) (<span id="C:121" class="id"><a name="C:121" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:119">U</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="good:122" class="id"><a name="good:122" class="">good</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:119">U}</a></span>) (<span id="eps:123" class="id"><a name="eps:123" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>) (<span id="PC_neq0:124" class="id"><a name="PC_neq0:124" class="">PC_neq0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:120">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:121">C</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WP:125" class="id"><a name="WP:125" class="">WP</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#PC_neq0:124">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:123">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#WP:125">WP</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:122">good</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="bounding_empirical_mean" class="id"><a name="bounding_empirical_mean" class="">bounding_empirical_mean</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="bounding_empirical_mean.U" class="id"><a name="bounding_empirical_mean.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="bounding_empirical_mean.P" class="id"><a name="bounding_empirical_mean.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:126">U}</a></span>) (<span id="bounding_empirical_mean.X" class="id"><a name="bounding_empirical_mean.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:127">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="bounding_empirical_mean.C" class="id"><a name="bounding_empirical_mean.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:126">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="bounding_empirical_mean.good" class="id"><a name="bounding_empirical_mean.good" class="">good</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:126">U}</a></span>) (<span id="bounding_empirical_mean.eps" class="id"><a name="bounding_empirical_mean.eps" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.bad" class="id"><a name="bounding_empirical_mean.bad" class="">bad</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>.<br/>
<br/>
<span class="vernacular">Hypotheses</span> (<span id="bounding_empirical_mean.C01" class="id"><a name="bounding_empirical_mean.C01" class="">C01</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span>) (<span id="bounding_empirical_mean.PC0" class="id"><a name="bounding_empirical_mean.PC0" class="">PC0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id">!=</span> <span class="id">0</span>)<br/>
&nbsp;&nbsp;(<span id="bounding_empirical_mean.pr_bad" class="id"><a name="bounding_empirical_mean.pr_bad" class="">pr_bad</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.bad">bad</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>) (<span id="bounding_empirical_mean.low_eps" class="id"><a name="bounding_empirical_mean.low_eps" class="">low_eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">16</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="pr_good" class="id"><a name="pr_good" class="">pr_good</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_to_cplt">Pr_to_cplt</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.pr_bad">pr_bad</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.eps0" class="id"><a name="bounding_empirical_mean.eps0" class="">eps0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
 <span class="id">rewrite</span> <span class="id">-pr_bad</span>. <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_ge0">Pr_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.mu" class="id"><a name="bounding_empirical_mean.mu" class="">mu</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good]</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.var" class="id"><a name="bounding_empirical_mean.var" class="">var</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good]</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.mu_hat" class="id"><a name="bounding_empirical_mean.mu_hat" class="">mu_hat</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.var_hat" class="id"><a name="bounding_empirical_mean.var_hat" class="">var_hat</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.mu_wave" class="id"><a name="bounding_empirical_mean.mu_wave" class="">mu_wave</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond">emean_cond</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.evar_wave" class="id"><a name="bounding_empirical_mean.evar_wave" class="">evar_wave</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond">evar_cond</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.tau" class="id"><a name="bounding_empirical_mean.tau" class="">tau</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.tau_max" class="id"><a name="bounding_empirical_mean.tau_max" class="">tau_max</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="pr_good_gt0" class="id"><a name="pr_good_gt0" class="">pr_good_gt0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">pr_good;</a></span> <span class="id">lra</span>. Qed.</div>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.hprgoodgt0" class="id"><a name="bounding_empirical_mean.hprgoodgt0" class="">hprgoodgt0</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good_gt0">pr_good_gt0</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="weighted_total_gt0" class="id"><a name="weighted_total_gt0" class="">weighted_total_gt0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
 <span class="gallina-kwd">by</span> <span class="id">apply/RltP/Weighted</span>.<span class="id">total_gt0</span>. Qed.</div>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.hweightedtotalgt0" class="id"><a name="bounding_empirical_mean.hweightedtotalgt0" class="">hweightedtotalgt0</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#weighted_total_gt0">weighted_total_gt0</a></span>.<br/>
<br/>
<div class="doc md"> ## eqn 1.1, page 5 </div>
<span class="vernacular">Lemma</span> <span id="weight_contrib" class="id"><a name="weight_contrib" class="">weight_contrib</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:140" class="id"><span id="i:139" class="id"><span id="i:138" class="id"><span id="i:137" class="id"><span id="i:136" class="id"><a name="i:140" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:136">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:136">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:136">i</a></span>) <span class="id">/</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu">mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">mu_hat</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[tau</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">_+_</span>)<span class="id">;</span> <span class="id">[rewrite</span> <span class="id"><a href="robustmean.robustmean.html#cExE">cExE|exact:</a></span> <span class="id"><a href="robustmean.robustmean.html#cVarDist">cVarDist]</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2r">leR_pmul2r;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_gt0">invR_gt0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_sumRl">leR_sumRl</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">Higood</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRAC">mulRAC</a></span> <span class="id">-mulRA</span> <span class="id">-{2}</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.tau">tau</a></span> <span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">_</span>)).<br/>
<span class="id">apply:</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2r">leR_wpmul2r</a></span> <span class="id">_</span> ((<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">C01</a></span> <span class="id">i</span>).<span class="id">2</span>)).<br/>
<span class="id">all:</span> <span class="id">apply/mulR_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_ge0">sq_dev_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.invariant" class="id"><a name="bounding_empirical_mean.invariant" class="">invariant</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_inv">filter1D_inv</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.invariantW" class="id"><a name="bounding_empirical_mean.invariantW" class="">invariantW</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invW">filter1D_invW</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="invariant_impl" class="id"><a name="invariant_impl" class="">invariant_impl</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariant">invariant</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariantW">invariantW</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">rewrite</span> <span class="id">/invariant</span> <span class="id">/invariantW</span> <span class="id">/filter1D_invW</span> <span class="id">=&gt;</span> <span class="id">hinv</span>.<br/>
<span class="id">rewrite</span> <span class="id">-!pr_good</span>.<br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:155" class="id"><span id="i:154" class="id"><span id="i:153" class="id"><span id="i:152" class="id"><span id="i:151" class="id"><span id="i:145" class="id"><span id="i:144" class="id"><span id="i:143" class="id"><span id="i:142" class="id"><span id="i:141" class="id"><a name="i:155" class="">i</a></span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.bad">bad</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:141">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:141">i</a></span>))) <span class="id">/</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:160" class="id"><span id="i:159" class="id"><span id="i:158" class="id"><span id="i:157" class="id"><span id="i:156" class="id"><span id="i:150" class="id"><span id="i:149" class="id"><span id="i:148" class="id"><span id="i:147" class="id"><span id="i:146" class="id"><a name="i:160" class="">i</a></span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:146">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:146">i</a></span>))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2r">leR_pmul2r</a></span> ((<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:170" class="id"><span id="i:169" class="id"><span id="i:168" class="id"><span id="i:167" class="id"><span id="i:166" class="id"><span id="i:165" class="id"><span id="i:164" class="id"><span id="i:163" class="id"><span id="i:162" class="id"><span id="i:161" class="id"><a name="i:170" class="">i</a></span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:161">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:161">i</a></span>) <span class="id">*</span> <span class="id">2</span>))<span class="id">;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_gt0">mulR_gt0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!mulRA</span> <span class="id">!</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">_</span> <span class="id">2</span>) <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> <span class="id">_</span>)) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">mulVR;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#gtR_eqF">gtR_eqF</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">mulR1</a></span> <span class="id">!mulRA</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/2</a></span>)) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">mulVR;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#gtR_eqF">gtR_eqF</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> <span class="id">-addRR</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDl">mulRDl</a></span> <span class="id">-addRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDr">mulRDr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2l">leR_pmul2l;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.low_eps">low_eps;</a></span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">pr_good;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_setT">Pr_setT</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span>)<span class="id">;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_sumRl">leR_sumRl</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-{2}</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id">i</span>))<span class="id">;</span> <span class="id">apply:</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2r">leR_wpmul2r</a></span> <span class="id">_</span> ((<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">C01</a></span> <span class="id">i</span>).<span class="id">2</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2l">leR_pmul2l;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.low_eps">low_eps;</a></span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">pr_good;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">addRC</a></span> <span class="id">-bigID2;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_sumR">leR_sumR</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">HiU</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">igood;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-{2}</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id">i</span>))<span class="id">;</span> <span class="id">apply:</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2r">leR_wpmul2r</a></span> <span class="id">_</span> ((<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">C01</a></span> <span class="id">i</span>).<span class="id">2</span>)).<br/>
<span class="id">under</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X]eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Weighted.dE</a></span> <span class="id">/Weighted</span>.<span class="id">total</span>.<br/>
<span class="id">rewrite</span> <span class="id">-big_distrl/=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">divRE</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2r">leR_pmul2r;</a></span> <span class="id">first</span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_gt0">invR_gt0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Ropp_le_cancel">Ropp_le_cancel</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">{2}pr_good</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRA">addRA</a></span> <span class="id">-addRA</span> <span class="id">-pr_bad</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDr">mulRDr</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRD">oppRD</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">addRC</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_subl_addr">leR_subl_addr</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/Rminus</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRK">oppRK</a></span> <span class="id">-mulRN</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">addRC</a></span> <span class="id">{1}/Rdiv</span> <span class="id">-mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">mulVR;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#gtR_eqF">gtR_eqF</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">mulR1</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRD">oppRD</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRK">oppRK</a></span> <span class="id">!big_morph_oppR-!big_split/=</span>.<br/>
<span class="id">have</span> <span class="id">H</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="S:172" class="id"><a name="S:172" class="">S,</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:177" class="id"><span id="i:176" class="id"><span id="i:175" class="id"><span id="i:174" class="id"><span id="i:173" class="id"><a name="i:177" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#S:172">S</a></span>) (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:173">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:173">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:173">i</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:182" class="id"><span id="i:181" class="id"><span id="i:180" class="id"><span id="i:179" class="id"><span id="i:178" class="id"><a name="i:182" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#S:172">S</a></span>) (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:178">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:178">i</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">p</span> <span class="id">S;</span> <span class="id">apply</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRBl">mulRBl</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!H</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">pr_good</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.WP" class="id"><a name="bounding_empirical_mean.WP" class="">WP</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC0">PC0</a></span>.<br/>
<br/>
<div class="doc md"> ## eqn page 63, line 3 </div>
<span class="vernacular">Lemma</span> <span id="bound_emean" class="id"><a name="bound_emean" class="">bound_emean</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.WP">WP</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id">!=</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariantW">invariantW</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">mu_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">move=&gt;</span> <span class="id">pgoodC</span> <span class="id">invC</span>.<br/>
<span class="id">suff</span> <span class="id">h</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">`|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">mu_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">|</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_abs">Rsqr_abs</a></span> <span class="id">-[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X]Rsqr_sqrt;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/invR_ge0/subR_gt0;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulRA;</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0|lra]</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/Rsqr_incr_1</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">[exact/normR_ge0|exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos]</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#distRC">distRC</a></span> <span class="id">{1}</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>))<span class="id">;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">lra</span>.<br/>
<span class="id">set</span> <span class="id">delta</span> <span class="id">:=</span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/mu_hat</span> <span class="id"><a href="robustmean.weightedmean.html#emeanE">emeanE</a></span> <span class="id">/var_hat</span> <span class="id"><a href="robustmean.weightedmean.html#evarE">evarE</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="robustmean.robustmean.html#resilience">resilience</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id">/delta;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn page 63, line 5 </div>
<span class="vernacular">Lemma</span> <span id="good_mass" class="id"><a name="good_mass" class="">good_mass</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariant">invariant</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps/2</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:188" class="id"><span id="i:187" class="id"><span id="i:186" class="id"><span id="i:185" class="id"><span id="i:184" class="id"><a name="i:188" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:184">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:184">i</a></span>) <span class="id">/</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">rewrite</span> <span class="id">/is_01</span> <span class="id">=&gt;</span> <span class="id">Hinv</span>.<br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>) <span class="id">/</span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.bad">bad</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.pr_bad">pr_bad</a></span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">pr_good</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-!mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">_</span>))) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id">-mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">mulVR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">mulR1</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC;</a></span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/gtR_eqF;</span> <span class="id">lra</span>.<br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>) <span class="id">/</span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:198" class="id"><span id="i:197" class="id"><span id="i:196" class="id"><span id="i:195" class="id"><span id="i:194" class="id"><span id="i:193" class="id"><span id="i:192" class="id"><span id="i:191" class="id"><span id="i:190" class="id"><span id="i:189" class="id"><a name="i:198" class="">i</a></span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.bad">bad</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:189">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:189">i</a></span>))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add2l">leR_add2l</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_oppl">leR_oppl</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRK">oppRK</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2l">leR_pmul2l;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/divR_gt0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply/divR_gt0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_sumR">leR_sumR</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">ibad</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRBr">mulRBr</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">mulR1</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_sub_addr">leR_sub_addr</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_addl">leR_addl;</a></span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">C01</a></span> <span class="id">i</span>).<span class="id">1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-pr_good</span> <span class="id">-mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRCA">mulRCA</a></span> <span class="id">!mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">mulVR</a></span> <span class="id">?mul1R;</span> <span class="id">last</span> <span class="id">exact/gtR_eqF</span>.<br/>
<span class="id">apply/leR_pdivl_mulr</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDl">mulRDl</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> <span class="id">{2}pr_good</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRN">mulRN</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">addRC;</a></span> <span class="id">apply/leR_subr_addr;</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_oppl">leR_oppl</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRD">oppRD</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRK">oppRK</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">addRC</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/Pr</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-</a></span> <span class="id">_</span>)) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRN">mulRN</a></span> <span class="id">-mulNR</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrr">big_distrr</a></span> <span class="id">-big_split</span> <span class="id">-divRE/=</span>.<br/>
<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulN1R">mulN1R</a></span> <span class="id">-{1}</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id">i</span>)) <span class="id">-mulNR</span> <span class="id">-Rmult_plus_distr_r</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X]eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.SX" class="id"><a name="bounding_empirical_mean.SX" class="">SX</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#fst_RV">Split.fst_RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">C01</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span>.<br/>
<br/>
<div class="doc md"> ## eqn page 63, line 4 </div>
<span class="vernacular">Lemma</span> <span id="bound_mean" class="id"><a name="bound_mean" class="">bound_mean</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariant">invariant</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu">mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">move=&gt;</span> <span class="id">Hinv</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu">mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[SX</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]]</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-Split</span>.<span class="id">cEx</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[SX</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#f5e197738ea7c8e266850f6045418c3f">[set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true]]</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/mu_wave</span> <span class="id"><a href="robustmean.weightedmean.html#emean_condE">emean_condE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_neg_minus">Rsqr_neg_minus</a></span>.<br/>
<span class="id">apply:</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> (<span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.SX">SX</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#69c431a9c94f6f30a655bd7ddb59037b">/</a></span> <span class="id">2</span>)%<span class="id">mcR</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#69c431a9c94f6f30a655bd7ddb59037b">/</a></span> <span class="id">2</span>)%<span class="id">mcR</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_le_0">sqrt_le_0;</a></span> <span class="id">first</span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0|lra]</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!coqRE</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRB">subRB</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#add0R">add0R;</a></span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divR_ge0">divR_ge0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">rewrite</span> <span class="id">-!coqRE</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">2</span>%<span class="id">:R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">2</span>)<span class="id">//;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_Rsqr_abs">sqrt_Rsqr_abs;</a></span> <span class="id">apply:</span> (<span class="id"><a href="robustmean.robustmean.html#cresilience">cresilience</a></span> (<span class="id">delta</span> <span class="id">:=</span> <span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#::ring_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#69c431a9c94f6f30a655bd7ddb59037b">/</a></span> <span class="id">2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!coqRE</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">2</span>%<span class="id">:R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">2</span>)<span class="id">//;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#good_mass">good_mass</a></span> <span class="id">Hinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-Split</span>.<span class="id">Pr_setXT</span> <span class="id">{2}/Pr</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX/=</a></span> <span class="id">-!coqRE</span> <span class="id">=&gt;</span> <span class="id">/leR_trans;</span> <span class="id">apply</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/leR_eqVlt;</span> <span class="id">left;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">_</span>)<span class="id">;</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1</a></span> <span class="id"><a href="robustmean.weightedmean.html#dE">Split.dE</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply/subsetP</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">!inE</span> <span class="id">=&gt;</span> <span class="id">/andP[-&gt;]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#cVar">Split.cVar</a></span> <span class="id">!divRE</span> <span class="id">-/var</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id">_</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>) <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id">_</span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">_</span>)).<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2l">leR_wpmul2l</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0|lra]</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-!coqRE</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRB">subRB</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#add0R">add0R</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-!divRE</span> <span class="id">-Rdiv_mult_distr</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">mulR1</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_div_assoc">Rmult_div_assoc</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">2</span>) <span class="id">-Rmult_div_assoc</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRR">divRR</a></span> <span class="id">?mulR1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">2</span>%<span class="id">:R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">2</span>)<span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/eqP;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## lemma 1.4, page 5 (part 1) </div>
<span class="vernacular">Lemma</span> <span id="bound_mean_emean" class="id"><a name="bound_mean_emean" class="">bound_mean_emean</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariant">invariant</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">`|mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">mu_hat|</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">move=&gt;</span> <span class="id">IC</span>.<br/>
<span class="id">have</span> <span class="id">I1C</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariantW">invariantW</a></span> <span class="gallina-kwd">by</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#invariant_impl">invariant_impl</a></span>.<br/>
<span class="id">apply:</span> (@<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">`|mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave|</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">`|mu_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave|</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu">mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">mu_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu">mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave</a></span>) <span class="id">+</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_wave</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">mu_hat</a></span>) <span class="gallina-kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>))<span class="id">/Rplus_le_compat_l</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym;</a></span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-pr_bad;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_ge0">Pr_ge0</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#geR0_norm">geR0_norm</a></span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span> <span class="id">_</span>))<span class="id">;</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_le_abs_0">Rsqr_le_abs_0;</a></span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#Rsqr_sqrt">Rsqr_sqrt</a></span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#bound_mean">bound_mean</a></span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id">-!mulRA;</span> <span class="id">apply/mulR_ge0;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0|lra]</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#geR0_norm">geR0_norm</a></span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span> <span class="id">_</span>))<span class="id">;</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_le_abs_0">Rsqr_le_abs_0;</a></span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#Rsqr_sqrt">Rsqr_sqrt</a></span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply:</span> <span class="id"><a href="robustmean.weightedmean.html#bound_emean">bound_emean</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/invariantW</span> <span class="id">/filter1D_invW</span> <span class="id">-/WP</span> <span class="gallina-kwd">in</span> <span class="id">I1C;</span> <span class="id">apply/eqP;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulRA;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0|lra]</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean">bounding_empirical_mean</a></span>.<br/>
<br/>
<div class="doc">WIP </div>
<span class="vernacular">Section</span> <span id="update" class="id"><a name="update" class="">update</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="update.U" class="id"><a name="update.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="update.P" class="id"><a name="update.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:200">U}</a></span>) (<span id="update.X" class="id"><a name="update.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:201">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="update.C" class="id"><a name="update.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:200">U</a></span>).<br/>
<span class="vernacular">Hypotheses</span> (<span id="update.PC_neq0" class="id"><a name="update.PC_neq0" class="">PC_neq0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.C">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="update.tau" class="id"><a name="update.tau" class="">tau</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="update.tau_max" class="id"><a name="update.tau_max" class="">tau_max</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="arg_tau_max" class="id"><a name="arg_tau_max" class="">arg_tau_max</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#66e270080ae504530c90e1f7e9fca5bd">[arg</a></span> <span class="id">max_</span>(<span id="i:208" class="id"><span id="i:207" class="id"><span id="i:206" class="id"><span id="i:205" class="id"><a name="i:208" class="">i</a></span></span></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#66e270080ae504530c90e1f7e9fca5bd">&gt;</a></span> (<span class="id"><a href="robustmean.robustmean.html#fdist_supp_choice">fdist_supp_choice</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.P">P</a></span>) <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.U">U]</a></span>) <span class="id"><a href="robustmean.weightedmean.html#update.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:208">i]</a></span>%<span class="id">O</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="update_ffun" class="id"><a name="update_ffun" class="">update_ffun</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#31493a873acc18a8368490ef56022c0c">{ffun</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.U">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">[ffun</a></span> <span id="i:209" class="id"><a name="i:209" class="">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">=&gt;</a></span> <span class="gallina-kwd">if</span> (<span class="id"><a href="robustmean.weightedmean.html#update.tau_max">tau_max</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id">0</span>) <span class="id">||</span> (<span class="id"><a href="robustmean.weightedmean.html#update.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:209">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id">0</span>) <span class="gallina-kwd">then</span> <span class="id">0</span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#update.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:209">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:209">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.tau_max">tau_max</a></span>)<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">]</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="update_pos_ffun" class="id"><a name="update_pos_ffun" class="">update_pos_ffun</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#ce8c9a990e3e773a56ef37417d3761c6">[forall</a></span> <span id="a:212" class="id"><span id="a:211" class="id"><span id="a:210" class="id"><a name="a:212" class="">a,</a></span></span></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_ffun">update_ffun</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:210">a]</a></span>%<span class="id">mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">apply/forallP=&gt;</span> <span class="id">i;</span> <span class="id">apply/RleP</span>.<br/>
<span class="id">rewrite</span> <span class="id">/update_ffun</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span>.<br/>
<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">[/orP[//=|//]|/norP[tau_max_neq0</span> <span class="id">Ci_neq0]]</span>.<br/>
<span class="id">apply</span> <span class="id">/mulR_ge0/RleP;</span> <span class="id">first</span> <span class="id">exact/RleP/nneg_finfun_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_ge0">subr_ge0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ler_pdivr_mulr">ler_pdivr_mulr</a></span> <span class="id">?mul1r;</span> <span class="id">first</span> <span class="id">exact/RleP/sq_dev_max_ge</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.lt_neqAle">lt_neqAle</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id">tau_max_neq0/=;</span> <span class="id">exact/RleP/sq_dev_max_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="update" class="id"><a name="update" class="">update</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#update.U">U</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#mkNNFinfun">mkNNFinfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_pos_ffun">update_pos_ffun</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#update">update</a></span>.<br/>
<br/>
<div class="doc">part 2 of lemma 1.4 </div>
<span class="vernacular">Section</span> <span id="bounding_empirical_variance" class="id"><a name="bounding_empirical_variance" class="">bounding_empirical_variance</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="bounding_empirical_variance.U" class="id"><a name="bounding_empirical_variance.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="bounding_empirical_variance.P" class="id"><a name="bounding_empirical_variance.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:213">U}</a></span>) (<span id="bounding_empirical_variance.X" class="id"><a name="bounding_empirical_variance.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:214">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="bounding_empirical_variance.C" class="id"><a name="bounding_empirical_variance.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:213">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="bounding_empirical_variance.good" class="id"><a name="bounding_empirical_variance.good" class="">good</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:213">U}</a></span>) (<span id="bounding_empirical_variance.eps" class="id"><a name="bounding_empirical_variance.eps" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.bad" class="id"><a name="bounding_empirical_variance.bad" class="">bad</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>.<br/>
<br/>
<span class="vernacular">Hypotheses</span> (<span id="bounding_empirical_variance.C01" class="id"><a name="bounding_empirical_variance.C01" class="">C01</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span>) (<span id="bounding_empirical_variance.PC_neq0" class="id"><a name="bounding_empirical_variance.PC_neq0" class="">PC_neq0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id">!=</span> <span class="id">0</span>)<br/>
&nbsp;&nbsp;(<span id="bounding_empirical_variance.pr_bad" class="id"><a name="bounding_empirical_variance.pr_bad" class="">pr_bad</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.bad">bad</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>) (<span id="bounding_empirical_variance.low_eps" class="id"><a name="bounding_empirical_variance.low_eps" class="">low_eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id">1/16</span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.WP" class="id"><a name="bounding_empirical_variance.WP" class="">WP</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.eps0" class="id"><a name="bounding_empirical_variance.eps0" class="">eps0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
 <span class="id">rewrite</span> <span class="id">-pr_bad</span>. <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_ge0">Pr_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.mu" class="id"><a name="bounding_empirical_variance.mu" class="">mu</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good]</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.var" class="id"><a name="bounding_empirical_variance.var" class="">var</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good]</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.mu_hat" class="id"><a name="bounding_empirical_variance.mu_hat" class="">mu_hat</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.var_hat" class="id"><a name="bounding_empirical_variance.var_hat" class="">var_hat</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.tau" class="id"><a name="bounding_empirical_variance.tau" class="">tau</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.tau_max" class="id"><a name="bounding_empirical_variance.tau_max" class="">tau_max</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.invariant" class="id"><a name="bounding_empirical_variance.invariant" class="">invariant</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_inv">filter1D_inv</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_variance.invariantW" class="id"><a name="bounding_empirical_variance.invariantW" class="">invariantW</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invW">filter1D_invW</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<div class="doc md"> ## lemma 1.4, page 5 (part 2) </div>
<div class="doc md"> ## eqn A.6--A.9, page 63 </div>
<span class="vernacular">Lemma</span> <span id="bound_empirical_variance_good" class="id"><a name="bound_empirical_variance_good" class="">bound_empirical_variance_good</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.invariant">invariant</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:227" class="id"><span id="i:226" class="id"><span id="i:225" class="id"><span id="i:224" class="id"><span id="i:223" class="id"><a name="i:227" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:223">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:223">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:223">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id">0</span>.<span class="id">25</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">var16</span> <span class="id">IC</span>.<br/>
<span class="id">have</span> <span class="id">I1C</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.invariantW">invariantW</a></span>. <span class="comment">(*&nbsp;todo:&nbsp;repeated,&nbsp;factor&nbsp;out&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="robustmean.weightedmean.html#invariant_impl">invariant_impl</a></span>.<br/>
<span class="id">have</span> <span class="id">Hvar_hat_2_eps</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulRA;</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0|lra]</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/var_hat</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good_gt0">pr_good_gt0</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.pr_bad">pr_bad</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.low_eps">low_eps</a></span>.<br/>
<span class="comment">(*a6*)</span><br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>) <span class="id">*</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.mu">mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.mu_hat">mu_hat</a></span>)))).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!</span>(<span class="id"><a href="robustmean.weightedmean.html#pr_good">pr_good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.pr_bad">pr_bad</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">-leR_pdivr_mulr//;</span> <span class="id">apply:</span> <span class="id"><a href="robustmean.weightedmean.html#weight_contrib">weight_contrib</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.pr_bad">pr_bad</a></span>.<br/>
<span class="comment">(*a6-a7*)</span><br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>) <span class="id">*</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)))))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2l">leR_wpmul2l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-pr_bad</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR_ge0">subR_ge0;</a></span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_1">Pr_1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply/leR_add2l/Rsqr_le_abs_1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[x</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:228">x]geR0_norm;</a></span> <span class="id">first</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#bound_mean_emean">bound_mean_emean</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact/addR_ge0/sqrt_pos/sqrt_pos</span>.<br/>
<span class="comment">(*a7-a8*)</span><br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/16</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> (<span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)))))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2l">leR_pmul2l;</a></span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDr">mulRDr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add;</a></span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">2!mulRA</span> <span class="id">-</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#Rsqr_sqrt">Rsqr_sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>))<span class="id">;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">Hvar_hat_2_eps</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-Rsqr_mult</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDr">mulRDr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_incr_1">Rsqr_incr_1;</a></span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/addR_ge0/sqrt_pos/sqrt_pos</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/addR_ge0;</span> <span class="id">apply/mulR_ge0;</span> <span class="id">try</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> (<span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)))))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_mult">sqrt_mult;</a></span> <span class="id">[|lra|apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_inv">sqrt_inv//</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_mult">sqrt_mult</a></span> (<span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">4</span>))<span class="id">;</span> <span class="id">[|lra|lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-Rsqr_def</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_Rsqr">sqrt_Rsqr;</a></span> <span class="id">[exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl|lra]</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_le_1">sqrt_le_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">/Rdiv</span> <span class="id">-!mulRA;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">first</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[lra|by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">Hvar_hat_2_eps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">[lra|left;apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_gt0">invR_gt0;lra]</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invRM">invRM;</a></span> <span class="id">[|by</span> <span class="id">apply/eqP;</span> <span class="id">lra</span>..<span class="id">]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> <span class="id">_</span>)) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> <span class="id">_</span>)) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id">/Rdiv</span> <span class="id">-4!mulRA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul">leR_pmul</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">first</span> <span class="id">lra;</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">/Rsqr;</span> <span class="gallina-kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-sqrt_inv</span> <span class="id">-sqrt_mult;</span> <span class="id">[|exact:</span> <span class="id">Hvar_hat_2_eps|by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0;</a></span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#Rsqr_sqrt">Rsqr_sqrt;</a></span> <span class="id">[by</span> <span class="id">right|lra]</span>.<br/>
<span class="comment">(*a8-a9*)</span><br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/16</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">1/16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> (<span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">1/16</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/sqrt</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">1/16</span>))))).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul">leR_pmul</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[lra|exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0]</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_ge0">addR_ge0;</a></span> <span class="id">[lra|apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[lra|exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr]]</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add;</a></span> <span class="id">first</span> <span class="id">exact/Rle_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul">leR_pmul;</a></span> <span class="id">[lra|exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr|lra|]</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_bounds_le">Rsqr_bounds_le;</a></span> <span class="id">split;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_inv">leR_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_inv">leR_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_gt0">mulR_gt0;</a></span> <span class="id">last</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2l">leR_wpmul2l;</a></span> <span class="id">last</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_le_1">sqrt_le_1;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_le_1">sqrt_le_1;</a></span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/leR_wpmul2r/leR_wpmul2r;</span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0|lra|interval]</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn A.10--A.11, page 63 </div>
<span class="vernacular">Lemma</span> <span id="bound_empirical_variance_bad" class="id"><a name="bound_empirical_variance_bad" class="">bound_empirical_variance_bad</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.invariant">invariant</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">2/3</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:233" class="id"><span id="i:232" class="id"><span id="i:231" class="id"><span id="i:230" class="id"><span id="i:229" class="id"><a name="i:233" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.bad">bad</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:229">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:229">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:229">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">var16</span> <span class="id">HiC</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good_gt0">pr_good_gt0</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.pr_bad">pr_bad</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.low_eps">low_eps</a></span>.<br/>
<br/>
<span class="id">have</span> <span class="id">-&gt;:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:238" class="id"><span id="i:237" class="id"><span id="i:236" class="id"><span id="i:235" class="id"><span id="i:234" class="id"><a name="i:238" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.bad">bad</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:234">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:234">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:234">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:243" class="id"><span id="i:242" class="id"><span id="i:241" class="id"><span id="i:240" class="id"><span id="i:239" class="id"><a name="i:243" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:239">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:239">i</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:248" class="id"><span id="i:247" class="id"><span id="i:246" class="id"><span id="i:245" class="id"><span id="i:244" class="id"><a name="i:248" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:244">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:244">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:244">i</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/var_hat</span> <span class="id"><a href="robustmean.weightedmean.html#evarE">evarE</a></span> <span class="id">/Var</span> <span class="id">{1}/Ex</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rplus_eq_reg_r">Rplus_eq_reg_r</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:258" class="id"><span id="i:257" class="id"><span id="i:256" class="id"><span id="i:255" class="id"><span id="i:254" class="id"><span id="i:253" class="id"><span id="i:252" class="id"><span id="i:251" class="id"><span id="i:250" class="id"><span id="i:249" class="id"><a name="i:258" class="">i</a></span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:249">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:249">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:249">i</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-addRA</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rplus_opp_l">Rplus_opp_l</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR0">addR0</a></span> <span class="id">/bad</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:263" class="id"><span id="i:262" class="id"><span id="i:261" class="id"><span id="i:260" class="id"><span id="i:259" class="id"><a name="i:263" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:259">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:259">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:259">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:268" class="id"><span id="i:267" class="id"><span id="i:266" class="id"><span id="i:265" class="id"><span id="i:264" class="id"><a name="i:268" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:264">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:264">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:264">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:273" class="id"><span id="i:272" class="id"><span id="i:271" class="id"><span id="i:270" class="id"><span id="i:269" class="id"><a name="i:273" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:269">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:269">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:269">i</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-big_union/=;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#disjoints_subset">disjoints_subset</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setCK">setCK</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setUC">setUC</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setUCr">setUCr/=</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigl">eq_bigl</a></span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#inE">inE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrl">big_distrl/=</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/tau</span> <span class="id">/mu_hat</span> <span class="id">/WP</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Weighted.dE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">-mulRA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#sq_devE">sq_devE</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-/</span>(<span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">-mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">mulVR</a></span> <span class="id">?mulR1</span>.<br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">3</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:283" class="id"><span id="i:282" class="id"><span id="i:281" class="id"><span id="i:280" class="id"><span id="i:279" class="id"><span id="i:278" class="id"><span id="i:277" class="id"><span id="i:276" class="id"><span id="i:275" class="id"><span id="i:274" class="id"><a name="i:283" class="">i</a></span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:274">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:274">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:274">i</a></span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-!addR_opp;</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2l">leR_wpmul2l;</a></span> <span class="id">first</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">2</span>) <span class="id">*</span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)))<span class="id">;</span> <span class="id">first</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span> (@<span class="id"><a href="robustmean.weightedmean.html#good_mass">good_mass</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C01">C01</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.pr_bad">pr_bad</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.low_eps">low_eps</a></span> <span class="id">HiC</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move/</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>) <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_ge0">Pr_ge0</a></span> <span class="id">_</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">good</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-Rmult_div_swap</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_div_l">Rmult_div_l;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_to_cplt">Pr_to_cplt</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.pr_bad">pr_bad;</a></span> <span class="id">exact</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_sumRl">leR_sumRl</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">i</span> <span class="id">igood</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C01">C01</a></span> <span class="id">_</span>).<span class="id">1</span>.<br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">3</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">0</span>.<span class="id">25</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">eps</a></span>)) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRBl">mulRBl</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar;</a></span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#bound_empirical_variance_good">bound_empirical_variance_good</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
<span class="id">apply</span> (@<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">3</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">1/16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">0</span>.<span class="id">25</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">1/16</span>)) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">var_hat</a></span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2r">leR_wpmul2r;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0|lra]</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2r">leR_wpmul2r;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0|lra]</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn 1.3--1.4, page 7 </div>
<span class="vernacular">Lemma</span> <span id="update_removed_weight" class="id"><a name="update_removed_weight" class="">update_removed_weight</a></span> (<span id="S:284" class="id"><a name="S:284" class="">S</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.U">U}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="C':285" class="id"><a name="C':285" class="">C'</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#update">update</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau_max">tau_max</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:290" class="id"><span id="i:289" class="id"><span id="i:288" class="id"><span id="i:287" class="id"><span id="i:286" class="id"><a name="i:290" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#S:284">S</a></span>) (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#C':285">C'</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:286">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:286">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:295" class="id"><span id="i:294" class="id"><span id="i:293" class="id"><span id="i:292" class="id"><span id="i:291" class="id"><a name="i:295" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#S:284">S</a></span>) (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:291">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:291">i</a></span>) <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau_max">tau_max</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:300" class="id"><span id="i:299" class="id"><span id="i:298" class="id"><span id="i:297" class="id"><span id="i:296" class="id"><a name="i:300" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#S:284">S</a></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:296">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:296">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:296">i</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">C'</span> <span class="id">tau_max_gt0</span>.<br/>
<span class="id">have</span> <span class="id">&lt;-</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:305" class="id"><span id="i:304" class="id"><span id="i:303" class="id"><span id="i:302" class="id"><span id="i:301" class="id"><a name="i:305" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id">S</span>) (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:301">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">C'</span> <span class="id"><a href="robustmean.weightedmean.html#i:301">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:301">i=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau_max">tau_max</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:310" class="id"><span id="i:309" class="id"><span id="i:308" class="id"><span id="i:307" class="id"><span id="i:306" class="id"><a name="i:310" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id">S</span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:306">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:306">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:306">i</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/C'</span> <span class="id">/update</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrr">big_distrr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/update_ffun-/tau_max-/tau</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">[/orP[/eqP|/eqP-&gt;]|];</span> <span class="id">lra</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-big_split/=;</span> <span class="id">apply</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">HiS;</span> <span class="id">rewrite</span> <span class="id">-mulRDl</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRA">addRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRK">subRK</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance">bounding_empirical_variance</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="update_invariant" class="id"><a name="update_invariant" class="">update_invariant</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="update_invariant.U" class="id"><a name="update_invariant.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="update_invariant.P" class="id"><a name="update_invariant.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:311">U}</a></span>) (<span id="update_invariant.X" class="id"><a name="update_invariant.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:312">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="update_invariant.C" class="id"><a name="update_invariant.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:311">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="update_invariant.good" class="id"><a name="update_invariant.good" class="">good</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:311">U}</a></span>) (<span id="update_invariant.eps" class="id"><a name="update_invariant.eps" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>).<br/>
<span class="vernacular">Hypotheses</span> (<span id="update_invariant.PC_neq0" class="id"><a name="update_invariant.PC_neq0" class="">PC_neq0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.C">C</a></span> <span class="id">!=</span> <span class="id">0</span>) (<span id="update_invariant.C01" class="id"><a name="update_invariant.C01" class="">C01</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.C">C</a></span>).<br/>
<span class="vernacular">Let</span> <span id="update_invariant.var_hat" class="id"><a name="update_invariant.var_hat" class="">var_hat</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="update_invariant.var" class="id"><a name="update_invariant.var" class="">var</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.good">good]</a></span>.<br/>
<span class="vernacular">Let</span> <span id="update_invariant.tau" class="id"><a name="update_invariant.tau" class="">tau</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="update_invariant.tau_max" class="id"><a name="update_invariant.tau_max" class="">tau_max</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Hypotheses</span> (<span id="update_invariant.pr_bad" class="id"><a name="update_invariant.pr_bad" class="">pr_bad</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.P">P</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.good">good</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.eps">eps</a></span>) (<span id="update_invariant.low_eps" class="id"><a name="update_invariant.low_eps" class="">low_eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id">1/16</span>)<br/>
&nbsp;&nbsp;(<span id="update_invariant.var16" class="id"><a name="update_invariant.var16" class="">var16</a></span> <span class="id">:</span> <span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.var_hat">var_hat</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_max_neq0" class="id"><a name="sq_dev_max_neq0" class="">sq_dev_max_neq0</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.var_hat">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span> <span class="id">!=</span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">rewrite</span> <span class="id">/sq_dev_max</span> <span class="id">=&gt;</span> <span class="id">var_hat_gt0</span>.<br/>
<span class="id">have</span> <span class="id">/RltP</span> <span class="id">HCgt0</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#weighted_total_gt0">weighted_total_gt0</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span>.<br/>
<span class="id">have</span> <span class="id">HCge0</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW</a></span> <span class="id">HCgt0</span>.<br/>
<span class="id">move:</span> <span class="id">var_hat_gt0</span>.<br/>
<span class="id">rewrite</span> <span class="id">/var_hat</span> <span class="id"><a href="robustmean.weightedmean.html#evarE">evarE</a></span> <span class="id">/Var</span>.<br/>
<span class="id">move=&gt;</span> <span class="id">/RltP</span> <span class="id">/fsumr_gt0[i</span> <span class="id">_]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Weighted.dE</a></span> <span class="id">=&gt;</span> <span class="id">/[dup]</span> <span class="id">=&gt;</span> <span class="id">/pmulR_lgt0'</span> <span class="id">=&gt;</span> <span class="id">sq_dev_gt0</span>.<br/>
<span class="id">have</span> <span class="id">/[apply]</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#pmulR_rgt0'">pmulR_rgt0'</a></span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#sq_RV_ge0">sq_RV_ge0</a></span> (<span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#4f0eb16db53d2455b24b93c7e9f16e54">`-cst</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="v:326" class="id"><span id="v:325" class="id"><span id="v:324" class="id"><span id="v:323" class="id"><span id="v:322" class="id"><a name="v:326" class="">v</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#v:322">v</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span> <span class="id"><a href="robustmean.weightedmean.html#v:322">v</a></span>) <span class="id">i</span>).<br/>
<span class="id">have</span> <span class="id">/[apply]</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#pmulR_lgt0'">pmulR_lgt0'</a></span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_ge0">invR_ge0</a></span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RltP">RltP</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">HCgt0</span>)).<br/>
<span class="id">have</span> <span class="id">/[apply]</span> <span class="id">Cigt0</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#pmulR_lgt0'">pmulR_lgt0'</a></span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RleP">RleP</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#FDist.ge0">FDist.ge0</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.P">P</a></span> <span class="id">i</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.gt_eqF">gt_eqF//;</a></span> <span class="id">apply/RltP/bigmaxR_gt0;</span> <span class="gallina-kwd">exists</span> <span class="id">i;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.gt_eqF">gt_eqF//;</a></span> <span class="id">exact/RltP</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#sq_devE">sq_devE;</a></span> <span class="id">apply/sq_dev_gt0/mulR_ge0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/mulR_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply</span> (<span class="id"><a href="robustmean.weightedmean.html#update_invariant.C01">C01</a></span> <span class="id">_</span>).<span class="id">1</span>.<br/>
<span class="id">exact/invR_ge0/weighted_total_gt0</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## lemma 1.5, page 5, update preserves the invariant of filter1D </div>
<span class="vernacular">Lemma</span> <span id="filter1D_inv_update" class="id"><a name="filter1D_inv_update" class="">filter1D_inv_update</a></span> <span class="id">:</span> <span class="gallina-kwd">let</span> <span id="C':327" class="id"><a name="C':327" class="">C'</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#update">update</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#filter1D_inv">filter1D_inv</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_inv">filter1D_inv</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C':327">C'</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.eps">eps</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">rewrite</span> <span class="id">/filter1D_inv</span> <span class="id">=&gt;</span> <span class="id">inv</span>.<br/>
<span class="id">have</span> <span class="id">var_ge0</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.var">var</a></span> <span class="gallina-kwd">by</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0</a></span>.<br/>
<span class="id">have</span> <span class="id">tau_max_gt0</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_neqAle">ltR_neqAle;</a></span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/eqP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max_neq0">sq_dev_max_neq0//;</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max_ge0">sq_dev_max_ge0</a></span>.<br/>
<span class="id">suff</span> <span class="id">H2</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:332" class="id"><span id="i:331" class="id"><span id="i:330" class="id"><span id="i:329" class="id"><span id="i:328" class="id"><a name="i:332" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.good">good</a></span>) (<span class="id"><a href="robustmean.weightedmean.html#update_invariant.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:328">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:328">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:328">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.eps">eps</a></span>) <span class="id">/</span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:337" class="id"><span id="i:336" class="id"><span id="i:335" class="id"><span id="i:334" class="id"><span id="i:333" class="id"><a name="i:337" class="">i</a></span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.good">good</a></span>) (<span class="id"><a href="robustmean.weightedmean.html#update_invariant.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:333">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:333">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.tau">tau</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:333">i</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!update_removed_weight//</span> <span class="id">!mulRDr;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add;</a></span> <span class="id">first</span> <span class="id">exact</span> <span class="id">inv</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRCA">mulRCA;</a></span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2l">leR_pmul2l;</a></span> <span class="id">[exact/divR_gt0|exact:</span> <span class="id">H2]</span>.<br/>
<span class="id">have</span> <span class="id">var16'</span> <span class="id">:</span> <span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.var">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.var_hat">var_hat</a></span> <span class="gallina-kwd">by</span> <span class="id">lra</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> (<span class="id"><a href="robustmean.weightedmean.html#bound_empirical_variance_good">bound_empirical_variance_good</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.C01">C01</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.pr_bad">pr_bad</a></span>).<br/>
<span class="id">apply:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span>((<span class="id">1-eps</span>)<span class="id">/2</span>))).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_gt0">invR_gt0;</a></span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divR_gt0">divR_gt0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_neq0">mulR_neq0;</a></span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rinv_div">Rinv_div</a></span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.eps">eps</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">0</span>.<span class="id">25</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.eps">eps</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<span class="id">5</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> ((<span class="id">1-eps</span>) <span class="id">/</span> (<span class="id">1-eps</span>)) <span class="gallina-kwd">by</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRR">divRR</a></span> <span class="id">?mulR1;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.gt_eqF">gt_eqF//;</a></span> <span class="id">apply/RltP;</span> <span class="id">lra</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> (<span class="id"><a href="robustmean.weightedmean.html#bound_empirical_variance_bad">bound_empirical_variance_bad</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.C01">C01</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.pr_bad">pr_bad</a></span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2r">leR_wpmul2r;</a></span> <span class="id">[exact:</span> <span class="id"><a href="robustmean.weightedmean.html#evar_ge0">evar_ge0|lra]</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="update_01" class="id"><a name="update_01" class="">update_01</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> (<span class="id"><a href="robustmean.weightedmean.html#update">update</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="id">move=&gt;</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id">/update/=;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/RleP</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">/forallP</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#update_pos_ffun">update_pos_ffun</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.PC_neq0">PC_neq0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>.<br/>
<span class="id">rewrite</span> <span class="id">/update_ffun</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negb_or">negb_or</a></span> <span class="id">=&gt;</span> <span class="id">/andP[sq_dev_neq0</span> <span class="id">Cu_neq0]</span>.<br/>
<span class="id">apply/RleP/mulr_ile1</span>.<br/>
<span class="id">-</span> <span class="id">exact/RleP/</span>(<span class="id"><a href="robustmean.weightedmean.html#update_invariant.C01">C01</a></span> <span class="id">u</span>).<span class="id">1</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">!coqRE</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.subr_ge0">subr_ge0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.ler_pdivr_mulr">ler_pdivr_mulr//</a></span> <span class="id">?mul1r//;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.lt_neqAle">lt_neqAle</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id">sq_dev_neq0/=;exact/RleP/sq_dev_max_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/RleP/sq_dev_max_ge</span>.<br/>
<span class="id">-</span> <span class="id">exact/RleP/</span>(<span class="id"><a href="robustmean.weightedmean.html#update_invariant.C01">C01</a></span> <span class="id">u</span>).<span class="id">2</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.lerBlDr">lerBlDr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.addrC">addrC</a></span> <span class="id">-lerBlDr</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subrr">subrr</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.divr_ge0">divr_ge0//</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/RleP/sq_dev_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/RleP/sq_dev_max_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant">update_invariant</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="base_case" class="id"><a name="base_case" class="">base_case</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="base_case.A" class="id"><a name="base_case.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="base_case.P" class="id"><a name="base_case.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:338">A}</a></span>) (<span id="base_case.eps" class="id"><a name="base_case.eps" class="">eps</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>) (<span id="base_case.good" class="id"><a name="base_case.good" class="">good</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:338">A}</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="ffun1" class="id"><a name="ffun1" class="">ffun1</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#31493a873acc18a8368490ef56022c0c">{ffun</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#105ca7b8847645320f5e1f7e9a4df4f2">[ffun=&gt;</a></span> <span class="id">1]</span>.<br/>
<span class="vernacular">Let</span> <span id="base_case.ffun1_subproof" class="id"><a name="base_case.ffun1_subproof" class="">ffun1_subproof</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#ce8c9a990e3e773a56ef37417d3761c6">[forall</a></span> <span id="a:344" class="id"><span id="a:343" class="id"><span id="a:342" class="id"><a name="a:344" class="">a,</a></span></span></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#ffun1">ffun1</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:342">a]</a></span>%<span class="id">mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
 <span class="gallina-kwd">by</span> <span class="id">apply/forallP</span> <span class="id">=&gt;</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE;</a></span> <span class="id">apply/RleP</span>. Qed.</div>
<span class="vernacular">Definition</span> <span id="Cpos_ffun1" class="id"><a name="Cpos_ffun1" class="">Cpos_ffun1</a></span> <span class="id">:=</span> @<span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#mkNNFinfun">mkNNFinfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.A">A</a></span> <span class="id"><a href="robustmean.weightedmean.html#ffun1">ffun1</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.ffun1_subproof">ffun1_subproof</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="PC1_neq0" class="id"><a name="PC1_neq0" class="">PC1_neq0</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#Cpos_ffun1">Cpos_ffun1</a></span> <span class="id">!=</span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
<span class="id">rewrite/Weighted</span>.<span class="id">total</span>.<br/>
<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">/Cpos_ffun1/=/ffun1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#FDist.f1">FDist.f1</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.oner_neq0">oner_neq0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="C1_is01" class="id"><a name="C1_is01" class="">C1_is01</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#Cpos_ffun1">Cpos_ffun1</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
 <span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">i;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE;</a></span> <span class="id">lra</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="base_case" class="id"><a name="base_case" class="">base_case:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.P">P</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.good">good</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#filter1D_inv">filter1D_inv</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#Cpos_ffun1">Cpos_ffun1</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#base_case.eps">eps</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
<span class="id">move=&gt;</span> <span class="id">Hbad_ratio;</span> <span class="id">rewrite</span> <span class="id">/filter1D_inv</span>.<br/>
<span class="id">rewrite</span> <span class="id">/Cpos_fun</span> <span class="id">/=</span>.<br/>
<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul0R">mul0R</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big1">big1;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul0R">mul0R</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big1">big1;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR0">mulR0;</a></span> <span class="id">exact/RleP</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#base_case">base_case</a></span>.<br/>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.funind.FunInd.html">FunInd</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.funind.Recdef.html">Recdef</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="bda2db261b3d9c2f14064c86fb7903c2" class="id"><a name="bda2db261b3d9c2f14064c86fb7903c2" class="">&quot;a '&lt;=?' b&quot;</a></span> <span class="id">:=</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Bool.Bool.html#bool_dec">Bool.bool_dec</a></span> (<span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#Rleb">Rleb</a></span> <span class="id">a</span> <span class="id">b</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;a '!=?' b&quot;</span> <span class="id">:=</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Bool.Bool.html#bool_dec">Bool.bool_dec</a></span> (<span class="id">a</span> <span class="id">!=</span> <span class="id">b</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span>) (<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">70</span>).<br/>
<br/>
<div class="doc md"> ## Algorithm 2, page 4 </div>
<span class="vernacular">Section</span> <span id="filter1D" class="id"><a name="filter1D" class="">filter1D</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="filter1D.U" class="id"><a name="filter1D.U" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="filter1D.P" class="id"><a name="filter1D.P" class="">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:345">U}</a></span>) (<span id="filter1D.X" class="id"><a name="filter1D.X" class="">X</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:346">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>).<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Obligation</span> <span class="vernacular">Tactic</span> <span class="id">:=</span> <span class="id">idtac</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="tr" class="id"><a name="tr" class="">tr</a></span> <span id="x:348" class="id"><a name="x:348" class="">x</a></span> <span id="y:349" class="id"><a name="y:349" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#Rleb">Rleb</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:348">x</a></span> <span class="id"><a href="robustmean.weightedmean.html#y:349">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x">&lt;&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#y:349">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:348">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/negP/RlebP/RleP;</span> <span class="id">rewrite</span> <span class="id">-ltNge</span> <span class="id">=&gt;</span> <span class="id">/RltP</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="filter1D_arg_decreasing" class="id"><a name="filter1D_arg_decreasing" class="">filter1D_arg_decreasing</a></span> (<span id="C:350" class="id"><a name="C:350" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.U">U</a></span>) (<span id="var:351" class="id"><a name="var:351" class="">var</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#var:351">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:350">C</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="HC:352" class="id"><a name="HC:352" class="">HC</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:350">C</a></span> <span class="id">!=</span> <span class="id">0,</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="K:353" class="id"><a name="K:353" class="">K</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#Rleb">Rleb</a></span> (<span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#HC:352">HC</a></span>) (<span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#var:351">var</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x">&lt;&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true,</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#234f50e13366f794cd6877cf832a5935">#|0</a></span>.<span class="id">-support</span> (<span class="id"><a href="robustmean.weightedmean.html#update">update</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#HC:352">HC</a></span>)<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#234f50e13366f794cd6877cf832a5935">|</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::coq_nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#234f50e13366f794cd6877cf832a5935">#|0</a></span>.<span class="id">-support</span> <span class="id"><a href="robustmean.weightedmean.html#C:350">C|</a></span>)%<span class="id">coq_nat</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="id">rewrite/Weighted</span>.<span class="id">total=&gt;</span> <span class="id">var_ge0</span> <span class="id">C01</span> <span class="id">HCneq0</span> <span class="id">evar16</span>.<br/>
<span class="id">apply/ssrnat</span>.<span class="id">ltP/proper_card/properP;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/subsetP</span> <span class="id">=&gt;</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id">!supportE</span> <span class="id">/update_ffun</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn;</a></span> <span class="id">[rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqxx">eqxx|rewrite</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negb_or">negb_or</a></span> <span class="id">=&gt;</span> <span class="id">/andP[]]</span>.<br/>
<span class="id">have</span> <span class="id">/RltP</span> <span class="id">HCgt0</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#weighted_total_gt0">weighted_total_gt0</a></span> <span class="id">HCneq0</span>.<br/>
<span class="id">have</span> <span class="id">HCge0</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.ltW">ltW</a></span> <span class="id">HCgt0</span>.<br/>
<span class="id">move:</span> (<span class="id">HCgt0</span>) <span class="id">=&gt;</span> <span class="id">/fsumr_gt0[u</span> <span class="id">_</span> <span class="id">/RltP]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0_gt0">mulr_ge0_gt0//</a></span> <span class="id">=&gt;</span> <span class="id">[/andP[Cu0</span> <span class="id">Pu0]|];</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/RleP;</span> <span class="id">exact:</span> (<span class="id">C01</span> <span class="id">u</span>).<span class="id">1</span>.<br/>
<span class="id">have</span> <span class="id">Cmax_neq0</span> <span class="id">:</span> <span class="id">C</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">[arg</a></span> <span class="id">max_</span>(<span id="i:355" class="id"><span id="i:354" class="id"><a name="i:355" class="">i</a></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">&gt;</a></span> <span class="id">u</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">|</a></span> <span class="id">C</span> <span class="id"><a href="robustmean.weightedmean.html#i:354">i</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id">HCneq0</span> <span class="id"><a href="robustmean.weightedmean.html#i:355">i]</a></span>%<span class="id">O</span> <span class="id">!=</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.TotalTheory.arg_maxP">arg_maxP</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.gt_eqF">gt_eqF</a></span>.<br/>
<span class="id">have</span> <span class="id">sq_dev_max_neq0</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id">HCneq0</span> <span class="id">!=</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max_neq0">sq_dev_max_neq0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">0</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">apply</span> (<span class="id"><a href="robustmean.weightedmean.html#tr">tr</a></span> <span class="id">evar16</span>)<span class="id">;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">[lra|apply</span> <span class="id">var_ge0]</span>.<br/>
<span class="gallina-kwd">exists</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">[arg</a></span> <span class="id">max_</span>(<span id="i:359" class="id"><span id="i:358" class="id"><span id="i:357" class="id"><span id="i:356" class="id"><a name="i:359" class="">i</a></span></span></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">&gt;</a></span> <span class="id">u</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">|</a></span> <span class="id">C</span> <span class="id"><a href="robustmean.weightedmean.html#i:356">i</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id">HCneq0</span> <span class="id"><a href="robustmean.weightedmean.html#i:357">i]</a></span>%<span class="id">O</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#supportE">supportE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/update_ffun</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#supportE">supportE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbK">negbK</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifF">ifF</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!coqRE</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulf_eq0">mulf_eq0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.subr_eq0">subr_eq0</a></span> <span class="id">-invr1</span> <span class="id">-</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mul1r">mul1r</a></span> (<span class="id">1^-1</span>))%<span class="id">mcR</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.eqr_div">eqr_div</a></span> <span class="id">?oner_eq0//</span> <span class="id">?mulr1</span> <span class="id">?mul1r//</span> <span class="id">/sq_dev_max</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#bigmaxRE">bigmaxRE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (@<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.TotalTheory.bigmax_eq_arg">bigmax_eq_arg</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">u</span>) <span class="id">?eq_refl</span> <span class="id">?orbT</span> <span class="id">?gt_eqF//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">exact/RleP/sq_dev_ge0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">sq_dev_max_neq0</span>)<span class="id">/=;</span> <span class="id">exact/negbTE</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Function</span> <span class="id">filter1D_rec</span> (<span id="var:395" class="id"><span id="var:390" class="id"><span id="var:381" class="id"><span id="var:375" class="id"><span id="var:370" class="id"><span id="var:360" class="id"><a name="var:395" class="">var</a></span></span></span></span></span></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>) (<span id="var_ge0:396" class="id"><span id="var_ge0:391" class="id"><span id="var_ge0:382" class="id"><span id="var_ge0:376" class="id"><span id="var_ge0:371" class="id"><span id="var_ge0:361" class="id"><a name="var_ge0:396" class="">var_ge0:</a></span></span></span></span></span></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#var:360">var</a></span>)<br/>
&nbsp;&nbsp;(<span id="C:397" class="id"><span id="C:392" class="id"><span id="C:383" class="id"><span id="C:377" class="id"><span id="C:372" class="id"><span id="C:362" class="id"><a name="C:397" class="">C</a></span></span></span></span></span></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.U">U</a></span>) (<span id="C01:398" class="id"><span id="C01:393" class="id"><span id="C01:384" class="id"><span id="C01:378" class="id"><span id="C01:373" class="id"><span id="C01:363" class="id"><a name="C01:398" class="">C01</a></span></span></span></span></span></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:362">C</a></span>) (<span id="HC:399" class="id"><span id="HC:394" class="id"><span id="HC:385" class="id"><span id="HC:379" class="id"><span id="HC:374" class="id"><span id="HC:364" class="id"><a name="HC:399" class="">HC</a></span></span></span></span></span></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:362">C</a></span> <span class="id">!=</span> <span class="id">0</span>)<br/>
&nbsp;&nbsp;<span class="id">{measure</span> (<span class="gallina-kwd">fun</span> <span id="C:405" class="id"><a name="C:405" class="">C</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#234f50e13366f794cd6877cf832a5935">#|</a></span> <span class="id">0</span>.<span class="id">-support</span> <span class="id"><a href="robustmean.weightedmean.html#C:405">C</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#234f50e13366f794cd6877cf832a5935">|</a></span>) <span class="id">C}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="empirical_mean:400" class="id"><span id="empirical_mean:386" class="id"><span id="empirical_mean:366" class="id"><a name="empirical_mean:400" class="">empirical_mean</a></span></span></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#HC:364">HC</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="empirical_variance:401" class="id"><span id="empirical_variance:387" class="id"><span id="empirical_variance:367" class="id"><a name="empirical_variance:401" class="">empirical_variance</a></span></span></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#HC:364">HC</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="robustmean.weightedmean.html#empirical_variance:367">empirical_variance</a></span> <span class="id"><a href="robustmean.weightedmean.html#bda2db261b3d9c2f14064c86fb7903c2">&lt;=?</a></span> <span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#var:360">var</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#left">left</a></span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="robustmean.weightedmean.html#empirical_mean:366">empirical_mean</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#right">right</a></span> <span class="id">_</span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="C':402" class="id"><span id="C':388" class="id"><span id="C':368" class="id"><a name="C':402" class="">C'</a></span></span></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#update">update</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#HC:364">HC</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="C'01:403" class="id"><span id="C'01:389" class="id"><span id="C'01:369" class="id"><a name="C'01:403" class="">C'01</a></span></span></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#update_01">update_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#HC:364">HC</a></span> <span class="id"><a href="robustmean.weightedmean.html#C01:363">C01</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C':368">C'</a></span> <span class="id">!=?</span> <span class="id">0</span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#right">right</a></span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#left">left</a></span> <span class="id">HC'</span> <span class="id">=&gt;</span>  @<span class="id"><a href="robustmean.weightedmean.html#filter1D_rec:365">filter1D_rec</a></span> <span class="id"><a href="robustmean.weightedmean.html#var:360">var</a></span> <span class="id"><a href="robustmean.weightedmean.html#var_ge0:361">var_ge0</a></span> <span class="id"><a href="robustmean.weightedmean.html#C':368">C'</a></span> <span class="id"><a href="robustmean.weightedmean.html#C'01:369">C'01</a></span> <span class="id">HC'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">end</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
<span class="id">rewrite/Weighted</span>.<span class="id">total=&gt;</span> <span class="id">var</span> <span class="id">var_ge0</span> <span class="id">C</span> <span class="id">C01</span> <span class="id">HC</span> <span class="id">evar16</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">_</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> (<span class="id"><a href="robustmean.weightedmean.html#filter1D_arg_decreasing">filter1D_arg_decreasing</a></span> (<span class="id">var_ge0</span>)).<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="filter1D" class="id"><a name="filter1D" class="">filter1D</a></span> <span id="var:443" class="id"><a name="var:443" class="">var</a></span> <span id="var_ge0:444" class="id"><a name="var_ge0:444" class="">var_ge0</a></span> <span class="id">:=</span> (@<span class="id"><a href="robustmean.weightedmean.html#filter1D_rec">filter1D_rec</a></span> <span class="id"><a href="robustmean.weightedmean.html#var:443">var</a></span> <span class="id"><a href="robustmean.weightedmean.html#var_ge0:444">var_ge0</a></span> (<span class="id"><a href="robustmean.weightedmean.html#Cpos_ffun1">Cpos_ffun1</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.U">U</a></span>) (@<span class="id"><a href="robustmean.weightedmean.html#C1_is01">C1_is01</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.U">U</a></span>) (@<span class="id"><a href="robustmean.weightedmean.html#PC1_neq0">PC1_neq0</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
<br/>
<span class="vernacular">Functional</span> <span class="vernacular">Scheme</span> <span class="id">filter1D_rec_ind</span> <span class="id">:=</span> <span class="id">Induction</span> <span class="gallina-kwd">for</span> <span class="id">filter1D_rec</span> <span class="id">Sort</span> <span class="gallina-kwd">Prop</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="filter1D_correct" class="id"><a name="filter1D_correct" class="">filter1D_correct</a></span> <span id="good:445" class="id"><a name="good:445" class="">good</a></span> <span id="eps:446" class="id"><a name="eps:446" class="">eps</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.P">P</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:445">good</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:446">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:446">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id">1/16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="mu:447" class="id"><a name="mu:447" class="">mu</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:445">good]</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="var:448" class="id"><a name="var:448" class="">var</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:445">good]</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="var_ge0:449" class="id"><a name="var_ge0:449" class="">var_ge0</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">cvariance_ge0</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:445">good</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D">filter1D</a></span> <span class="id"><a href="robustmean.weightedmean.html#var_ge0:449">var_ge0</a></span> <span class="id">is</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">mu_hat</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">then</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">`|</a></span> <span class="id"><a href="robustmean.weightedmean.html#mu:447">mu</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">mu_hat</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">|</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="robustmean.weightedmean.html#var:448">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:446">eps</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:446">eps</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">+</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#var:448">var</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:446">eps</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:446">eps</a></span>))<br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
<span class="id">rewrite</span> <span class="id">/filter1D</span> <span class="id">=&gt;</span> <span class="id">pr_bad</span> <span class="id">low_eps</span>.<br/>
<span class="id">have</span> <span class="id">pr_good</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">pr_good</a></span> <span class="id">pr_bad</span>.<br/>
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#base_case">base_case</a></span> <span class="id">pr_bad</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_rec_ind">filter1D_rec_ind</a></span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">C</span> <span class="id">C01</span> <span class="id">HC</span> <span class="id">evar16</span> <span class="id">_</span> <span class="id">Inv</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">leR_trans;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="robustmean.weightedmean.html#bound_mean_emean">bound_mean_emean</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id">pr_bad//</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_add">leR_add;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">pr_bad</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA;</a></span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_le_1_alt">sqrt_le_1_alt;</a></span> <span class="id">rewrite</span> <span class="id">-pr_good</span> <span class="id">-Pr_to_cplt</span> <span class="id">-pr_bad</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">mulRA</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">repeat</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2r">leR_wpmul2r;[apply/invR_ge0;lra|</a></span> <span class="id">|lra|apply/RleP]</span>.<br/>
<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">C</span> <span class="id">C01</span> <span class="id">HC</span> <span class="id">evar16</span> <span class="id">_</span> <span class="id">PC_eq0</span> <span class="id">_</span> <span class="id">/</span>(<span class="id"><a href="robustmean.weightedmean.html#filter1D_inv_update">filter1D_inv_update</a></span> <span class="id">C01</span> <span class="id">pr_bad</span> <span class="id">low_eps</span> (<span class="id"><a href="robustmean.weightedmean.html#tr">tr</a></span> <span class="id">evar16</span>)).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">PC0</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="x:450" class="id"><a name="x:450" class="">x,</a></span> <span class="id"><a href="robustmean.weightedmean.html#update">update</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X</a></span> <span class="id">HC</span> <span class="id"><a href="robustmean.weightedmean.html#x:450">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:450">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span> <span class="id">PC_eq0=&gt;</span> <span class="id">/negP/negbNE;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.psumr_eq0">psumr_eq0;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">!coqRE</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">?nneg_finfun_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move/allP=&gt;</span> <span class="id">PC0</span> <span class="id">x;</span> <span class="id">apply/eqP/PC0/mem_index_enum</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/filter1D_inv</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">?</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulNR">mulNR</a></span> <span class="id">PC0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR0">subR0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">X]eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulNR">mulNR</a></span> <span class="id">PC0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR0">subR0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">pr_good</span> <span class="id">pr_bad;</span> <span class="id">rewrite</span> <span class="id">/Pr;</span> <span class="id">nra</span>.<br/>
<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">C</span> <span class="id">C01</span> <span class="id">HC</span> <span class="id">evar16</span> <span class="id">_</span> <span class="id">PC_neq0</span> <span class="id">_</span> <span class="id">IH</span> <span class="id">Inv</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/IH/filter1D_inv_update</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply/tr</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D">filter1D</a></span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
