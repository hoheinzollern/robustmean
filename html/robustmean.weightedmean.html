
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module robustmean.weightedmean</title>
<meta name="description" content="Documentation of Coq module robustmean.weightedmean" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module robustmean.weightedmean</h1>
<div class="coq">
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html">ssralg</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html">ssrnum</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.matrix.html">matrix</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.boolp">boolp</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct">Rstruct</a></span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.reals">reals</a></span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.mathcomp_extra">mathcomp_extra</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Reals.html">Reals</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.micromega.Lra.html">Lra</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR">ssrR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext">Reals_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.realType_ext">realType_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.logb">logb</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext">ssr_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssralg_ext">ssralg_ext</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext">bigop_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist">fdist</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba">proba</a></span>.<br/>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="vernacular">Implicit</span> <span class="vernacular">Defensive</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">R_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">reals_ext_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">fdist_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">proba_scope</span>.<br/>
<br/>
<span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory">Order.POrderTheory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Theory">Order.Theory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory">Num.Theory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory">GRing.Theory</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="R" class="id">
  <a name="R" class="">R</a>
</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#real_realType">real_realType</a></span>.<br/>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for Interval.Tactic">Interval.Tactic</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="robustmean.robustmean.html">robustmean</a></span> <span class="id"><a href="robustmean.util.html">util</a></span>.<br/>
<br/>
<div class="ssrdoc md">
# lemmas 1.4, 1.5, etc.                                                    
                                                                           
This file contains a formalization of lemmas from the chapter 1 of         
Jacob Steinhardt, Robust learning: information theory and algorithms,      
PhD Standford 2018.                                                        
                                                                           
|   Definitions |    | Meaning                                            |
|---------------|----|----------------------------------------------------|
|       is_01 C | := | forall i, 0 &lt;= C i &lt;= 1                             
|    Weighted.d | == | given a distribution $d_0$ and a non-negative       
|               |    | function $g$, returns the distribution              
|               |    | $a\mapsto \frac{g(a) * d_0(a)}{\sum_b g(b) * d_0(b)}$ 
|       Split.d | == | given a distribution $d_0$ and a non-negative       
|               |    | function $h$, returns the distribution              
|               |    | $\begin{array}{rl} (a,b) \mapsto &amp; h(a) * d_0(a) \textrm{ if } b \\ &amp; (1 - h(a))*d_0(a) \textrm{ o.w.}\end{array}$ 
|      mean X A | := | `E_[X \| A]                                         
|      sq_dev X | == | "squared deviation": $(X - mean)^2$                 
|       var X A | := | `V_[X \| A]                                         
|         emean | == | empirical/estimate mean of the data,                
|               |    | weighted mean of all the points                     
|          evar | == | empirical variance                                  
|    emean_cond | == | mean of the at least $1 - \varepsilon$ fraction     
|               |    | (under c) of remaining good points                  
|     evar_cond | == |                                                     
|  filter1D_inv | == | the amount of mass removed from the good points is  
|               |    | smaller than that removed from the bad points       
| filter1D_invW | == | the amount of mass attached to the good points is   
|               |    | at least $1 - \varepsilon$                          
|      filter1D | == | robust mean estimation by comparing mean and        
|               |    | variance                                            
                                                                           
</div>
<br/>
<span class="vernacular">Definition</span> <span id="is_01" class="id">
  <a name="is_01" class="">is_01</a>
</span> (<span id="U:1" class="id">
  <a name="U:1" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="C:2" class="id">
  <a name="C:2" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#31493a873acc18a8368490ef56022c0c">{ffun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:1">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="i:3" class="id">
  <a name="i:3" class="">i,</a>
</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#fbdebc8c1a732d40499de973c18a9a13">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:2">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:3">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#fbdebc8c1a732d40499de973c18a9a13">&lt;=</a></span> <span class="id">1</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span id="Weighted" class="id">
  <a name="Weighted" class="">Weighted</a>
</span>.<br/>
<span class="vernacular">Section</span> <span id="Weighted.def" class="id">
  <a name="Weighted.def" class="">def</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="Weighted.def.A" class="id">
  <a name="Weighted.def.A" class="">A</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="Weighted.def.d0" class="id">
  <a name="Weighted.def.d0" class="">d0</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:4">A}</a></span>) (<span id="Weighted.def.g" class="id">
  <a name="Weighted.def.g" class="">g</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:4">A</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Weighted.total" class="id">
  <a name="Weighted.total" class="">total</a>
</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="a:11" class="id"><span id="a:10" class="id"><span id="a:9" class="id"><span id="a:8" class="id"><span id="a:7" class="id">
  <a name="a:11" class="">a</a>
</span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.A">A</a></span>) <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:7">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:7">a</a></span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="Weighted.def.total_neq0" class="id">
  <a name="Weighted.def.total_neq0" class="">total_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total</a></span> <span class="id">!=</span> <span class="id">0</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Weighted.f" class="id">
  <a name="Weighted.f" class="">f</a>
</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">[ffun</a></span> <span id="a:13" class="id">
  <a name="a:13" class="">a</a>
</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">=&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:13">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:13">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total]</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Weighted.total_gt0" class="id">
  <a name="Weighted.total_gt0" class="">total_gt0</a>
</span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Syntax.::ring_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total</a></span>)<span class="id">%mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.lt_neqAle">lt_neqAle</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.total_neq0">total_neq0/=</a></span> <span class="id">/total</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.sumr_ge0">sumr_ge0//</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/mulr_ge0/FDist</span>.<span class="id">ge0;</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/=</span> <span class="id">/forallP</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Weighted.def.f0" class="id">
  <a name="Weighted.def.f0" class="">f0</a>
</span> <span id="a:14" class="id">
  <a name="a:14" class="">a</a>
</span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:14">a</a></span>)<span class="id">%mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id">/f</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.divr_ge0">divr_ge0//;</a></span> <span class="id">last</span> <span class="id">exact/ltW/total_gt0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">//;</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/=</span> <span class="id">/forallP;</span> <span class="id">exact</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Weighted.def.f1" class="id">
  <a name="Weighted.def.f1" class="">f1</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="a:19" class="id"><span id="a:18" class="id"><span id="a:17" class="id"><span id="a:16" class="id"><span id="a:15" class="id">
  <a name="a:19" class="">a</a>
</span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.A">A</a></span>) <span class="id"><a href="robustmean.weightedmean.html#Weighted.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:15">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">rewrite</span> <span class="id">/f;</span> <span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">divRE</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-big_distrl</span> <span class="id">/=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRV">mulRV</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="Weighted.d" class="id">
  <a name="Weighted.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.A">A}</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#locked">locked</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#FDist.make">FDist.make</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.f0">f0</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.f1">f1</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Weighted.dE" class="id">
  <a name="Weighted.dE" class="">dE</a>
</span> <span id="a:20" class="id">
  <a name="a:20" class="">a</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.d">d</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:20">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:20">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:20">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.total">total</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/d;</span> <span class="id">unlock;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted.def">def</a></span>.<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted">Weighted</a></span>.<br/>
<br/>
<span class="vernacular">Module</span> <span id="Split" class="id">
  <a name="Split" class="">Split</a>
</span>.<br/>
<span class="vernacular">Section</span> <span id="Split.def" class="id">
  <a name="Split.def" class="">def</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="Split.def.A" class="id">
  <a name="Split.def.A" class="">A</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="Split.def.d0" class="id">
  <a name="Split.def.d0" class="">d0</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:21">A}</a></span>) (<span id="Split.def.h" class="id">
  <a name="Split.def.h" class="">h</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:21">A</a></span>).<br/>
<span class="vernacular">Hypothesis</span> <span id="Split.def.weight_C" class="id">
  <a name="Split.def.weight_C" class="">weight_C</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span>.<br/>
<span class="vernacular">Definition</span> <span id="Split.g" class="id">
  <a name="Split.g" class="">g</a>
</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="x:25" class="id">
  <a name="x:25" class="">x</a>
</span> <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> <span class="id"><a href="robustmean.weightedmean.html#x:25">x</a></span>.<span class="id">2</span> <span class="gallina-kwd">then</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:25">x</a></span>.<span class="id">1</span> <span class="gallina-kwd">else</span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:25">x</a></span>.<span class="id">1</span>.<br/>
<span class="vernacular">Definition</span> <span id="Split.f" class="id">
  <a name="Split.f" class="">f</a>
</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">[ffun</a></span> <span id="x:26" class="id">
  <a name="x:26" class="">x</a>
</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#f6cd22e759500ffb5ebfcc5c9dcc97ef">=&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:26">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:26">x</a></span>.<span class="id">1]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.g_ge0" class="id">
  <a name="Split.g_ge0" class="">g_ge0</a>
</span> <span id="x:27" class="id">
  <a name="x:27" class="">x</a>
</span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.g">g</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:27">x</a></span>)<span class="id">%mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">rewrite</span> <span class="id">/g;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">_;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/=</span> <span class="id">/forallP</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">have</span> <span class="id">[_</span> <span class="id">?]</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.weight_C">weight_C</a></span> <span class="id">x</span>.<span class="id">1;</span> <span class="id">exact/RleP/subR_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Split.def.f0" class="id">
  <a name="Split.def.f0" class="">f0</a>
</span> <span id="a:28" class="id">
  <a name="a:28" class="">a</a>
</span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:28">a</a></span>)<span class="id">%mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span> <span class="id">/f</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">coqRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#Split.g_ge0">g_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="Split.def.f1" class="id">
  <a name="Split.def.f1" class="">f1</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#8de8b1dd76d6fc6f874a15e4c5bdcaaa">\sum_a</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:29">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">transitivity</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="x:41" class="id"><span id="x:40" class="id"><span id="x:39" class="id"><span id="x:38" class="id"><span id="x:37" class="id"><span id="x:36" class="id"><span id="x:35" class="id"><span id="x:34" class="id"><span id="x:33" class="id"><span id="x:32" class="id">
  <a name="x:41" class="">x</a>
</span></span></span></span></span></span></span></span></span></span> <span class="gallina-kwd">in</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.A">A]</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setT">setT</a></span>)<span class="id">%SET</span>) <span class="id"><a href="robustmean.weightedmean.html#Split.f">f</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:32">x</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigl">eq_bigl</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">-[a</span> <span class="id">b];</span> <span class="id">rewrite</span> <span class="id">!inE</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#exchange_big">exchange_big//=</a></span> <span class="id"><a href="robustmean.util.html#setT_bool">setT_bool</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_setU1">big_setU1//=</a></span> <span class="id">?inE//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1//=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-big_split//=</span> <span class="id">-</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_setT">Pr_setT</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">a</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">!ffunE</span> <span class="id">/g</span> <span class="id">/=;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="Split.d" class="id">
  <a name="Split.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id">_}</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#locked">locked</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#FDist.make">FDist.make</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.f0">f0</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.f1">f1</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Split.fst_RV" class="id">
  <a name="Split.fst_RV" class="">fst_RV</a>
</span> (<span id="X:42" class="id">
  <a name="X:42" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.d">d</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="x:43" class="id">
  <a name="x:43" class="">x</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="robustmean.weightedmean.html#X:42">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#x:43">x</a></span>.<span class="id">1</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.dE" class="id">
  <a name="Split.dE" class="">dE</a>
</span> <span id="a:44" class="id">
  <a name="a:44" class="">a</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#Split.d">d</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">2</span> <span class="gallina-kwd">then</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">1</span> <span class="gallina-kwd">else</span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.h">h</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">1</span>)) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:44">a</a></span>.<span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/d;</span> <span class="id">unlock;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">ffunE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.Pr_setXT" class="id">
  <a name="Split.Pr_setXT" class="">Pr_setXT</a>
</span> <span id="good:45" class="id">
  <a name="good:45" class="">good</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:45">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.d">d</a></span> (<span class="id"><a href="robustmean.weightedmean.html#good:45">good</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">rewrite</span> <span class="id">/Pr</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX/=;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.util.html#setT_bool">setT_bool</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_setU1">big_setU1//=</a></span> <span class="id">?inE//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!dE/=</span> <span class="id">-mulRDl</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRCA">addRCA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR0">addR0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Split.cEx" class="id">
  <a name="Split.cEx" class="">cEx</a>
</span> (<span id="X:46" class="id">
  <a name="X:46" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#Split.def.d0">d0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span id="good:47" class="id">
  <a name="good:47" class="">good</a>
</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:47">good]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[fst_RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#X:46">X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> (<span class="id"><a href="robustmean.weightedmean.html#good:47">good</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">[set:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool]</a></span>)<span class="id">]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">rewrite</span> <span class="id">!cExE</span> <span class="id">-Pr_setXT;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext#big_setX">big_setX//=;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.util.html#setT_bool">setT_bool</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_setU1">big_setU1//=</a></span> <span class="id">?inE//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#big_set1">big_set1</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!dE/=</span> <span class="id">/fst_RV/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulRDr</span> <span class="id">-mulRDl</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRCA">addRCA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">addR_opp</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">subRR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR0">addR0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">mul1R</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Split.def">def</a></span>.<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#Split">Split</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="nnegP" class="id">
  <a name="nnegP" class="">nnegP</a>
</span> (<span id="U:48" class="id">
  <a name="U:48" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="C:49" class="id">
  <a name="C:49" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#31493a873acc18a8368490ef56022c0c">{ffun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:48">U</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="u:50" class="id">
  <a name="u:50" class="">u</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#U:48">U,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:49">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:50">u</a></span>) <span class="id">-&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#ce8c9a990e3e773a56ef37417d3761c6">[forall</a></span> <span id="a:53" class="id"><span id="a:52" class="id"><span id="a:51" class="id">
  <a name="a:53" class="">a,</a>
</span></span></span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#cb42ec59ad57b25928e1718b4e69e031">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:49">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#a:51">a</a></span>)<span class="id">%mcR]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">h;</span> <span class="id">apply/forallP</span> <span class="id">=&gt;</span> <span class="id">u;</span> <span class="id">apply/RleP</span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="Cpos_fun" class="id">
  <a name="Cpos_fun" class="">Cpos_fun</a>
</span> (<span id="U:54" class="id">
  <a name="U:54" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="C:55" class="id">
  <a name="C:55" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:54">U</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="h:57" class="id">
  <a name="h:57" class="">h</a>
</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="u:56" class="id">
  <a name="u:56" class="">u</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#U:54">U,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:55">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:56">u</a></span>) <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:54">U</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#mkNNFinfun">mkNNFinfun</a></span> (<span class="id"><a href="robustmean.weightedmean.html#nnegP">nnegP</a></span> <span class="id"><a href="robustmean.weightedmean.html#h:57">h</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="mean" class="id">
  <a name="mean" class="">mean</a>
</span> (<span id="U:58" class="id">
  <a name="U:58" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:59" class="id">
  <a name="P:59" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:58">U}</a></span>) (<span id="X:60" class="id">
  <a name="X:60" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:59">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="A:61" class="id">
  <a name="A:61" class="">A</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:58">U}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:61">A]</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="var" class="id">
  <a name="var" class="">var</a>
</span> (<span id="U:62" class="id">
  <a name="U:62" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:63" class="id">
  <a name="P:63" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:62">U}</a></span>) (<span id="X:64" class="id">
  <a name="X:64" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:63">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="A:65" class="id">
  <a name="A:65" class="">A</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:62">U}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:65">A]</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="emean" class="id">
  <a name="emean" class="">emean</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="emean.U" class="id">
  <a name="emean.U" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="emean.P" class="id">
  <a name="emean.P" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:66">U}</a></span>) (<span id="emean.X" class="id">
  <a name="emean.X" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:67">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;(<span id="emean.C" class="id">
  <a name="emean.C" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:66">U</a></span>) (<span id="emean.PC_neq0" class="id">
  <a name="emean.PC_neq0" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:67">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:69">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="emean" class="id">
  <a name="emean" class="">emean</a>
</span> <span class="id">:=</span> <span class="gallina-kwd">let</span> <span id="WP:71" class="id">
  <a name="WP:71" class="">WP</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.PC_neq0">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WX:72" class="id">
  <a name="WX:72" class="">WX</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#WP:71">WP</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean.X">X</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">`E</a></span> <span class="id"><a href="robustmean.weightedmean.html#WX:72">WX</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="emeanE" class="id">
  <a name="emeanE" class="">emeanE</a>
</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:77" class="id"><span id="i:76" class="id"><span id="i:75" class="id"><span id="i:74" class="id"><span id="i:73" class="id">
  <a name="i:77" class="">i</a>
</span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#emean.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#emean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:73">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:73">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:73">i</a></span>) <span class="id">/</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:82" class="id"><span id="i:81" class="id"><span id="i:80" class="id"><span id="i:79" class="id"><span id="i:78" class="id">
  <a name="i:82" class="">i</a>
</span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#emean.U">U</a></span>) <span class="id"><a href="robustmean.weightedmean.html#emean.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:78">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:78">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">rewrite</span> <span class="id">/emean</span> <span class="id">/Ex</span> <span class="id">/ambient_dist</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">divRE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrl">big_distrl/=;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">-mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRCA">mulRCA;</a></span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">Weighted.dE</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">mulRC</a></span> <span class="id">_</span> (<span class="id"><a href="robustmean.weightedmean.html#emean.P">P</a></span> <span class="id">u</span>)) <span class="id">-divRE;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">/</a></span> <span class="id">_</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="emean0" class="id">
  <a name="emean0" class="">emean0</a>
</span> <span class="id">:</span> (<span class="gallina-kwd">forall</span> <span id="u:83" class="id">
  <a name="u:83" class="">u,</a>
</span> <span class="id"><a href="robustmean.weightedmean.html#emean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:83">u</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>) <span class="id">-&gt;</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">move=&gt;</span> <span class="id">X0</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#emeanE">emeanE</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">X0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR0">mulR0</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big1">big1</a></span> <span class="id">//</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">divRE</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul0R">mul0R</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="sq_dev" class="id">
  <a name="sq_dev" class="">sq_dev</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="sq_dev.U" class="id">
  <a name="sq_dev.U" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="sq_dev.P" class="id">
  <a name="sq_dev.P" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:84">U}</a></span>) (<span id="sq_dev.X" class="id">
  <a name="sq_dev.X" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:85">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="sq_dev.C" class="id">
  <a name="sq_dev.C" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:84">U</a></span>) (<span id="sq_dev.PC_neq0" class="id">
  <a name="sq_dev.PC_neq0" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:85">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:87">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="sq_dev" class="id">
  <a name="sq_dev" class="">sq_dev</a>
</span> <span class="id">:=</span> <span class="gallina-kwd">let</span> <span id="mu_hat:89" class="id">
  <a name="mu_hat:89" class="">mu_hat</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.PC_neq0">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#4f0eb16db53d2455b24b93c7e9f16e54">`-cst</a></span> <span class="id"><a href="robustmean.weightedmean.html#mu_hat:89">mu_hat</a></span>)<span class="id">`^2</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_devE" class="id">
  <a name="sq_devE" class="">sq_devE</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#4f0eb16db53d2455b24b93c7e9f16e54">`-cst</a></span> (<span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.PC_neq0">PC_neq0</a></span>))<span class="id">`^2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_ge0" class="id">
  <a name="sq_dev_ge0" class="">sq_dev_ge0</a>
</span> <span id="u:90" class="id">
  <a name="u:90" class="">u</a>
</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:90">u</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_dev</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#sq_RV_pow2">sq_RV_pow2;</a></span> <span class="id">exact:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="sq_dev_max" class="id">
  <a name="sq_dev_max" class="">sq_dev_max</a>
</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#6e9df56134f2cda6e085e904a3dda126">\rmax_</a></span>(<span id="i:93" class="id"><span id="i:92" class="id"><span id="i:91" class="id">
  <a name="i:93" class="">i</a>
</span></span></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#6e9df56134f2cda6e085e904a3dda126">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:91">i</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:91">i</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Weighted_support_nonempty" class="id">
  <a name="Weighted_support_nonempty" class="">Weighted_support_nonempty</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f">{i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:94">i</a></span> <span class="id">!=</span> <span class="id">0}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">move:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.PC_neq0">PC_neq0;</a></span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.psumr_neq0">psumr_neq0;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">*;</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.mulr_ge0">mulr_ge0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.util.html#nneg_finfun_ge0">nneg_finfun_ge0</a></span>.<br/>
<span class="id">case/hasP/sig2W=&gt;</span> <span class="id">/=</span> <span class="id">x</span> <span class="id">?</span>.<br/>
<span class="id">move/RltP/pmulR_lgt0'</span>.<br/>
<span class="id">have:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#fdist_ge0_le1">fdist_ge0_le1</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.P">P</a></span> <span class="id">x</span>.<br/>
<span class="id">case/andP=&gt;</span> <span class="id">/[swap]</span> <span class="id">_</span> <span class="id">/RleP</span> <span class="id">/[swap]</span> <span class="id">/[apply]</span>.<br/>
<span class="id">move/ltR_eqF;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id">=&gt;</span> <span class="id">?</span>.<br/>
<span class="gallina-kwd">by</span> <span class="gallina-kwd">exists</span> <span class="id">x</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="j" class="id">
  <a name="j" class="">j</a>
</span> <span class="id">:=</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrfun.html#sval">sval</a></span> <span class="id"><a href="robustmean.weightedmean.html#Weighted_support_nonempty">Weighted_support_nonempty</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="sq_dev_arg_max" class="id">
  <a name="sq_dev_arg_max" class="">sq_dev_arg_max</a>
</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">[arg</a></span> <span class="id">max_</span>(<span id="i:96" class="id"><span id="i:95" class="id">
  <a name="i:96" class="">i</a>
</span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#j">j</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:95">i</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:96">i]%O</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_max_eq_arg" class="id">
  <a name="sq_dev_max_eq_arg" class="">sq_dev_max_eq_arg</a>
</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev_arg_max">sq_dev_arg_max</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">rewrite</span> <span class="id">/sq_dev_max</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#bigmaxRE">bigmaxRE</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.TotalTheory.bigmax_eq_arg">bigmax_eq_arg;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="robustmean.weightedmean.html#Weighted_support_nonempty">Weighted_support_nonempty</a></span>.<br/>
<span class="id">move=&gt;</span> <span class="id">*;</span> <span class="id">exact/RleP/sq_dev_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_max_ge0" class="id">
  <a name="sq_dev_max_ge0" class="">sq_dev_max_ge0</a>
</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_dev_max</span> <span class="id">-big_filter;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#bigmaxR_ge0">bigmaxR_ge0=&gt;</a></span> <span class="id">*;</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_ge0">sq_dev_ge0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="sq_dev_max_ge" class="id">
  <a name="sq_dev_max_ge" class="">sq_dev_max_ge</a>
</span> <span id="u:97" class="id">
  <a name="u:97" class="">u</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:97">u</a></span> <span class="id">!=</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#u:97">u</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">move=&gt;</span> <span class="id">Cu0</span>.<br/>
<span class="id">rewrite</span> <span class="id">/sq_dev_max</span> <span class="id">-big_filter;</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_bigmaxR">leR_bigmaxR</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#mem_filter">mem_filter</a></span> <span class="id">Cu0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#mem_index_enum">mem_index_enum</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="evar" class="id">
  <a name="evar" class="">evar</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="evar.U" class="id">
  <a name="evar.U" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="evar.P" class="id">
  <a name="evar.P" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:98">U}</a></span>) (<span id="evar.X" class="id">
  <a name="evar.X" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:99">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;(<span id="evar.C" class="id">
  <a name="evar.C" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:98">U</a></span>) (<span id="evar.PC_neq0" class="id">
  <a name="evar.PC_neq0" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:99">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:101">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="evar" class="id">
  <a name="evar" class="">evar</a>
</span> <span class="id">:=</span> <span class="gallina-kwd">let</span> <span id="WP:103" class="id">
  <a name="WP:103" class="">WP</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC_neq0">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WX:104" class="id">
  <a name="WX:104" class="">WX</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#WP:103">WP</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar.X">X</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#c7a4904f3d060a494e43ad1a77d88c00">`V</a></span> <span class="id"><a href="robustmean.weightedmean.html#WX:104">WX</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="evarE" class="id">
  <a name="evarE" class="">evarE</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> (<span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC_neq0">PC_neq0</a></span>) <span class="id"><a href="robustmean.weightedmean.html#evar.PC_neq0">PC_neq0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="evar0P" class="id">
  <a name="evar0P" class="">evar0P</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#reflect">reflect</a></span> (<span class="gallina-kwd">forall</span> <span id="i:105" class="id">
  <a name="i:105" class="">i,</a>
</span> <span class="id"><a href="robustmean.weightedmean.html#evar.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:105">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:105">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC_neq0">PC_neq0</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:105">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>) (<span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id">0</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#evarE">evarE</a></span> <span class="id"><a href="robustmean.weightedmean.html#emeanE">emeanE</a></span>.<br/>
<span class="id">apply:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#iffP">iffP</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#idP">idP</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">H;</span> <span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">eq_bigr</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big1">big1</a></span> <span class="id">//</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#div0R">div0R</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_eq0'">mulR_eq0'</a></span> <span class="id">=&gt;</span> <span class="id">/orP</span> <span class="id">[];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move/invR_eq0';</span> <span class="id">have:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar.PC_neq0">PC_neq0;</a></span> <span class="id">rewrite</span> <span class="id">/Weighted</span>.<span class="id">total</span> <span class="id">=&gt;</span> <span class="id">/negPf</span> <span class="id">-&gt;</span>.<br/>
<span class="id">move/[swap]</span> <span class="id">=&gt;</span> <span class="id">i</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.psumr_eq0">psumr_eq0</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move/allP/</span>(<span class="id">_</span> <span class="id">i</span>)<span class="id">/[!mem_index_enum]/</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span>)<span class="id">/implyP/[!inE]/</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span>)<span class="id">/eqP-&gt;</span>.<br/>
<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">apply/RleP/mulR_ge0;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_ge0">sq_dev_ge0</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/mulR_ge0=&gt;</span> <span class="id">//;</span> <span class="id">exact/RleP/nneg_finfun_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="evar_ge0" class="id">
  <a name="evar_ge0" class="">evar_ge0</a>
</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#evarE">evarE</a></span> <span class="id"><a href="robustmean.weightedmean.html#emeanE">emeanE;</a></span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/invR_ge0/RltP/Weighted</span>.<span class="id">total_gt0</span>.<br/>
<span class="id">have-&gt;:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:110" class="id"><span id="i:109" class="id"><span id="i:108" class="id"><span id="i:107" class="id"><span id="i:106" class="id">
  <a name="i:110" class="">i</a>
</span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#evar.U">U</a></span>) <span class="id">0</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big1">big1</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_sumR">leR_sumR=&gt;</a></span> <span class="id">i</span> <span class="id">iU</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_ge0">sq_dev_ge0</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact/RleP/nneg_finfun_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="pos_evar" class="id">
  <a name="pos_evar" class="">pos_evar</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="pos_evar.U" class="id">
  <a name="pos_evar.U" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="pos_evar.P" class="id">
  <a name="pos_evar.P" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:111">U}</a></span>) (<span id="pos_evar.X" class="id">
  <a name="pos_evar.X" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:112">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;(<span id="pos_evar.C" class="id">
  <a name="pos_evar.C" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:111">U</a></span>) (<span id="pos_evar.PC_neq0" class="id">
  <a name="pos_evar.PC_neq0" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:112">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:114">C</a></span> <span class="id">!=</span> <span class="id">0</span>)<br/>
&nbsp;&nbsp;(<span id="pos_evar.evar_gt0" class="id">
  <a name="pos_evar.evar_gt0" class="">evar_gt0</a>
</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#X:113">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#PC_neq0:115">PC_neq0</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="pos_evar_index" class="id">
  <a name="pos_evar_index" class="">pos_evar_index</a>
</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="i:117" class="id">
  <a name="i:117" class="">i,</a>
</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.C">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:117">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:117">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.PC_neq0">PC_neq0</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:117">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
<span class="id">move:</span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar.evar_gt0">evar_gt0;</a></span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_neqAle">ltR_neqAle</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span> <span class="id">/nesym</span> <span class="id">/eqP</span> <span class="id">/[swap]</span> <span class="id">_</span>.<br/>
<span class="id">case/evar0P/boolp</span>.<span class="id">existsNP=&gt;</span> <span class="id">x</span> <span class="id">/eqP</span> <span class="id">?;</span> <span class="gallina-kwd">exists</span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_neqAle">ltR_neqAle;</a></span> <span class="id">split;</span> <span class="id">first</span> <span class="id">exact/nesym/eqP</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0;</a></span> <span class="id">last</span> <span class="id">exact/sq_dev_ge0</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">mulR_ge0=&gt;</a></span> <span class="id">//;</span> <span class="id">exact/RleP/nneg_finfun_ge0</span>.<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id"><a href="robustmean.weightedmean.html#pos_evar">pos_evar</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="emean_cond" class="id">
  <a name="emean_cond" class="">emean_cond</a>
</span> (<span id="U:118" class="id">
  <a name="U:118" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:119" class="id">
  <a name="P:119" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:118">U}</a></span>) (<span id="X:120" class="id">
  <a name="X:120" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:119">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="C:121" class="id">
  <a name="C:121" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:118">U</a></span>) (<span id="A:122" class="id">
  <a name="A:122" class="">A</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:118">U}</a></span>) (<span id="PC_neq0:123" class="id">
  <a name="PC_neq0:123" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:119">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:121">C</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WP:124" class="id">
  <a name="WP:124" class="">WP</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#PC_neq0:123">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WX:125" class="id">
  <a name="WX:125" class="">WX</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#WP:124">WP</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#X:120">X</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[WX</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:122">A]</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="evar_cond" class="id">
  <a name="evar_cond" class="">evar_cond</a>
</span> (<span id="U:126" class="id">
  <a name="U:126" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:127" class="id">
  <a name="P:127" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:126">U}</a></span>) (<span id="X:128" class="id">
  <a name="X:128" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:127">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="C:129" class="id">
  <a name="C:129" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:126">U</a></span>) (<span id="A:130" class="id">
  <a name="A:130" class="">A</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:126">U}</a></span>) (<span id="PC_neq0:131" class="id">
  <a name="PC_neq0:131" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:127">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:129">C</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WP:132" class="id">
  <a name="WP:132" class="">WP</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#PC_neq0:131">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WX:133" class="id">
  <a name="WX:133" class="">WX</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#WP:132">WP</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#X:128">X</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`V_[WX</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id"><a href="robustmean.weightedmean.html#A:130">A]</a></span>.<br/>
<br/>
<div class="doc md"> ## eqn I, page 5 </div>
<span class="vernacular">Definition</span> <span id="filter1D_inv" class="id">
  <a name="filter1D_inv" class="">filter1D_inv</a>
</span> (<span id="U:134" class="id">
  <a name="U:134" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:135" class="id">
  <a name="P:135" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:134">U}</a></span>) (<span id="C:136" class="id">
  <a name="C:136" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:134">U</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="good:137" class="id">
  <a name="good:137" class="">good</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:134">U}</a></span>) (<span id="eps:138" class="id">
  <a name="eps:138" class="">eps</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:143" class="id"><span id="i:142" class="id"><span id="i:141" class="id"><span id="i:140" class="id"><span id="i:139" class="id">
  <a name="i:143" class="">i</a>
</span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#good:137">good</a></span>) (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:136">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:139">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#P:135">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:139">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span><br/>
&nbsp;&nbsp;(<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:138">eps</a></span>) <span class="id">/</span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">\sum_</a></span>(<span id="i:148" class="id"><span id="i:147" class="id"><span id="i:146" class="id"><span id="i:145" class="id"><span id="i:144" class="id">
  <a name="i:148" class="">i</a>
</span></span></span></span></span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:137">good</a></span>) (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:136">C</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:144">i</a></span>) <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#P:135">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:144">i</a></span>.<br/>
<br/>
<div class="doc md"> ## page 62, line -1 </div>
<span class="vernacular">Definition</span> <span id="filter1D_invW" class="id">
  <a name="filter1D_invW" class="">filter1D_invW</a>
</span> (<span id="U:149" class="id">
  <a name="U:149" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="P:150" class="id">
  <a name="P:150" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:149">U}</a></span>) (<span id="C:151" class="id">
  <a name="C:151" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:149">U</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="good:152" class="id">
  <a name="good:152" class="">good</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:149">U}</a></span>) (<span id="eps:153" class="id">
  <a name="eps:153" class="">eps</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>) (<span id="PC_neq0:154" class="id">
  <a name="PC_neq0:154" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:150">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C:151">C</a></span> <span class="id">!=</span> <span class="id">0</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="WP:155" class="id">
  <a name="WP:155" class="">WP</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#PC_neq0:154">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#eps:153">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#WP:155">WP</a></span> <span class="id"><a href="robustmean.weightedmean.html#good:152">good</a></span>.<br/>
<br/>
<br/>
<span class="vernacular">Section</span> <span id="bounding_empirical_mean" class="id">
  <a name="bounding_empirical_mean" class="">bounding_empirical_mean</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="bounding_empirical_mean.U" class="id">
  <a name="bounding_empirical_mean.U" class="">U</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#Finite.Exports.finType">finType</a></span>) (<span id="bounding_empirical_mean.P" class="id">
  <a name="bounding_empirical_mean.P" class="">P</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:156">U}</a></span>) (<span id="bounding_empirical_mean.X" class="id">
  <a name="bounding_empirical_mean.X" class="">X</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#P:157">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span>) (<span id="bounding_empirical_mean.C" class="id">
  <a name="bounding_empirical_mean.C" class="">C</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">nneg_finfun</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:156">U</a></span>)<br/>
&nbsp;&nbsp;(<span id="bounding_empirical_mean.good" class="id">
  <a name="bounding_empirical_mean.good" class="">good</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">{set</a></span> <span class="id"><a href="robustmean.weightedmean.html#U:156">U}</a></span>) (<span id="bounding_empirical_mean.eps" class="id">
  <a name="bounding_empirical_mean.eps" class="">eps</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">R</a></span>).<br/>
<span class="vernacular">Hypotheses</span> (<span id="bounding_empirical_mean.C01" class="id">
  <a name="bounding_empirical_mean.C01" class="">C01</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">is_01</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span>) (<span id="bounding_empirical_mean.PC_neq0" class="id">
  <a name="bounding_empirical_mean.PC_neq0" class="">PC_neq0</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span> <span class="id">!=</span> <span class="id">0</span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.WP" class="id">
  <a name="bounding_empirical_mean.WP" class="">WP</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Weighted.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.SP" class="id">
  <a name="bounding_empirical_mean.SP" class="">SP</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#d">Split.d</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">C01</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.bad" class="id">
  <a name="bounding_empirical_mean.bad" class="">bad</a>
</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">~:</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.eps_max" class="id">
  <a name="bounding_empirical_mean.eps_max" class="">eps_max</a>
</span> <span class="id">:=</span> <span class="id">1/16</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="bounding_empirical_mean.pr_bad" class="id">
  <a name="bounding_empirical_mean.pr_bad" class="">pr_bad</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.bad">bad</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="pr_good" class="id">
  <a name="pr_good" class="">pr_good</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_to_cplt">Pr_to_cplt</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.pr_bad">pr_bad</a></span>. Qed.</div>
<br/>
<span class="vernacular">Hypothesis</span> <span id="bounding_empirical_mean.low_eps" class="id">
  <a name="bounding_empirical_mean.low_eps" class="">low_eps</a>
</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps_max">eps_max</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.eps0" class="id">
  <a name="bounding_empirical_mean.eps0" class="">eps0</a>
</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">eps</a></span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
 <span class="id">rewrite</span> <span class="id">-pr_bad</span>. <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_ge0">Pr_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.WX" class="id">
  <a name="bounding_empirical_mean.WX" class="">WX</a>
</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.WP">WP</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span> <span class="id"><a href="robustmean.util.html#R">R}</a></span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.SX" class="id">
  <a name="bounding_empirical_mean.SX" class="">SX</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#fst_RV">Split.fst_RV</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">C01</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.mu" class="id">
  <a name="bounding_empirical_mean.mu" class="">mu</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#mean">mean</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.var" class="id">
  <a name="bounding_empirical_mean.var" class="">var</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#var">var</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.mu_hat" class="id">
  <a name="bounding_empirical_mean.mu_hat" class="">mu_hat</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean">emean</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.var_hat" class="id">
  <a name="bounding_empirical_mean.var_hat" class="">var_hat</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar">evar</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.mu_wave" class="id">
  <a name="bounding_empirical_mean.mu_wave" class="">mu_wave</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#emean_cond">emean_cond</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.evar_wave" class="id">
  <a name="bounding_empirical_mean.evar_wave" class="">evar_wave</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#evar_cond">evar_cond</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.tau" class="id">
  <a name="bounding_empirical_mean.tau" class="">tau</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">sq_dev</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">PC_neq0</a></span>.<br/>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.tau_max" class="id">
  <a name="bounding_empirical_mean.tau_max" class="">tau_max</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max">sq_dev_max</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">X</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">PC_neq0</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="pr_good_gt0" class="id">
  <a name="pr_good_gt0" class="">pr_good_gt0</a>
</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">unfold</span> <span class="id"><a href="robustmean.weightedmean.html#eps_max">eps_max</a></span> <span class="gallina-kwd">in</span> <span class="id">low_eps</span>.<br/>
<span class="id">have</span> <span class="id">:</span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Pr</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">good</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id">1;</span> <span class="id">last</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id">-Pr_of_cplt</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.pr_bad">pr_bad;</a></span> <span class="id">lra</span>.<br/>
Qed.</div>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.hprgoodgt0" class="id">
  <a name="bounding_empirical_mean.hprgoodgt0" class="">hprgoodgt0</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good_gt0">pr_good_gt0</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="weighted_total_gt0" class="id">
  <a name="weighted_total_gt0" class="">weighted_total_gt0</a>
</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#total">Weighted.total</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">C</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
 <span class="gallina-kwd">by</span> <span class="id">apply/RltP;</span> <span class="id">apply</span> <span class="id"><a href="robustmean.weightedmean.html#total_gt0">Weighted.total_gt0</a></span>. Qed.</div>
<span class="vernacular">Let</span> <span id="bounding_empirical_mean.hweightedtotalgt0" class="id">
  <a name="bounding_empirical_mean.hweightedtotalgt0" class="">hweightedtotalgt0</a>
</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#weighted_total_gt0">weighted_total_gt0</a></span>.<br/>
<br/>
<div class="doc md"> ## eqn 1.1, page 5 </div>
<span class="vernacular">Lemma</span> <span id="eqn1_1" class="id">
  <a name="eqn1_1" class="">weight_contrib</a>
</span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">i</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">good</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">C</a></span> <span class="id">i</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.tau">*</a></span> <span class="id">P</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">i</a></span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">tau</a></span> <span class="id">i</span>) <span class="id">/</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">Pr</a></span> <span class="id">P</span> <span class="id">good</span> <span class="id">&lt;=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">var</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">+</a></span> (<span class="id">mu</span> <span class="id">-</span> <span class="id">mu_hat</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">apply</span> (<span class="id">@leR_trans</span> (<span class="id">`E_[tau</span> <span class="id">|</span> <span class="id">good]</span>))<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/leR_eqVlt;left;apply/cVarDist</span>.<br/>
<span class="id">rewrite</span> <span class="id">cExE</span>.<br/>
<span class="id">apply</span> <span class="id">leR_pmul2r;</span> <span class="id">[by</span> <span class="id">apply</span> <span class="id">invR_gt0|]</span>.<br/>
<span class="id">apply</span> <span class="id">leR_sumRl</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">Higood;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">rewrite</a></span> (<span class="id">mulRC</span> (<span class="id">tau</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_wpmul2r;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">sq_dev_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[_</span> <span class="id">c1]</span> <span class="id">:=</span> <span class="id">C01</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">/RleP</span> <span class="id">hp</span> <span class="id">:=</span> <span class="id">FDist.ge0</span> <span class="id">P</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-{2}</span>(<span class="id">mul1R</span> (<span class="id">P</span> <span class="id">i</span>))<span class="id">;</span> <span class="id">apply</span> <span class="id">leR_wpmul2r</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">mulR_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply</span> <span class="id">sq_dev_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span class="id">invariant</span> <span class="id">:=</span> <span class="id">filter1D_inv</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">P</a></span> <span class="id">C</span> <span class="id">good</span> <span id="bounding_empirical_mean.invariantW" class="id">
  <a name="bounding_empirical_mean.invariantW" class="">eps</a>
</span>.<br/>
<span class="vernacular">Let</span> <span class="id">invariantW</span> <span class="id">:=</span> <span class="id">filter1D_invW</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.PC_neq0">good</a></span> <span class="id">eps</span> <span class="id">PC_neq0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">invariant_impl</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">invariant</a></span> <span class="id">-&gt;</span> <span class="id">invariantW</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariant">rewrite</a></span> <span class="id">/invariant</span> <span class="id">/invariantW</span> <span class="id">/filter1D_invW</span> <span class="id">=&gt;</span> <span class="id">hinv</span>.<br/>
<span class="id">rewrite</span> <span class="id">-!pr_good</span>.<br/>
<span class="id">apply</span> (<span class="id">@leR_trans</span> ((<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">Pr</a></span> <span class="id">P</span> <span class="id">good</span> <span class="id">/</span> <span class="id">2</span> <span class="id">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">1</a></span> <span class="id">+</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">Pr</a></span> <span class="id">P</span> <span class="id">good</span> <span id="i:185" class="id"><span id="i:184" class="id"><span id="i:183" class="id"><span id="i:182" class="id"><span id="i:181" class="id"><span id="i:175" class="id"><span id="i:174" class="id"><span id="i:173" class="id"><span id="i:172" class="id"><span id="i:171" class="id">
  <a name="i:185" class="">+</a>
</span></span></span></span></span></span></span></span></span></span> (<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">bad</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">C</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">i</a></span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>))) <span class="id">/</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">U</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">C</a></span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">@leR_pmul2r</span> ((<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">U</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">C</a></span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>) <span class="id">*</span> <span class="id">2</span>))<span class="id">;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">mulR_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">rewrite</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">!mulRA</a></span> <span class="id">!</span>(<span class="id">mulRC</span> <span class="id">_</span> <span class="id">2</span>) <span class="id">-</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">mulRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">_</a></span> (<span class="id">/</span> <span class="id">_</span>)) <span class="id">mulVR;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">gtR_eqF</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulR1</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">!mulRA</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">mulRC</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">_</a></span> (<span class="id">/2</span>)) <span class="id">mulRA</span> <span class="id">mulVR;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">gtR_eqF</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mul1R</span> <span class="id">-addRR</span> <span class="id">mulRDl</span> <span class="id">-addRA</span> <span class="id">mulRDr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">leR_add</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_pmul2l;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">low_eps;</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps_max">pr_good</a></span> <span class="id">/eps_max;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">Pr_setT</span> <span class="id">P</span>) <span class="id">/Pr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_sumRl</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">//-{2}</span>(<span class="id">mul1R</span> (<span class="id">P</span> <span class="id">i</span>))<span class="id">;</span> <span class="id">apply</span> <span class="id">leR_wpmul2r;</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C01">[|apply</a></span> <span class="id">C01]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_pmul2l;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">low_eps;</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps_max">rewrite</a></span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">/eps_max</a></span> <span class="id">pr_good;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">rewrite</a></span> <span class="id">/Pr</span> <span class="id">addRC</span> <span class="id">-bigID2</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_sumR</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">HiU</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id">igood;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">Rle_refl</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-{2}</span>(<span class="id">mul1R</span> (<span class="id">P</span> <span class="id">i</span>))<span class="id">;</span> <span class="id">apply</span> <span class="id">leR_pmul</span> <span class="id">=&gt;</span> <span class="id">//;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[apply</span> <span class="id">C01|apply</span> <span class="id">C01|exact:</span> <span class="id">Rle_refl]</span>.<br/>
<span class="id">under</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id">&lt;=</span> <span class="id">X]eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">Weighted.dE</span> <span class="id">/Weighted</span>.<span class="id">total</span>.<br/>
<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrl">rewrite</a></span> <span class="id">-big_distrl/=</span> <span class="id">divRE</span>.<br/>
<span class="id">apply</span> <span class="id">leR_pmul2r;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">invR_gt0</span>.<br/>
<span class="id">apply</span> <span class="id">Ropp_le_cancel</span>.<br/>
<span class="id">rewrite</span> <span class="id">{2}pr_good</span> <span class="id">addRA</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.pr_bad">-addRA</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDr">-pr_bad</a></span> <span class="id">mulRDr</span> <span class="id">oppRD</span> <span class="id">addRC</span>.<br/>
<span class="id">apply</span> <span class="id">leR_subl_addr</span>.<br/>
<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#Rminus">rewrite</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRK">/Rminus</a></span> <span class="id">oppRK</span> <span class="id">-mulRN</span> <span class="id">addRC</span> <span class="id">{1}/Rdiv</span> <span class="id">-mulRA</span> <span class="id">mulVR;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">gtR_eqF</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulR1</span> <span class="id">oppRD</span> <span class="id">oppRK</span> <span class="id">!big_morph_oppR-!big_split/=</span>.<br/>
<span class="id">have</span> <span class="id">H</span> <span id="S:202" class="id">
  <a name="S:202" class="">:</a>
</span> <span class="gallina-kwd">forall</span> <span id="i:207" class="id"><span id="i:206" class="id"><span id="i:205" class="id"><span id="i:204" class="id"><span id="i:203" class="id">
  <a name="i:207" class="">S,</a>
</span></span></span></span></span> <span class="id">\sum_</span>(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">i</a></span> <span class="gallina-kwd">in</span> <span class="id">S</span>) (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:203">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">+</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">-</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">C</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">i</a></span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>)) <span id="i:212" class="id"><span id="i:211" class="id"><span id="i:210" class="id"><span id="i:209" class="id"><span id="i:208" class="id">
  <a name="i:212" class="">=</a>
</span></span></span></span></span> <span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">S</span>) (<span class="id">1</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">-</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:208">C</a></span> <span class="id">i</span>) <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">S;</a></span> <span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">mulRBl</span> <span class="id">mul1R</span> <span class="id">addR_opp</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!H</span> <span class="id">pr_good</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn page 63, line 3 </div>
<span class="vernacular">Lemma</span> <span class="id">bound_emean</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">:</a></span> <span class="id">Pr</span> <span class="id">WP</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">good</a></span> <span class="id">!=</span> <span class="id">0</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">invariantW</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_hat</a></span> <span class="id">-</span> <span class="id">mu_wave</span>) <span class="id">&lt;=</span> <span class="id">var_hat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">*</a></span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span> <span class="id">/</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">move=&gt;</span> <span class="id">pgoodC</span> <span class="id">invC</span>.<br/>
<span class="id">unfold</span> <span class="id">eps_max</span> <span class="gallina-kwd">in</span> <span class="id">low_eps</span>.<br/>
<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">suff</a></span> <span class="id">h</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">`|</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">mu_hat</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">-</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">mu_wave</a></span> <span class="id">|</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var_hat">&lt;=</a></span> <span class="id">sqrt</span> (<span class="id">var_hat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">*</a></span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span> <span class="id">/</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Rsqr_abs</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">-[X</a></span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id">&lt;=</span> <span class="id">X]Rsqr_sqrt;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/invR_ge0/subR_gt0;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">rewrite</a></span> <span class="id">-mulRA;</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id"><a href="robustmean.robustmean.html#variance_ge0">[exact:</a></span> <span class="id">variance_ge0|lra]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/Rsqr_incr_1</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">[exact/normR_ge0|exact:</span> <span class="id">sqrt_pos]</span>.<br/>
<span class="id">pose</span> <span class="id">delta</span> <span class="id">:=</span> <span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>.<br/>
<span class="id">have</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">{1}-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">:</a></span> <span class="id">eps</span> <span class="id">=</span> <span class="id">1</span> <span class="id">-</span> <span class="id">delta</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">subRB</span> <span class="id">subRR</span> <span class="id">add0R</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#distRC">-/delta</a></span> <span class="id">distRC</span>.<br/>
<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_hat">rewrite</a></span> <span class="id">/mu_hat</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">resilience</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id">/delta;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn page 63, line 5 </div>
<span class="vernacular">Lemma</span> <span class="id">good_mass</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">invariant</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">1</a></span> <span class="id">-</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">eps/2</a></span> <span class="id">&lt;=</span> (<span class="id">\sum_</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">i</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">good</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">C</a></span> <span class="id">i</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">*</a></span> <span class="id">P</span> <span class="id">i</span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps_max">rewrite</a></span> <span class="id"><a href="robustmean.weightedmean.html#is_01">/eps_max/is_01</a></span> <span class="id">=&gt;</span> <span class="id">Hinv</span>.<br/>
<span class="id">unfold</span> <span class="id">eps_max</span> <span class="gallina-kwd">in</span> <span class="id">low_eps</span>.<br/>
<span class="id">apply</span> (<span class="id">@leR_trans</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">1</a></span> <span class="id">-</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">2</a></span> <span class="id">/</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">Pr</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">P</a></span> <span class="id">good</span> <span class="id">*</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">bad</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">pr_bad</span> <span class="id">pr_good</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">-!mulRA</a></span> <span class="id">mulRC</span> (<span class="id">mulRC</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">/</a></span>(<span class="id">_-_</span>))) <span class="id">mulRA</span> <span class="id">-mulRA</span> <span class="id">mulVR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulR1</span> <span class="id">mulRC;</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">/gtR_eqF;</span> <span class="id">lra</span>.<br/>
<span class="id">apply</span> (<span class="id">@leR_trans</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">1</a></span> <span class="id">-</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">/</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">2</a></span> <span class="id">/</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">Pr</a></span> <span class="id">P</span> <span class="id">good</span> <span class="id">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">bad</span>) <span class="id">P</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.C">i</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:219">*</a></span> (<span class="id">1</span> <span class="id">-</span> <span class="id">C</span> <span class="id">i</span>))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">leR_add2l</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#oppRK">leR_oppl</a></span> <span class="id">oppRK</span> <span class="id">leR_pmul2l;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#Rdiv">pr_good</a></span> <span class="id">/Rdiv</span> <span class="id">mulRC</span> <span class="id">mulRA</span> <span class="id">mulVR;</span> <span class="id">[lra|rewrite</span> <span class="id">gt_eqF//;</span> <span class="id">apply/RltP;</span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_sumR</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">Hi_bad</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-{2}</span>(<span class="id">mulR1</span> (<span class="id">P</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">FDist.ge0</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RleP">i</a></span>)<span class="id">;</span> <span class="id">move/RleP</span> <span class="id">=&gt;</span> <span class="id">[HPi_gt0|HPi_eq0]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/RleP;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">rewrite</a></span> <span class="id">!coqRE</span> <span class="id">ler_wpM2l//</span> <span class="id">gerBl//;</span> <span class="id">move:</span> (<span class="id">C01</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RleP">i</a></span>).<span class="id">1</span> <span class="id">=&gt;</span> <span class="id">/RleP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-HPi_eq0</span> <span class="id">!mul0R</span>.<br/>
<span class="id"><a href="robustmean.weightedmean.html#pr_good">rewrite</a></span> <span class="id">-pr_good</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">/Rdiv</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">-</a></span>(<span class="id">mulRA</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>)) (<span class="id">mulRC</span> (<span class="id">/2</span>)) <span class="id">mulRA</span> <span class="id">mulRV;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">gtR_eqF;</span> <span class="id">rewrite</span> <span class="id">pr_good;</span> <span class="id">lra</span>.<br/>
<span class="id">apply</span> (<span class="id">@leR_pmul2r</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>))<span class="id">;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">pr_good;</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">mulRA</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.P">_</a></span> (<span class="id">/</span> <span class="id">Pr</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">P</a></span> <span class="id">good</span>)) <span class="id">mulVR;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">gtR_eqF//</span> <span class="id">pr_good;</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id">mul1R</span> <span class="id">mulR1</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRDl</span> <span class="id"><a href="robustmean.weightedmean.html#pr_good">mul1R</a></span> <span class="id">{2}pr_good</span> <span class="id">mulRC</span> <span class="id">mulRN</span>.<br/>
<span class="id">apply</span> (<span class="id">@Rplus_le_reg_l</span> (<span class="id">-</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>)).<br/>
<span class="id">rewrite</span> <span class="id">addRA</span> (<span class="id">addRC</span> (<span class="id">-</span> <span class="id">_</span>)) <span class="id">addRN</span> <span class="id">add0R</span> <span class="id">mulRA</span>.<br/>
<span class="id">apply</span> <span class="id">leR_oppl</span>.<br/>
<span class="id">rewrite</span> <span class="id">oppRD</span> <span class="id">oppRK</span> <span class="id">/Pr</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-</a></span>(<span class="id">mul1R</span> (<span class="id">-</span> <span class="id">_</span>)) <span class="id">mulRN</span> <span class="id">-mulNR</span> <span class="id">big_distrr</span> <span class="id">-big_split</span> <span class="id">-divRE/=</span>.<br/>
<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulNR</span> <span class="id">mul1R</span> <span class="id">-{1}</span>(<span class="id">mul1R</span> (<span class="id">P</span> <span class="id">i</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_plus_distr_r">-mulNR</a></span> <span class="id">-Rmult_plus_distr_r</span> <span class="id">addR_opp</span>.<br/>
<span class="id">under</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.X">_</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">/</a></span> <span class="id">_</span> <span class="id">*</span> <span class="id">X]eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">mulRC</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn page 63, line 4 </div>
<span class="vernacular">Lemma</span> <span class="id">bound_mean</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">invariant</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">-&gt;</a></span> (<span class="id">mu</span> <span class="id">-</span> <span class="id">mu_wave</span>) <span class="id">&lt;=</span> <span class="id">var</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">*</a></span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span> <span class="id">/</span> (<span class="id">2</span> <span class="id">-</span> <span class="id">eps</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">move=&gt;</span> <span class="id">Hinv</span>.<br/>
<span class="id">unfold</span> <span class="id">eps_max</span> <span class="gallina-kwd">in</span> <span class="id">low_eps</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.SX">mu</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">`E_[SX</a></span> <span class="id">|</span> <span class="id">good</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">`*</a></span> <span class="id">[set:</span> <span class="id">bool]]</span> <span class="gallina-kwd">by</span> <span class="id">exact:</span> <span class="id">Split.cEx</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">:</a></span> <span class="id">mu_wave</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">`E_[SX</a></span> <span class="id">|</span> <span class="id">good</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">`*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#f5e197738ea7c8e266850f6045418c3f">[set</a></span> <span class="id">true]]</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">rewrite</a></span> <span class="id">/mu_wave</span> <span class="id">/emean_cond</span> <span class="id">!cExE</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrl">!divRE</a></span> <span class="id">!big_distrl/=</span> <span class="id">big_setX//=</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">rewrite</a></span> <span class="id">/Pr</span> <span class="id">big_setX//=;</span> <span class="id">apply:</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big_set1</span> <span class="id">/WP</span> <span class="id">/SP</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.WX">rewrite</a></span> <span class="id"><a href="robustmean.weightedmean.html#fst_RV">/WX</a></span> <span class="id">/SX</span> <span class="id">/Split</span>.<span class="id">fst_RV</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-!mulRA</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">X</span> <span class="id">u</span> <span class="id">*</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">[in</a></span> <span class="id">RHS]eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">big_set1</a></span> <span class="id">Split.dE</span><span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Split.dE</span><span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">[in</a></span> <span class="id">LHS]eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">Weighted.dE</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrl">rewrite</a></span> <span class="id">-big_distrl/=</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">rewrite</a></span> <span class="id">-divRE</span> <span class="id">Rdiv_mult_distr</span> <span class="id">divRE</span> <span class="id">invRK</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRC</span> <span class="id">!mulRA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id">/</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Weighted.dE</span> <span class="id">mulRA</span> <span class="id">mulRAC</span> <span class="id">-divRE</span> <span class="id">divRR</span> <span class="id">?mul1R</span>.<br/>
<span class="id">rewrite</span> <span class="id">Rsqr_neg_minus</span>.<br/>
<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_trans">apply:</a></span> (<span class="id">@leR_trans</span> (<span class="id">`V_[</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">SX</a></span> <span class="id">|</span> <span class="id">good</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">`*</a></span> <span class="id">[set:</span> <span class="id">bool]]</span> <span class="id">*</span> <span class="id">2</span> <span class="id">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">1</a></span> <span class="id">-</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">/</a></span> <span class="id">2</span>)<span class="id">%mcR</span>) <span class="id">/</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span> <span class="id">/</span> <span class="id">2</span>)<span class="id">%mcR</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">sqrt_le_0</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_0_sqr">-</a></span> <span class="id">exact:</span> <span class="id">Rle_0_sqr</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">-</a></span> <span class="id">apply:</span> <span class="id">mulR_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">+</a></span> <span class="id">apply:</span> <span class="id">mulR_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">[exact:</a></span> <span class="id">cvariance_ge0|lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRB">-!coqRE</a></span> <span class="id">subRB</span> <span class="id">subRR</span> <span class="id">add0R;</span> <span class="id">exact:</span> <span class="id">divR_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">invR_ge0;</span> <span class="id">rewrite</span> <span class="id">-!coqRE</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">2%:R</span> <span class="id">=</span> <span class="id">2</span>)<span class="id">//;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">sqrt_Rsqr_abs;</span> <span class="id">apply:</span> (<span class="id">cresilience</span> (<span class="id">delta</span> <span class="id">:=</span> <span class="id">1</span> <span class="id">-</span> <span class="id">eps</span> <span class="id">/</span> <span class="id">2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!coqRE</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">2%:R</span> <span class="id">=</span> <span class="id">2</span>)<span class="id">//;</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">have</span> <span class="id">:=</span> <span class="id">good_mass</span> <span class="id">Hinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-!coqRE</span> <span class="id">=&gt;</span> <span class="id">/leR_trans;</span> <span class="id">apply</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/leR_eqVlt;</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">rewrite</a></span> <span class="id">/Pr</span> <span class="id">!big_setX/=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">under</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">=</a></span> <span class="id">X</span> <span class="id">*</span> <span class="id">_]eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">big_set1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span class="id">/</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.SP">rewrite</a></span> <span class="id">/SP</span> <span class="id">Split.dE</span><span class="id">/=</span> <span class="id">mulRC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">ugood</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">setT_bool</span> <span class="id">big_setU1//=</span> <span class="id">?inE//</span> <span class="id">big_set1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.SP">rewrite</a></span> <span class="id">/SP</span> <span class="id">!Split</span>.<span class="id">dE/=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRCA">-mulRDl</a></span> <span class="id">addRCA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">addR_opp</a></span> <span class="id">subRR</span> <span class="id">addR0</span> <span class="id">mul1R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id">leR_sumRl</span> <span class="id">=&gt;</span> <span class="id">i;</span> <span class="id">rewrite</span> <span class="id">inE</span> <span class="id">=&gt;</span> <span class="id">/andP[igood</span> <span class="id">_]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="gallina-kwd">by</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="id">rewrite</span> <span class="id">Split.dE</span><span class="id">;</span> <span class="id">apply</span> <span class="id">mulR_ge0</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id">_;</span> <span class="id">move:</span> (<span class="id">C01</span> <span class="id">i</span>.<span class="id">1</span>) <span class="id">=&gt;</span> <span class="id">[c0</span> <span class="id">c1]//;</span> <span class="id">apply</span> <span class="id">subR_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">inE</span> <span class="id">igood</span> <span class="id">in_setT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply/subsetP</span> <span class="id">=&gt;</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#inE">rewrite</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">!inE</a></span> <span class="id">=&gt;</span> <span class="id">/andP[-&gt;]</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">:</a></span> <span class="id">`V_[</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext#dc2312b445cefe5154d72c71c36b35ce">SX</a></span> <span class="id">|</span> <span class="id">good</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">`*</a></span> <span class="id">[set:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var">bool]]</a></span> <span class="id">=</span> <span class="id">var</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var">rewrite</a></span> <span class="id">/var</span> <span class="id">/cVar</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">:</a></span> <span class="id">`E_[</span> <span class="id">SX</span> <span class="id">|</span> (<span class="id">good</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">`*</a></span> <span class="id">[set:</span> <span class="id">bool]</span>)<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">]</a></span> <span class="id">=</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.good">`E_[X</a></span> <span class="id">|</span> <span class="id">good]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/esym;</span> <span class="id">exact:</span> <span class="id">Split.cEx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/esym;</span> <span class="id">exact:</span> <span class="id">Split.cEx</span>.<br/>
<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">rewrite</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">!divRE</a></span> <span class="id">-</span>(<span class="id">mulRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">_</a></span> <span class="id">eps</span>) <span class="id">-</span>(<span class="id">mulRA</span> <span class="id">_</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">_</span>)).<br/>
<span class="id">apply</span> <span class="id">leR_wpmul2l</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">[exact:</a></span> <span class="id">cvariance_ge0|lra]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRB">-!coqRE</a></span> <span class="id">subRB</span> <span class="id">subRR</span> <span class="id">add0R</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rdiv_mult_distr">-!divRE</a></span> <span class="id">-Rdiv_mult_distr</span> <span class="id">Rmult_minus_distr_l</span> <span class="id">mulR1</span>.<br/>
<span class="id">rewrite</span> <span class="id">Rmult_div_assoc</span> (<span class="id">mulRC</span> <span class="id">2</span>) <span class="id">-Rmult_div_assoc</span> <span class="id">divRR</span> <span class="id">?mulR1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">2%:R</span> <span class="id">=</span> <span class="id">2</span>)<span class="id">//;</span> <span class="id">exact:</span> <span class="id">Rle_refl</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/eqP;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## lemma 1.4, page 5 (part 1) </div>
<span class="vernacular">Lemma</span> <span class="id">bound_mean_emean</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">invariant</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">`|mu</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">-</a></span> <span class="id">mu_hat|</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.var">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">sqrt</a></span> (<span class="id">var</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">*</a></span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span> <span class="id">/</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">2</a></span> <span class="id">-</span> <span class="id">eps</span>)) <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sqrt</span> (<span class="id">var_hat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">*</a></span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span> <span class="id">/</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">move=&gt;</span> <span class="id">IC</span>.<br/>
<span class="id">unfold</span> <span class="id">eps_max</span> <span class="gallina-kwd">in</span> <span class="id">low_eps</span>.<br/>
<span class="id">have</span> <span class="id">I1C</span> <span class="id">:</span> <span class="id">invariantW</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">invariant_impl</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rle_trans">apply:</a></span> (<span class="id">@Rle_trans</span> <span class="id">_</span> (<span class="id">`|mu</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">-</a></span> <span class="id">mu_wave|</span> <span class="id">+</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">`|mu_hat</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">-</a></span> <span class="id">mu_wave|</span>)).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">mu</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">-</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">mu_hat</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.mu_wave">=</a></span> (<span class="id">mu</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">-</a></span> <span class="id">mu_wave</span>) <span class="id">+</span> (<span class="id">mu_wave</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">-</a></span> <span class="id">mu_hat</span>) <span class="gallina-kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">Rle_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">Rabs_triang</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rplus_le_compat_l</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Rabs_minus_sym;</span> <span class="id">exact:</span> <span class="id">Rle_refl</span>.<br/>
<span class="id">have</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.eps">?</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">eps</span> <span class="gallina-kwd">by</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.pr_bad">rewrite</a></span> <span class="id">-pr_bad;</span> <span class="id">apply</span> <span class="id">Pr_ge0</span>.<br/>
<span class="id">apply:</span> <span class="id">leR_add</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id">geR0_norm</span> <span class="id">_</span> (<span class="id">sqrt_pos</span> <span class="id">_</span>))<span class="id">;</span> <span class="id">apply</span> <span class="id">Rsqr_le_abs_0;</span> <span class="id">rewrite</span> <span class="id">Rsqr_sqrt</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bound_mean">+</a></span> <span class="id">exact:</span> <span class="id">bound_mean</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id">-!mulRA;</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">invR_ge0;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id"><a href="robustmean.robustmean.html#cvariance_ge0">[exact:</a></span> <span class="id">cvariance_ge0|lra]</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id">geR0_norm</span> <span class="id">_</span> (<span class="id">sqrt_pos</span> <span class="id">_</span>))<span class="id">;</span> <span class="id">apply</span> <span class="id">Rsqr_le_abs_0;</span> <span class="id">rewrite</span> <span class="id">Rsqr_sqrt</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id">bound_emean</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_mean.invariantW">rewrite</a></span> <span class="id">/invariantW</span> <span class="id">/filter1D_invW</span> <span class="id">-/WP</span> <span class="gallina-kwd">in</span> <span class="id">I1C;</span> <span class="id">apply/eqP;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">+</a></span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">invR_ge0;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">rewrite</a></span> <span class="id">-mulRA;</span> <span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id"><a href="robustmean.robustmean.html#variance_ge0">[exact:</a></span> <span class="id">variance_ge0|lra]</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">bounding_empirical_mean</span>.<br/>
<br/>
<div class="doc">WIP </div>
<span class="vernacular">Section</span> <span class="id">update</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id"><a href="robustmean.weightedmean.html#U:231">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">U}</a></span>) (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">X</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">{RV</a></span> <span class="id">P</span> <span id="update.C" class="id">
  <a name="update.C" class="">-&gt;</a>
</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">R}</a></span>) (<span class="id">C</span> <span class="id">:</span> <span class="id">nneg_finfun</span> <span class="id">U</span>).<br/>
<span class="vernacular">Hypotheses</span> (<span class="id">PC_neq0</span> <span class="id">:</span> <span class="id">Weighted.total</span> <span class="id">P</span> <span class="id">C</span> <span class="id">!=</span> <span id="update.tau" class="id">
  <a name="update.tau" class="">0</a>
</span>).<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">tau</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#update.PC_neq0">sq_dev</a></span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<span class="vernacular">Let</span> <span class="id">tau_max</span> <span class="id">:=</span> <span class="id">sq_dev_max</span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">arg_tau_max</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">[arg</span> <span class="id">max_</span>(<span class="id">i</span> <span class="id">&gt;</span> (<span class="id">fdist_supp_choice</span> <span class="id">P</span>) <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#66e270080ae504530c90e1f7e9fca5bd">[set:</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#66e270080ae504530c90e1f7e9fca5bd">U]</a></span>) <span class="id">tau</span> <span class="id">i]%O</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">update_ffun</span> <span class="id"><a href="robustmean.weightedmean.html#update.U">:</a></span> <span class="id">{ffun</span> <span class="id">U</span> <span class="id">-&gt;</span> <span class="id">R}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">[ffun</span> <span class="id"><a href="robustmean.weightedmean.html#update.tau_max">i</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> (<span class="id">tau_max</span> <span class="id">==</span> <span class="id"><a href="robustmean.weightedmean.html#i:240">0</a></span>) <span class="id">||</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x">C</a></span> <span class="id">i</span> <span class="id">==</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x">0</a></span>) <span class="gallina-kwd">then</span> <span class="id">0</span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">C</span> <span class="id"><a href="robustmean.weightedmean.html#update.tau">i</a></span> <span class="id">*</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">1</a></span> <span class="id">-</span> <span class="id">tau</span> <span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">/</a></span> <span class="id">tau_max</span>)<span class="id">]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">update_pos_ffun</span> <span class="id">:</span> <span id="a:243" class="id"><span id="a:242" class="id"><span id="a:241" class="id">
  <a name="a:243" class="">[forall</a>
</span></span></span> <span class="id">a,</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">update_ffun</span> <span class="id">a]%mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">apply/forallP=&gt;</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RleP">u;</a></span> <span class="id">apply/RleP</span>.<br/>
<span class="id"><a href="robustmean.weightedmean.html#update_ffun">rewrite</a></span> <span class="id">/update_ffun</span> <span class="id">ffunE</span>.<br/>
<span class="id">have</span> <span class="id">[_|/=]</span> <span class="id">:=</span> <span class="id">eqVneq</span> <span class="id">tau_max</span> <span class="id">0</span> <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">move/eqP;</span> <span class="id">rewrite</span> <span class="id">eqR_le</span> <span class="id">=&gt;</span> <span class="id">/boolp</span>.<span class="id">not_andP</span> <span class="id">[];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev_max_ge0">move/</a></span>(<span class="id">_</span> (<span class="id">sq_dev_max_ge0</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltRNge">rewrite</a></span> <span class="id">-ltRNge</span> <span class="id">=&gt;</span> <span class="id">tau_max_gt0</span>.<br/>
<span class="id">case:</span> <span class="id">ifPn=&gt;</span> <span class="id">[|Cu0];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">_</a></span>.<br/>
<span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id">first</span> <span class="id">exact/RleP/nneg_finfun_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pdivr_mulr">subR_ge0</a></span> <span class="id">leR_pdivr_mulr</span> <span class="id">//</span> <span class="id">mul1R</span>.<br/>
<span class="id">exact:</span> <span class="id">sq_dev_max_ge</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">update</a></span> <span class="id">:</span> <span class="id">nneg_finfun</span> <span class="id">U</span> <span class="id">:=</span> <span class="id">mkNNFinfun</span> <span class="id">update_pos_ffun</span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id">update</span>.<br/>
<br/>
<div class="doc">part 2 of lemma 1.4 </div>
<span class="vernacular">Section</span> <span class="id">bounding_empirical_variance</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id"><a href="robustmean.weightedmean.html#U:244">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">{fdist</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">U}</a></span>) (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">X</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">{RV</a></span> <span class="id">P</span> <span id="bounding_empirical_variance.C" class="id">
  <a name="bounding_empirical_variance.C" class="">-&gt;</a>
</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext#nneg_finfun">R}</a></span>) (<span class="id">C</span> <span class="id">:</span> <span class="id">nneg_finfun</span> <span class="id">U</span>)<br/>
&nbsp;&nbsp;(<span class="id">good</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">:</a></span> <span class="id">{set</span> <span class="id">U}</span>) (<span class="id">eps</span> <span class="id">:</span> <span class="id">R</span>).<br/>
<span class="vernacular">Hypotheses</span> (<span class="id">C01</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">:</a></span> <span class="id">is_01</span> <span class="id">C</span>) (<span class="id">PC_neq0</span> <span class="id">:</span> <span class="id">Weighted.total</span> <span class="id">P</span> <span class="id">C</span> <span class="id">!=</span> <span id="bounding_empirical_variance.WP" class="id">
  <a name="bounding_empirical_variance.WP" class="">0</a>
</span>).<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">WP</span> <span class="id">:=</span> <span class="id">Weighted.d</span> <span class="id">PC_neq0</span>.<br/>
<span class="vernacular">Let</span> <span class="id">SP</span> <span class="id">:=</span> <span class="id">Split.d</span> <span class="id">P</span> <span id="bounding_empirical_variance.bad" class="id">
  <a name="bounding_empirical_variance.bad" class="">C01</a>
</span>.<br/>
<span class="vernacular">Let</span> <span class="id">bad</span> <span class="id">:=</span> <span class="id">~:</span> <span class="id">good</span>.<br/>
<span class="vernacular">Let</span> <span class="id">eps_max</span> <span class="id">:=</span> <span class="id">1/16</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">pr_bad</a></span> <span class="id">:</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">bad</span> <span class="id">=</span> <span class="id">eps</span>.<br/>
<span class="vernacular">Hypothesis</span> <span class="id">low_eps</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps_max">:</a></span> <span class="id">eps</span> <span class="id">&lt;=</span> <span class="id">eps_max</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">eps0</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">eps</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
 <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.pr_bad">rewrite</a></span> <span class="id">-pr_bad</span>. <span class="id">exact:</span> <span class="id">Pr_ge0</span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.WP">WX</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">:</a></span> <span class="id">{RV</span> <span class="id">WP</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">-&gt;</a></span> <span class="id">R}</span> <span class="id">:=</span> <span class="id">X</span>.<br/>
<span class="vernacular">Let</span> <span class="id">SX</span> <span class="id">:=</span> <span class="id">Split.fst_RV</span> <span class="id">C01</span> <span class="id">X</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">mu</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">:=</a></span> <span class="id">mean</span> <span class="id">X</span> <span class="id">good</span>.<br/>
<span class="vernacular">Let</span> <span class="id">var</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">:=</a></span> <span class="id">var</span> <span class="id">X</span> <span class="id">good</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">mu_hat</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">:=</a></span> <span class="id">emean</span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<span class="vernacular">Let</span> <span class="id">var_hat</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">:=</a></span> <span class="id">evar</span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">tau</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">sq_dev</a></span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<span class="vernacular">Let</span> <span class="id">tau_max</span> <span class="id">:=</span> <span class="id">sq_dev_max</span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">invariant</span> <span class="id">:=</span> <span class="id">filter1D_inv</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">P</a></span> <span class="id">C</span> <span class="id">good</span> <span id="bounding_empirical_variance.invariantW" class="id">
  <a name="bounding_empirical_variance.invariantW" class="">eps</a>
</span>.<br/>
<span class="vernacular">Let</span> <span class="id">invariantW</span> <span class="id">:=</span> <span class="id">filter1D_invW</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.PC_neq0">good</a></span> <span class="id">eps</span> <span class="id">PC_neq0</span>.<br/>
<br/>
<div class="doc md"> ## lemma 1.4, page 5 (part 2) </div>
<div class="doc md"> ## eqn A.6--A.9, page 63 </div>
<span class="vernacular">Lemma</span> <span class="id">bound_empirical_variance_good</span> <span class="id">:</span> <span class="id">16</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">*</a></span> <span class="id">var</span> <span class="id">&lt;=</span> <span class="id">var_hat</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">invariant</a></span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">i</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">good</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">C</a></span> <span class="id">i</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">*</a></span> <span class="id">P</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">i</a></span> <span class="id">*</span> <span class="id">tau</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">i</a></span> <span class="id">&lt;=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">0</a></span>.<span class="id">25</span> <span class="id">*</span> (<span class="id">1</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">-</a></span> <span class="id">eps</span>) <span class="id">*</span> <span class="id">var_hat</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps_max">rewrite</a></span> <span class="id">/eps_max;</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">var16</span> <span class="id">IC</span>.<br/>
<span class="id">unfold</span> <span class="id">eps_max</span> <span class="gallina-kwd">in</span> <span class="id">low_eps</span>.<br/>
<span class="id">have</span> <span class="id">I1C</span> <span class="id">:</span> <span class="id">invariantW</span>. <span class="comment">(*&nbsp;todo:&nbsp;repeated,&nbsp;factor&nbsp;out&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">invariant_impl</span>.<br/>
<span class="id">have</span> <span class="id">Hvar_hat_2_eps:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">var_hat</span> <span class="id">*</span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">rewrite</a></span> <span class="id">-mulRA;</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id"><a href="robustmean.robustmean.html#variance_ge0">[exact:</a></span> <span class="id">variance_ge0|lra]</span>.<br/>
<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">rewrite</a></span> <span class="id">/var_hat</span>.<br/>
<span class="id">have</span> <span class="id">PrPgoodpos</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">:</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">0</a></span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">pr_bad;</span> <span class="id">rewrite</span> <span class="id">Pr_of_cplt;</span> <span class="id">lra</span>.<br/>
<span class="comment">(*a6*)</span><br/>
<span class="id">apply</span> (<span class="id">@leR_trans</span> ((<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>) <span class="id">*</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">var</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.mu_hat">+</a></span> (<span class="id">mu</span> <span class="id">-</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">mu_hat</a></span>)))).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!</span>(<span class="id">pr_good</span> <span class="id">pr_bad</span>) <span class="id">Rmult_comm</span> <span class="id">-leR_pdivr_mulr//;</span> <span class="id">apply:</span> <span class="id">weight_contrib</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id">pr_bad</span>.<br/>
<span class="comment">(*a6-a7*)</span><br/>
<span class="id">apply</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">@leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">-</a></span> <span class="id">eps</span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var">*</a></span> (<span class="id">var</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">+</a></span> (<span class="id">sqrt</span> (<span class="id">var</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">*</a></span> <span class="id">eps</span> <span class="id">/</span> (<span class="id">2</span> <span class="id">-</span> <span class="id">eps</span>)) <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">sqrt</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">var_hat</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">*</a></span> <span class="id">eps</span> <span class="id">/</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>)))))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_wpmul2l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-pr_bad</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_1">subR_ge0;</a></span> <span class="id">exact:</span> <span class="id">Pr_1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/leR_add2l/Rsqr_le_abs_1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[x</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id">&lt;=</span> <span class="id">x]geR0_norm;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">bound_mean_emean</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/addR_ge0/sqrt_pos/sqrt_pos</span>.<br/>
<span class="comment">(*a7-a8*)</span><br/>
<span class="id">apply</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">@leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">-</a></span> <span class="id">eps</span>) <span class="id">*</span> <span class="id">var_hat</span> <span class="id">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">/16</span> <span class="id">+</span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span> <span class="id">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">/</a></span> (<span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">*</a></span> <span class="id">sqrt</span> (<span class="id">2</span> <span class="id">-</span> <span class="id">eps</span>)) <span class="id">+</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/</a></span> (<span class="id">sqrt</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>)))))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">mulRA</span> (<span class="id">1</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul2l">-</a></span> <span class="id">eps</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_pmul2l;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRDr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_add;</span> <span class="id">first</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">lra</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">2!mulRA</span> <span class="id">-</span>(<span class="id">Rsqr_sqrt</span> (<span class="id">var_hat</span> <span class="id">*</span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">Hvar_hat_2_eps</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-Rsqr_mult</span> <span class="id">mulRDr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rsqr_incr_1;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">addR_ge0;</span> <span class="id">apply</span> <span class="id">sqrt_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">addR_ge0;</a></span> <span class="id">apply:</span> <span class="id">mulR_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id">sqrt_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">invR_ge0;</span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id">sqrt_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">invR_ge0;</span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">leR_add</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@leR_trans</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">sqrt</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">var_hat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">eps</span> <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">/</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">4</a></span> <span class="id">*</span> <span class="id">4</span> <span class="id">*</span> (<span class="id">2</span> <span class="id">-</span> <span class="id">eps</span>)))))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sqrt_mult;</span> <span class="id">[|lra|apply:</span> <span class="id">invR_ge0;</span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sqrt_inv//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">sqrt_mult</span> (<span class="id">4</span> <span class="id">*</span> <span class="id">4</span>))<span class="id">;</span> <span class="id">[|lra|lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-Rsqr_def</span> <span class="id">sqrt_Rsqr;</span> <span class="id">[exact:</span> <span class="id">Rle_refl|lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sqrt_le_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">/Rdiv</span> <span class="id">-!mulRA;</span> <span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">cvariance_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">[lra|by</span> <span class="id">apply</span> <span class="id">invR_ge0;</span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">Hvar_hat_2_eps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_gt0">[lra|left;apply</a></span> <span class="id">invR_gt0;lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">invRM;</span> <span class="id">[|by</span> <span class="id">apply/eqP;</span> <span class="id">lra</span>..<span class="id">]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">mulRC</span> (<span class="id">/</span> <span class="id">_</span>)) <span class="id">mulRA</span> (<span class="id">mulRC</span> <span class="id">_</span> (<span class="id">/</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">_</a></span>)) <span class="id">mulRA</span> <span class="id">mulRA</span> <span class="id">mulRA</span> <span class="id">/Rdiv</span> <span class="id">-4!mulRA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_pmul</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">exact:</span> <span class="id">cvariance_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">mulR_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply:</span> <span class="id">invR_ge0;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulRC</span> <span class="id">/Rsqr;</span> <span class="gallina-kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">exact:</span> <span class="id">Rle_refl</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-sqrt_inv</span> <span class="id">-sqrt_mult;</span> <span class="id">[|exact:</span> <span class="id">Hvar_hat_2_eps|by</span> <span class="id">apply:</span> <span class="id">invR_ge0;</span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Rsqr_sqrt;</span> <span class="id">[by</span> <span class="id">right|nra]</span>.<br/>
<span class="comment">(*a8-a9*)</span><br/>
<span class="id">apply</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">@leR_trans</a></span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">-</a></span> <span class="id">eps</span>) <span class="id">*</span> <span class="id">var_hat</span> <span class="id">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">/16</a></span> <span class="id">+</span> <span class="id">2</span> <span class="id">*</span> <span class="id">eps_max</span> <span class="id">*</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Rsqr</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps_max">/</a></span> (<span class="id">4</span> <span class="id">*</span> <span class="id">sqrt</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">2</a></span> <span class="id">-</span> <span class="id">eps_max</span>)) <span class="id">+</span> <span class="id">/sqrt</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps_max</span>))))).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">leR_pmul</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id">[lra|exact:</span> <span class="id">variance_ge0]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">addR_ge0;</span> <span class="id">[lra|apply:</span> <span class="id">mulR_ge0;</span> <span class="id">[lra|exact:</span> <span class="id">Rle_0_sqr]]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id">Rle_refl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id">leR_add;</span> <span class="id">first</span> <span class="id">exact/Rle_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_pmul;</span> <span class="id">[lra|exact:</span> <span class="id">Rle_0_sqr|by</span> <span class="id">rewrite</span> <span class="id">/eps_max;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_bounds_le">lra|]</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rsqr_bounds_le;</span> <span class="id">split;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">interval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_add</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id">mulR_gt0;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">sqrt_lt_R0;</span> <span class="id">rewrite</span> <span class="id">/eps_max;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id">leR_wpmul2l;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">sqrt_le_1;</span> <span class="id">rewrite</span> <span class="id">/eps_max;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">sqrt_lt_R0;</span> <span class="id">rewrite</span> <span class="id">/eps_max;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">sqrt_le_1;</span> <span class="id">rewrite</span> <span class="id">/eps_max;</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRC</span> <span class="id">mulRA</span>.<br/>
<span class="id">apply:</span> <span class="id">leR_wpmul2r</span> <span class="id">=&gt;</span> <span class="id"><a href="robustmean.robustmean.html#variance_ge0">//;</a></span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">variance_ge0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">leR_wpmul2r;</span> <span class="id">[lra|rewrite</span> <span class="id">/eps_max;</span> <span class="id">interval]</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn A.10--A.11, page 63 </div>
<span class="vernacular">Lemma</span> <span class="id">bound_empirical_variance_bad</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.var_hat">:</a></span><br/>
&nbsp;&nbsp;<span class="id">16</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">*</a></span> <span class="id">var</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;=</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">var_hat</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">&lt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:260">\sum_</a></span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">i</a></span> <span class="gallina-kwd">in</span> <span class="id">U</span>) <span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">invariant</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">2/3</a></span> <span class="id">*</span> <span id="i:269" class="id"><span id="i:268" class="id"><span id="i:267" class="id"><span id="i:266" class="id"><span id="i:265" class="id">
  <a name="i:269" class="">var_hat</a>
</span></span></span></span></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">&lt;=</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">\sum_</a></span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">bad</a></span>) <span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">rewrite</span> <span class="id">/eps_max;</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">var16</span> <span class="id">sumCi_pos</span> <span class="id">HiC</span>.<br/>
<span class="id">unfold</span> <span class="id">eps_max</span> <span class="gallina-kwd">in</span> <span class="id">low_eps</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">good;</span> <span class="id">first</span> <span class="id">exact:</span> (<span class="id">pr_good_gt0</span> <span class="id">_</span> <span class="id">low_eps</span>).<br/>
<br/>
<span class="id">have</span> <span class="id">-&gt;:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">\sum_</a></span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">bad</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">C</a></span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">tau</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">i</a></span> <span class="id">=</span><br/>
&nbsp;&nbsp;<span id="i:279" class="id"><span id="i:278" class="id"><span id="i:277" class="id"><span id="i:276" class="id"><span id="i:275" class="id">
  <a name="i:279" class="">var_hat</a>
</span></span></span></span></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">*</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">\sum_</a></span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">i</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">U</a></span>) <span class="id">C</span> <span class="id">i</span> <span id="i:284" class="id"><span id="i:283" class="id"><span id="i:282" class="id"><span id="i:281" class="id"><span id="i:280" class="id">
  <a name="i:284" class="">*</a>
</span></span></span></span></span> <span class="id">P</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">i</a></span>) <span class="id">-</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">\sum_</a></span>(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">i</a></span> <span class="gallina-kwd">in</span> <span class="id">good</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">C</a></span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Var">/var_hat</a></span> <span class="id">/evar</span> <span class="id">/Var</span> <span class="id">{1}/Ex</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">Rplus_eq_reg_r</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">\sum_</a></span>(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">i</a></span> <span class="gallina-kwd">in</span> <span class="id">good</span>) <span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-addRA</span> <span class="id">Rplus_opp_l</span> <span class="id">addR0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/bad</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">have</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">-&gt;</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">:</a></span> <span class="id">\sum_</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">i</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#i:295">~:</a></span> <span class="id">good</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">C</a></span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span> <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">\sum_</a></span>(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">i</a></span> <span class="gallina-kwd">in</span> <span class="id">good</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">C</a></span> <span class="id">i</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">*</a></span> <span class="id">P</span> <span class="id">i</span> <span id="i:309" class="id"><span id="i:308" class="id"><span id="i:307" class="id"><span id="i:306" class="id"><span id="i:305" class="id">
  <a name="i:309" class="">*</a>
</span></span></span></span></span> <span class="id">tau</span> <span class="id">i</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">=</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:305">\sum_</a></span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">i</a></span> <span class="gallina-kwd">in</span> <span class="id">U</span>) <span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-big_union/=;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setCK">disjoints_subset</a></span> <span class="id">setCK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">setUC</span> <span class="id">setUCr/=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">eq_bigl</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id">inE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big_distrl/=</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#dE">/tau</a></span> <span class="id">/mu_hat</span> <span class="id">/WP</span> <span class="id">Weighted.dE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRC</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">-mulRA;</a></span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="robustmean.weightedmean.html#total">*</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">/Weighted</a></span>.<span class="id">total</span> <span class="id">-mulRA</span> <span class="id">Rinv_l</span> <span class="id">?mulR1//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id">Rgt_not_eq</span>.<br/>
<span class="id">apply</span> (<span class="id">@leR_trans</span> (<span class="id">var_hat</span> <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">3</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">/</a></span> <span class="id">2</span> <span class="id">*</span> <span id="i:319" class="id"><span id="i:318" class="id"><span id="i:317" class="id"><span id="i:316" class="id"><span id="i:315" class="id"><span id="i:314" class="id"><span id="i:313" class="id"><span id="i:312" class="id"><span id="i:311" class="id"><span id="i:310" class="id">
  <a name="i:319" class="">eps</a>
</span></span></span></span></span></span></span></span></span></span>) <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.good">-</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">\sum_</a></span>(<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">i</a></span> <span class="gallina-kwd">in</span> <span class="id">good</span>) <span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-!addR_opp;</span> <span class="id">apply:</span> <span class="id">Rplus_le_compat_r</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_wpmul2l;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">variance_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.eps">@leR_trans</a></span> ((<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">1</a></span> <span class="id">-</span> <span class="id">eps</span> <span class="id">/</span> <span class="id">2</span>) <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>)))<span class="id">;</span> <span class="id">first</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">leR_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">@good_mass</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.low_eps">_</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">C01</span> <span class="id">pr_bad</span> <span class="id">low_eps</span> <span class="id">HiC</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move/</span>(<span class="id">Rmult_le_compat_r</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>) <span class="id">_</span> <span class="id">_</span> (<span class="id">Pr_ge0</span> <span class="id">_</span> <span class="id">good</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rmult_div_l">-Rmult_div_swap</a></span> <span class="id">Rmult_div_l;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">Rgt_not_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Pr_to_cplt</span> <span class="id">pr_bad;</span> <span class="id">exact</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_sumRl</span> <span class="id">=&gt;</span> <span class="id">//i</span> <span class="id">igood</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">exact:</span> <span class="id">Rle_refl</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">mulR_ge0</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::pair_scope:x_'.1'">//;</a></span> <span class="id">apply</span> (<span class="id">C01</span> <span class="id">_</span>).<span class="id">1</span>.<br/>
<span class="id">apply</span> (<span class="id">@leR_trans</span> ((<span class="id">1</span> <span class="id">-</span> <span class="id">3</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">/</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">*</a></span> <span class="id">eps</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">-</a></span> <span class="id">0</span>.<span class="id">25</span> <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>)) <span class="id">*</span> <span class="id">var_hat</span>))<span class="id">;</span> <span class="id">last</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRBl">first</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRBl</span> (<span class="id">mulRC</span> <span class="id">var_hat</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">leR_add;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">Ropp_le_contravar;</span> <span class="id">exact:</span> <span class="id">bound_empirical_variance_good</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id">Rle_refl</span>.<br/>
<span class="id">apply</span> (<span class="id">@leR_trans</span> ((<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id">3</span> <span class="id">/</span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">eps_max</span> <span class="id">-</span> <span class="id">0</span>.<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">25</a></span> <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps_max</span>)) <span class="id">*</span> <span class="id">var_hat</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_wpmul2r;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">variance_ge0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/eps_max;</span> <span class="id">nra</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite/eps_max;</span> <span class="id">apply</span> <span class="id">leR_wpmul2r;</span> <span class="id">[exact:</span> <span class="id">variance_ge0|nra]</span>.<br/>
Qed.</div>
<br/>
<div class="doc md"> ## eqn 1.3--1.4, page 7 </div>
<span class="vernacular">Lemma</span> <span class="id">update_removed_weight</span> (<span class="id">S</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.X">{set</a></span> <span class="id">U}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">C'</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau_max">:=</a></span> <span class="id">update</span> <span class="id">X</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">PC_neq0</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">&lt;</a></span> <span class="id">tau_max</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">\sum_</a></span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">S</span>) (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">1</a></span> <span class="id">-</span> <span class="id"><a href="robustmean.weightedmean.html#S:320">C'</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">i</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:327">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau_max">S</a></span>) (<span class="id">1</span> <span class="id">-</span> <span class="id">C</span> <span class="id">i</span>) <span class="id">*</span> <span class="id">P</span> <span id="i:336" class="id"><span id="i:335" class="id"><span id="i:334" class="id"><span id="i:333" class="id"><span id="i:332" class="id">
  <a name="i:336" class="">i</a>
</span></span></span></span></span>) <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">1</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:332">/</a></span> <span class="id">tau_max</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">*</a></span> (<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">S</span>) <span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
<span class="id">move</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">=&gt;</a></span> <span class="id">C'</span> <span id="i:341" class="id"><span id="i:340" class="id"><span id="i:339" class="id"><span id="i:338" class="id"><span id="i:337" class="id">
  <a name="i:341" class="">tau_max_gt0</a>
</span></span></span></span></span>.<br/>
<span class="id">have</span> <span class="id"><a href="robustmean.weightedmean.html#i:337">&lt;-</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.P">\sum_</a></span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">S</span>) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">C</a></span> <span class="id">i</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau_max">-</a></span> <span class="id">C'</span> <span class="id">i</span>) <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">P</a></span> <span class="id">i=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.C">1</a></span> <span class="id"><a href="robustmean.weightedmean.html#i:342">/</a></span> <span class="id">tau_max</span> <span class="id"><a href="robustmean.weightedmean.html#bounding_empirical_variance.tau">*</a></span> (<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">S</span>) <span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id"><a href="robustmean.weightedmean.html#update">P</a></span> <span class="id">i</span> <span class="id">*</span> <span class="id">tau</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/C'</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">/update</a></span> <span class="id">big_distrr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">_</a></span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/update_ffun</span> <span class="id">ffunE</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[-&gt;|Ci-]</span> <span class="id">:=</span> <span class="id">eqVneq</span> (<span class="id">C</span> <span class="id">i</span>) <span class="id">0;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079">first</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">orbT</span> <span class="id">subRR</span> <span class="id">!</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifF">mulR0,mul0R</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">orbF</span> <span class="id">ifF;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> (<span class="id">negbTE</span> (<span class="id">gtR_eqF</span> <span class="id">_</span> <span class="id">_</span> <span class="id">tau_max_gt0</span>))<span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/tau_max</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#gtR_eqF">/tau</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">field;</span> <span class="id">exact/eqP/gtR_eqF</span>.<br/>
<span class="id">rewrite</span> <span class="id">-big_split/=</span>.<br/>
<span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRA">=&gt;</a></span> <span class="id">i</span> <span class="id">HiS</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulRDl</span> <span class="id">addRA</span> <span class="id">subRK</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">bounding_empirical_variance</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">filter1D_invariant_update</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span id="filter1D_invariant_update.X" class="id">
  <a name="filter1D_invariant_update.X" class="">:</a>
</span> <span class="id">finType</span>) (<span class="id"><a href="robustmean.util.html#R">P</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">:</a></span> <span class="id">{fdist</span> <span class="id">U}</span>) (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">C</a></span> <span class="id">:</span> <span class="id">nneg_finfun</span> <span class="id"><a href="robustmean.util.html#R">U</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">good</span> <span class="id">:</span> <span class="id">{set</span> <span class="id">U}</span>) (<span class="id">eps</span> <span class="id">:</span> <span class="id">R</span>).<br/>
<span class="vernacular">Hypothesis</span> <span class="id">PC_neq0</span> <span class="id">:</span> <span class="id">Weighted.total</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.X">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.PC_neq0">C</a></span> <span class="id">!=</span> <span class="id">0</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="filter1D_invariant_update.tau_max" class="id">
  <a name="filter1D_invariant_update.tau_max" class="">tau</a>
</span> <span class="id">:=</span> <span class="id">sq_dev</span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<span class="vernacular">Let</span> <span class="id">tau_max</span> <span class="id">:=</span> <span class="id">sq_dev_max</span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
<br/>
<div class="doc md"> ## lemma 1.5, page 5, update preserves the invariant of filter1D </div>
<span class="vernacular">Lemma</span> <span class="id">filter1D_inv_update</span> <span class="id">:</span> <span class="gallina-kwd">let</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">C'</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.tau_max">:=</a></span> <span class="id">update</span> <span class="id">X</span> <span class="id">PC_neq0</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id">&lt;</span> <span class="id">tau_max</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.P">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id"><a href="robustmean.weightedmean.html#i:355">i</a></span> <span class="gallina-kwd">in</span> <span class="id">good</span>) (<span class="id">C</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.eps">i</a></span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id">tau</span> <span class="id">i</span> <span class="id">&lt;=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">1</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.good">-</a></span> <span class="id">eps</span>) <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.C">/</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">2</a></span> <span class="id">*</span> (<span class="id"><a href="robustmean.weightedmean.html#i:360">\sum_</a></span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">~:</a></span> <span class="id">good</span>) (<span class="id">C</span> <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>) <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.C">*</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.good">tau</a></span> <span class="id">i</span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#filter1D_inv">filter1D_inv</a></span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_invariant_update.P">P</a></span> <span class="id"><a href="robustmean.weightedmean.html#C':354">C</a></span> <span class="id">good</span> <span class="id">eps</span> <span class="id">-&gt;</span> <span class="id">filter1D_inv</span> <span class="id">P</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_inv">C'</a></span> <span class="id">good</span> <span class="id">eps</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">rewrite</span> <span class="id">/filter1D_inv</span> <span class="id">=&gt;</span> <span class="id">tau_max_gt0</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">rewrite</span> <span class="id">!update_removed_weight//</span> <span class="id">!mulRDr;</span> <span class="id">apply</span> <span class="id">leR_add;</span> <span class="id">first</span> <span class="id">exact</span> <span class="id">H2</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRCA</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">leR_pmul2l;</span> <span class="id">[exact/divR_gt0|exact:</span> <span class="id">H1]</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">filter1D_invariant_update</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">update_invariant</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id"><a href="robustmean.util.html#R">:</a></span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id">:</span> <span class="id">{fdist</span> <span class="id">U}</span>) (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) (<span class="id">C</span> <span class="id">:</span> <span class="id">nneg_finfun</span> <span class="id"><a href="robustmean.weightedmean.html#update_invariant.C">U</a></span>).<br/>
<span class="vernacular">Hypothesis</span> <span class="id">PC_neq0</span> <span class="id">:</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">Weighted.total</a></span> <span class="id">P</span> <span class="id">C</span> <span class="id">!=</span> <span class="id">0</span>.<br/>
<span class="vernacular">Hypothesis</span> <span class="id">C01</span> <span class="id">:</span> <span class="id">is_01</span> <span class="id">C</span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id">update_invariant</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">base_case</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">A</span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id">:</span> <span class="id">{fdist</span> <span class="id">A}</span>) (<span class="id">eps</span> <span class="id">:</span> <span class="id">R</span>) (<span class="id">good</span> <span class="id">:</span> <span class="id"><a href="robustmean.util.html#R">{set</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#105ca7b8847645320f5e1f7e9a4df4f2">A}</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">ffun1</span> <span class="id">:</span> <span class="id">{ffun</span> <span class="id">A</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#ce8c9a990e3e773a56ef37417d3761c6">-&gt;</a></span> <span class="id">R}</span> <span class="id">:=</span> <span id="a:377" class="id"><span id="a:376" class="id"><span id="a:375" class="id">
  <a name="a:377" class="">[ffun=&gt;</a>
</span></span></span> <span class="id">1]</span>.<br/>
<span class="vernacular">Let</span> <span class="id">ffun1_subproof</span> <span class="id">:</span> <span class="id">[forall</span> <span class="id">a,</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">ffun1</span> <span class="id">a]%mcR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="gallina-kwd">by</span> <span class="id">apply/forallP</span> <span class="id">=&gt;</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id">ffunE;</span> <span class="id">apply/RleP</span>. Qed.</div>
<span class="vernacular">Definition</span> <span class="id">Cpos_ffun1</span> <span class="id">:=</span> <span class="id">@mkNNFinfun</span> <span class="id"><a href="robustmean.weightedmean.html#total">A</a></span> <span class="id">ffun1</span> <span class="id">ffun1_subproof</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">PC1_neq0</span> <span class="id">:</span> <span class="id">Weighted.total</span> <span class="id">P</span> <span class="id">Cpos_ffun1</span>  <span class="id">!=</span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">rewrite/Weighted</span>.<span class="id">total</span>.<br/>
<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#FDist.f1">/Cpos_ffun1/=/ffun1</a></span> <span class="id">ffunE</span> <span class="id">mul1R</span>.<br/>
<span class="id">rewrite</span> <span class="id">FDist.f1</span>.<br/>
<span class="id">apply</span> <span class="id">oner_neq0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">C1_is01</span> <span class="id">:</span> <span class="id">is_01</span> <span class="id">Cpos_ffun1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
 <span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">i;</span> <span class="id">rewrite</span> <span class="id">ffunE;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">lra</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">base_case:</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">good</span>) <span class="id"><a href="robustmean.weightedmean.html#base_case.eps">=</a></span> <span class="id">eps</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.weightedmean.html#filter1D_invW">filter1D_inv</a></span> <span class="id">P</span> <span class="id">Cpos_ffun1</span> <span class="id">good</span> <span class="id">eps</span> <span class="id">/\</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filter1D_invW</span> <span class="id">good</span> <span class="id">eps</span> <span class="id">PC1_neq0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">move=&gt;</span> <span class="id">Hbad_ratio;</span> <span class="id">rewrite</span> <span class="id">/filter1D_inv;</span> <span class="id">split</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">/Cpos_fun</a></span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">ffunE</span> <span class="id">subRR</span> <span class="id">mul0R</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big1;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">ffunE</span> <span class="id">subRR</span> <span class="id">mul0R</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big1;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulR0;</span> <span class="id">exact/RleP</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">/filter1D_invW</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Pr</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">Weighted.dE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Weighted</span>.<span class="id">total</span> <span class="id">/Cpos_ffun1/=</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">do</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_distrl">rewrite</a></span> <span class="id">/ffun1</span> <span class="id">/=</span> <span class="id">ffunE</span> <span class="id">mul1R</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">-big_distrl/=</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="robustmean.weightedmean.html#ffun1">[in</a></span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#ffunE">_</a></span> <span class="id">&lt;=</span> <span class="id">_</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">*</a></span> <span class="id">/</span> <span class="id">X]eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR1">/ffun1</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">/=</a></span> <span class="id">ffunE</span> <span class="id">mul1R</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">FDist.f1</span> <span class="id">invR1</span> <span class="id">mulR1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-/</span>(<span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>) <span class="id">Pr_to_cplt</span> <span class="id">Hbad_ratio;</span> <span class="id">exact/RleP</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">base_case</span>.<br/>
<br/>
<div class="doc md"> ## Algorithm 2, page 4 </div>
<span class="vernacular">Section</span> <span class="id">filter1D</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id"><a href="robustmean.util.html#R">:</a></span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id">:</span> <span class="id">{fdist</span> <span class="id">U}</span>) (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) (<span class="id">target_var</span> <span class="id">:</span> <span class="id">R</span>).<br/>
<span class="vernacular">Hypothesis</span> (<span class="id">pos_var</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">target_var</span>).<br/>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">Program.Wf</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Obligation</span> <span class="vernacular">Tactic</span> <span class="id">:=</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.U">idtac</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a href="robustmean.weightedmean.html#total">C01_update</a></span> (<span class="id">C</span> <span class="id">:</span> <span class="id">nneg_finfun</span> <span class="id">U</span>) (<span class="id">PC_neq0</span> <span class="id"><a href="robustmean.weightedmean.html#is_01">:</a></span> <span class="id">Weighted.total</span> <span class="id">P</span> <span class="id">C</span> <span class="id">!=</span> <span class="id">0</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">is_01</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">is_01</span> (<span class="id">update</span> <span class="id"><a href="robustmean.weightedmean.html#update">X</a></span> <span class="id">PC_neq0</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="id">move=&gt;</span> <span class="id">C01</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id">/update/=;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/RleP</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">/forallP</span> <span class="id">:=</span> <span class="id">update_pos_ffun</span> <span class="id">X</span> <span class="id">PC_neq0</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>.<br/>
<span class="id">rewrite</span> <span class="id">/update_ffun</span> <span class="id">ffunE;</span> <span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id">negb_or</span> <span class="id">=&gt;</span> <span class="id">/andP[sq_dev_neq0</span> <span class="id">Cu_neq0]</span>.<br/>
<span class="id">move=&gt;</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RleP">[:sq_gt0]</a></span>.<br/>
<span class="id">apply/RleP/mulr_ile1</span>.<br/>
<span class="id">-</span> <span class="id">exact/RleP/</span>(<span class="id">C01</span> <span class="id">u</span>).<span class="id">1</span>.<br/>
<span class="id">-</span> <span class="id">apply/RleP;</span> <span class="id">rewrite</span> <span class="id">subR_ge0</span> <span class="id">leR_pdivr_mulr//</span> <span class="id">?mul1R//;</span> <span class="id">last</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_neqAle">first</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">abstract:</span> <span class="id">sq_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/ltR_neqAle;</span> <span class="id">split;</span> <span class="id">[exact/nesym/eqP|exact/sq_dev_max_ge0]</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id">sq_dev_max_ge</span>.<br/>
<span class="id">-</span> <span class="id">exact/RleP/</span>(<span class="id">C01</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">u</a></span>).<span class="id">2</span>.<br/>
<span class="id">-</span> <span class="id">apply/RleP;</span> <span class="id">rewrite</span> <span class="id">leR_subl_addr</span> <span class="id">addRC</span> <span class="id">-leR_subl_addr</span> <span class="id">subRR</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/divR_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span id="filter1D_rec" class="id">
  <a name="filter1D_rec" class="">exact:</a>
</span> <span class="id">sq_dev_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="id">Program</span> <span class="vernacular">Fixpoint</span> <span class="id">filter1D_rec</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">nneg_finfun</span> <span class="id">U</span>) (<span class="id"><a href="robustmean.weightedmean.html#C:386">C01</a></span> <span class="id">:</span> <span class="id">is_01</span> <span class="id">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">HC</span> <span class="id">:</span> <span class="id">Weighted.total</span> <span class="id">P</span> <span class="id">C</span> <span class="id">!=</span> <span class="id">0</span>) <span class="id">{measure</span> <span class="id">#|</span> <span class="id">0</span>.<span class="id">-support</span> <span class="id">C</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">|</a></span> <span class="id">}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id">Bool.bool_dec</span> (<span class="id">Rleb</span> (<span class="id">evar</span> <span class="id">X</span> <span class="id">HC</span>) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">16</a></span> <span class="id">*</span> <span class="id">target_var</span>)) <span class="id">true</span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">left</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">Some</span> (<span class="id">emean</span> <span class="id">X</span> <span class="id">HC</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">right</span> <span class="id">K</span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id">Bool.bool_dec</span> (<span class="id">Weighted.total</span> <span class="id">P</span> (<span class="id">update</span> <span class="id">X</span> <span class="id">HC</span>) <span class="id">!=</span> <span class="id">0</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#left">true</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id">right</span> <span class="id"><a href="robustmean.weightedmean.html#C01_update">_</a></span> <span class="id">=&gt;</span> <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id">left</span> <span class="id">H</span> <span class="id">=&gt;</span> <span class="id">filter1D_rec</span> (<span class="id">C01_update</span> <span class="id">HC</span> <span class="id">C01</span>) <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">end</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Next Obligation.</span></div>
<div class="proofscript" id="proof45">
<span class="id">rewrite/Weighted</span>.<span class="id">total=&gt;</span> <span class="id">C</span> <span class="id">C01</span> <span class="id">HCneq0</span> <span class="id">_</span> <span class="id">/=</span> <span class="id">evar16</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>.<br/>
<span class="id">apply/ssrnat</span>.<span class="id">ltP/proper_card/properP;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/subsetP</span> <span class="id">=&gt;</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">!supportE</a></span> <span class="id">/update_ffun</span> <span class="id">ffunE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">ifPn;</span> <span class="id">[rewrite</span> <span class="id">eqxx|rewrite</span> <span class="id">negb_or</span> <span class="id">=&gt;</span> <span class="id">/andP[]]</span>.<br/>
<span class="id">have</span> <span class="id">/RltP</span> <span class="id">HCgt0</span> <span class="id">:=</span> <span class="id">weighted_total_gt0</span> <span class="id">HCneq0</span>.<br/>
<span class="id">have</span> <span class="id">HCge0</span> <span class="id">:=</span> <span class="id">ltW</span> <span class="id">HCgt0</span>.<br/>
<span class="id">move:</span> (<span class="id">HCgt0</span>) <span class="id">=&gt;</span> <span class="id">/fsumr_gt0[u</span> <span class="id">_</span> <span class="id">/RltP]</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulr_ge0_gt0//</span> <span class="id">=&gt;</span> <span class="id">[/andP[Cu0</span> <span class="id">Pu0]|];</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/RleP;</span> <span class="id">exact:</span> (<span class="id">C01</span> <span class="id">u</span>).<span class="id"><a href="robustmean.weightedmean.html#i:390">1</a></span>.<br/>
<span class="id">have</span> <span class="id"><a href="robustmean.weightedmean.html#sq_dev">Cmax_neq0</a></span> <span class="id">:</span> <span class="id">C</span> <span class="id">[arg</span> <span class="id">max_</span>(<span class="id">i</span> <span class="id">&gt;</span> <span class="id">u</span> <span class="id">|</span> <span class="id">C</span> <span class="id">i</span> <span class="id">!=</span> <span class="id">0</span>) <span class="id">sq_dev</span> <span class="id">X</span> <span class="id">HCneq0</span> <span class="id">i]%O</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.gt_eqF">!=</a></span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">arg_maxP</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.X">gt_eqF</a></span>.<br/>
<span class="id">have</span> <span class="id">sq_dev_max_neq0</span> <span class="id">:</span> <span class="id">sq_dev_max</span> <span class="id">X</span> <span class="id">HCneq0</span> <span class="id">!=</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/sq_dev_max</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> <span class="id">evar16</span> <span class="id">=&gt;</span> <span class="id">/negP/RlebP/RleP;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Var">rewrite</a></span> <span class="id">-ltNge</span> <span class="id">=&gt;</span> <span class="id"><a href="robustmean.weightedmean.html#emean">/RltP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/evar</span> <span class="id">/Var</span> <span class="id">/sq_dev</span> <span class="id">/var</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.target_var">/emean</a></span> <span class="id">/Ex</span> <span class="id">=&gt;</span> <span class="id">evar16</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">16</span> <span class="id">*</span> <span class="id">target_var</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id">[lra|]</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id"><a href="robustmean.util.html#fsumr_gt0">/leR_ltR_trans</a></span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">_</span> <span class="id">evar16</span>) <span class="id">/RltP</span> <span class="id">=&gt;</span> <span class="id">/fsumr_gt0[i</span> <span class="id">_]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Weighted.dE</span> <span class="id">=&gt;</span> <span class="id">/[dup]</span> <span class="id">=&gt;</span> <span class="id">/pmulR_lgt0'</span> <span class="id">=&gt;</span> <span class="id">sq_dev_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">/[apply]</span> <span class="id">:=</span> <span class="id">pmulR_rgt0'</span> <span class="id"><a href="robustmean.weightedmean.html#d">_</a></span> (<span class="id">sq_RV_ge0</span> (<span class="id">X</span> <span class="id">`-cst</span> <span class="id">\sum_</span>(<span class="id">v</span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#69f87318111a06c23cf3b6c947249a45">U</a></span>) <span class="id">X</span> <span class="id">v</span> <span class="id">*</span> <span class="id">Weighted.d</span> <span class="id">HCneq0</span> <span class="id">v</span>) <span class="id">i</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">/[apply]</span> <span class="id">:=</span> <span class="id">pmulR_lgt0'</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#69f87318111a06c23cf3b6c947249a45">_</a></span> (<span class="id">invR_ge0</span> <span class="id">_</span> (<span class="id">RltP</span> <span class="id">_</span> <span class="id">_</span> <span class="id">HCgt0</span>)).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">/[apply]</span> <span class="id">Cigt0</span> <span class="id">:=</span> <span class="id">pmulR_lgt0'</span> <span class="id">_</span> (<span class="id">RleP</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">FDist.ge0</span> <span class="id">P</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">gt_eqF//;</span> <span class="id">apply/RltP/bigmaxR_gt0;</span> <span class="gallina-kwd">exists</span> <span class="id">i;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">gt_eqF//;</span> <span class="id">exact/RltP</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">apply/sq_dev_gt0/mulR_ge0;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply/mulR_ge0</span> <span class="id"><a href="robustmean.weightedmean.html#weighted_total_gt0">=&gt;</a></span> <span class="id">//;</span> <span class="id">apply</span> (<span class="id">C01</span> <span class="id">_</span>).<span class="id">1</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#cc13311bd8d6ef35a7c1186b7a1a4c3d">exact/invR_ge0/weighted_total_gt0</a></span>.<br/>
<span class="gallina-kwd">exists</span> <span class="id">[arg</span> <span class="id">max_</span>(<span class="id">i</span> <span class="id">&gt;</span> <span class="id">u</span> <span class="id">|</span> <span class="id">C</span> <span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finfun.html#supportE">!=</a></span> <span class="id">0</span>) <span class="id">sq_dev</span> <span class="id">X</span> <span class="id">HCneq0</span> <span class="id">i]%O</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">supportE</span>.<br/>
<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifF">rewrite</a></span> <span class="id">/update_ffun</span> <span class="id">supportE</span> <span class="id">ffunE</span> <span class="id">negbK</span> <span class="id">ifF</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mul1r">rewrite</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#4e5a4c91ec0aa12de06dfe1cc07ea126">!coqRE</a></span> <span class="id">mulf_eq0</span> <span class="id">subr_eq0</span> <span class="id">-invr1</span> <span class="id">-</span>(<span class="id">mul1r</span> (<span class="id">1^-1</span>))<span class="id">%mcR</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">eqr_div</span> <span class="id">?oner_eq0//</span> <span class="id">?mulr1</span> <span class="id">?mul1r//</span> <span class="id">/sq_dev_max</span> <span class="id">bigmaxRE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.gt_eqF">@bigmax_eq_arg</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">u</span>) <span class="id">?eq_refl</span> <span class="id">?orbT</span> <span class="id">?gt_eqF//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">exact/RleP/sq_dev_ge0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">rewrite</a></span> (<span class="id">negbTE</span> <span class="id">sq_dev_max_neq0</span>)<span class="id">/=;</span> <span class="id">exact/negbTE</span>.<br/>
Qed.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Next Obligation.</span></div>
<div class="proofscript" id="proof46">
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">well_founded_lt_compat</span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D_rec">x</a></span> <span class="id">y;</span> <span class="id">exact</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id">filter1D</span> <span class="id"><a href="robustmean.weightedmean.html#filter1D.U">:=</a></span> <span class="id">@filter1D_rec</span> (<span class="id">Cpos_ffun1</span> <span class="id">U</span>) (<span class="id">@C1_is01</span> <span class="id">U</span>) (<span class="id">@PC1_neq0</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<br/>
<span class="vernacular">End</span> <span class="id">filter1D</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
</body>
</html>
